ARGS: Namespace(checkpoint=PosixPath('/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth'), images_dir=PosixPath('/project/aip-medilab/ewillis/picai_baseline/picai_baseline/workdir/nnUNet_raw_data/Task2203_picai_baseline/imagesTr'), marksheet_csv=PosixPath('/project/aip-medilab/ewillis/pca_contrastive/mri_data/marksheet_folds.csv'), train_folds=['fold1', 'fold2', 'fold3', 'fold4'], val_folds=['fold0'], epochs=200, batch_size=1, lr=0.0001, weight_decay=0.0001, num_workers=2, proj_dim=128, model_type='vit_b', device=None, out_dir=PosixPath('/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs'), max_lr_epochs=None, tiny_total=None, tiny_per_class=None, use_weighted_sampler=True, confmat_normalize='true')
Using device: cuda
ISUPMedSAM(
  (image_encoder): ImageEncoderViT(
    (patch_embed): PatchEmbed(
      (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    )
    (blocks): ModuleList(
      (0-11): 12 x Block(
        (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=768, out_features=2304, bias=True)
          (proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (mlp): MLPBlock(
          (lin1): Linear(in_features=768, out_features=3072, bias=True)
          (lin2): Linear(in_features=3072, out_features=768, bias=True)
          (act): GELU(approximate='none')
        )
      )
    )
    (neck): Identity()
  )
  (token_pool): TokenAttnPool(
    (fc): Linear(in_features=768, out_features=128, bias=True)
    (gate): Linear(in_features=768, out_features=128, bias=True)
    (a): Linear(in_features=128, out_features=1, bias=True)
    (tanh): Tanh()
    (sigmoid): Sigmoid()
  )
  (projector): ABMILProjector(
    (attn_fc): Sequential(
      (0): Linear(in_features=768, out_features=256, bias=True)
      (1): Tanh()
    )
    (attn_score): Linear(in_features=256, out_features=1, bias=True)
    (embed_head): Sequential(
      (0): Linear(in_features=768, out_features=128, bias=True)
      (1): ReLU()
      (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classifier): Linear(in_features=128, out_features=6, bias=True)
)
Training cases: 1200, Validation cases: 300
Class weights: tensor([0.1082, 0.4218, 0.3992, 0.9398, 2.3201, 1.8108], device='cuda:0')
Epoch 1/200 | Train Loss: 1.8420, Train Acc: 0.1875 | Val Loss: 1.9118, Val Acc: 0.0267, Val AUC: nan, Val Balanced Acc: 0.1439 | Val Class Acc: {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.5, 5: 0.36363636363636365}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.000 0.000 0.000 0.000 0.348 0.652
     1 0.000 0.000 0.000 0.000 0.212 0.788
     2 0.000 0.000 0.000 0.000 0.292 0.708
     3 0.000 0.000 0.000 0.000 0.350 0.650
     4 0.000 0.000 0.000 0.000 0.500 0.500
     5 0.000 0.000 0.000 0.000 0.636 0.364
Saved best model to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs
Epoch 2/200 | Train Loss: 1.7974, Train Acc: 0.1950 | Val Loss: 1.6915, Val Acc: 0.1900, Val AUC: 0.5067, Val Balanced Acc: 0.1718 | Val Class Acc: {0: 0.031055900621118012, 1: 1.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.031 0.944 0.000 0.000 0.025 0.000
     1 0.000 1.000 0.000 0.000 0.000 0.000
     2 0.000 0.979 0.000 0.000 0.021 0.000
     3 0.000 0.950 0.000 0.000 0.050 0.000
     4 0.125 0.875 0.000 0.000 0.000 0.000
     5 0.091 0.818 0.000 0.000 0.091 0.000
Saved best model to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs
Epoch 3/200 | Train Loss: 1.6981, Train Acc: 0.2508 | Val Loss: 1.6785, Val Acc: 0.3100, Val AUC: 0.5068, Val Balanced Acc: 0.1767 | Val Class Acc: {0: 0.38509316770186336, 1: 0.0, 2: 0.625, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.385 0.000 0.615 0.000 0.000 0.000
     1 0.346 0.000 0.635 0.019 0.000 0.000
     2 0.312 0.000 0.625 0.062 0.000 0.000
     3 0.200 0.000 0.750 0.050 0.000 0.000
     4 0.250 0.000 0.750 0.000 0.000 0.000
     5 0.182 0.000 0.818 0.000 0.000 0.000
Saved best model to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs
Epoch 4/200 | Train Loss: 1.5715, Train Acc: 0.3258 | Val Loss: 1.8335, Val Acc: 0.1267, Val AUC: 0.4855, Val Balanced Acc: 0.1829 | Val Class Acc: {0: 0.08074534161490683, 1: 0.34615384615384615, 2: 0.0, 3: 0.0, 4: 0.125, 5: 0.5454545454545454}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.081 0.168 0.000 0.106 0.050 0.596
     1 0.058 0.346 0.000 0.135 0.038 0.423
     2 0.125 0.312 0.000 0.062 0.042 0.458
     3 0.200 0.350 0.000 0.000 0.000 0.450
     4 0.000 0.125 0.000 0.000 0.125 0.750
     5 0.273 0.000 0.000 0.000 0.182 0.545
Saved best model to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs
Epoch 5/200 | Train Loss: 1.4219, Train Acc: 0.3892 | Val Loss: 1.6694, Val Acc: 0.3733, Val AUC: nan, Val Balanced Acc: 0.1395 | Val Class Acc: {0: 0.6645962732919255, 1: 0.019230769230769232, 2: 0.0625, 3: 0.0, 4: 0.0, 5: 0.09090909090909091}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.665 0.043 0.056 0.000 0.043 0.193
     1 0.827 0.019 0.096 0.000 0.019 0.038
     2 0.729 0.021 0.062 0.000 0.062 0.125
     3 0.650 0.050 0.100 0.000 0.000 0.200
     4 0.375 0.000 0.000 0.000 0.000 0.625
     5 0.818 0.000 0.000 0.000 0.091 0.091
Epoch 6/200 | Train Loss: 1.3247, Train Acc: 0.4242 | Val Loss: 1.7621, Val Acc: 0.2167, Val AUC: nan, Val Balanced Acc: 0.1781 | Val Class Acc: {0: 0.16770186335403728, 1: 0.28846153846153844, 2: 0.4375, 3: 0.05, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.168 0.205 0.491 0.037 0.081 0.019
     1 0.115 0.288 0.519 0.019 0.058 0.000
     2 0.229 0.229 0.438 0.000 0.062 0.042
     3 0.050 0.150 0.650 0.050 0.100 0.000
     4 0.000 0.125 0.750 0.000 0.125 0.000
     5 0.182 0.091 0.455 0.000 0.273 0.000
Epoch 7/200 | Train Loss: 1.2411, Train Acc: 0.4758 | Val Loss: 1.9166, Val Acc: 0.1400, Val AUC: 0.4881, Val Balanced Acc: 0.1728 | Val Class Acc: {0: 0.0, 1: 0.7115384615384616, 2: 0.0, 3: 0.2, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.000 0.640 0.000 0.248 0.099 0.012
     1 0.000 0.712 0.000 0.231 0.058 0.000
     2 0.000 0.646 0.000 0.292 0.062 0.000
     3 0.000 0.700 0.000 0.200 0.100 0.000
     4 0.000 0.750 0.000 0.125 0.125 0.000
     5 0.000 0.455 0.000 0.182 0.364 0.000
Epoch 8/200 | Train Loss: 1.1412, Train Acc: 0.5225 | Val Loss: 2.2436, Val Acc: 0.0767, Val AUC: nan, Val Balanced Acc: 0.1223 | Val Class Acc: {0: 0.018633540372670808, 1: 0.11538461538461539, 2: 0.125, 3: 0.35, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.019 0.130 0.130 0.466 0.161 0.093
     1 0.000 0.115 0.135 0.538 0.154 0.058
     2 0.021 0.146 0.125 0.646 0.062 0.000
     3 0.050 0.250 0.050 0.350 0.200 0.100
     4 0.000 0.250 0.125 0.250 0.125 0.250
     5 0.000 0.000 0.273 0.455 0.273 0.000
Epoch 9/200 | Train Loss: 1.1619, Train Acc: 0.5158 | Val Loss: 1.7314, Val Acc: 0.2967, Val AUC: nan, Val Balanced Acc: 0.1867 | Val Class Acc: {0: 0.391304347826087, 1: 0.40384615384615385, 2: 0.0, 3: 0.2, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.391 0.211 0.012 0.273 0.068 0.043
     1 0.288 0.404 0.019 0.212 0.019 0.058
     2 0.271 0.312 0.000 0.292 0.042 0.083
     3 0.200 0.400 0.100 0.200 0.050 0.050
     4 0.375 0.250 0.000 0.250 0.125 0.000
     5 0.545 0.000 0.000 0.273 0.182 0.000
Saved best model to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs
Epoch 10/200 | Train Loss: 0.9763, Train Acc: 0.5858 | Val Loss: 1.5927, Val Acc: 0.4233, Val AUC: nan, Val Balanced Acc: 0.2206 | Val Class Acc: {0: 0.6645962732919255, 1: 0.23076923076923078, 2: 0.0625, 3: 0.15, 4: 0.125, 5: 0.09090909090909091}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.665 0.087 0.006 0.118 0.031 0.093
     1 0.538 0.231 0.058 0.115 0.019 0.038
     2 0.625 0.188 0.062 0.062 0.021 0.042
     3 0.500 0.300 0.000 0.150 0.000 0.050
     4 0.500 0.125 0.000 0.125 0.125 0.125
     5 0.727 0.000 0.000 0.091 0.091 0.091
Saved best model to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/results/token_sttention_200_epochs
Epoch 11/200 | Train Loss: 0.9052, Train Acc: 0.6008 | Val Loss: 1.6422, Val Acc: 0.3233, Val AUC: nan, Val Balanced Acc: 0.1991 | Val Class Acc: {0: 0.38509316770186336, 1: 0.28846153846153844, 2: 0.3958333333333333, 3: 0.0, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.385 0.211 0.323 0.000 0.050 0.031
     1 0.346 0.288 0.327 0.000 0.038 0.000
     2 0.271 0.271 0.396 0.000 0.042 0.021
     3 0.300 0.300 0.350 0.000 0.000 0.050
     4 0.125 0.125 0.625 0.000 0.125 0.000
     5 0.455 0.000 0.545 0.000 0.000 0.000
Epoch 12/200 | Train Loss: 0.9340, Train Acc: 0.5883 | Val Loss: 1.7898, Val Acc: 0.2600, Val AUC: nan, Val Balanced Acc: 0.1512 | Val Class Acc: {0: 0.3167701863354037, 1: 0.36538461538461536, 2: 0.125, 3: 0.1, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.317 0.236 0.143 0.236 0.006 0.062
     1 0.192 0.365 0.096 0.308 0.000 0.038
     2 0.271 0.396 0.125 0.167 0.000 0.042
     3 0.250 0.500 0.150 0.100 0.000 0.000
     4 0.250 0.125 0.375 0.125 0.000 0.125
     5 0.182 0.364 0.273 0.182 0.000 0.000
Epoch 13/200 | Train Loss: 0.8334, Train Acc: 0.6292 | Val Loss: 1.8068, Val Acc: 0.2200, Val AUC: nan, Val Balanced Acc: 0.1789 | Val Class Acc: {0: 0.16149068322981366, 1: 0.3076923076923077, 2: 0.4791666666666667, 3: 0.0, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.161 0.242 0.553 0.000 0.031 0.012
     1 0.077 0.308 0.596 0.000 0.019 0.000
     2 0.167 0.292 0.479 0.000 0.021 0.042
     3 0.150 0.200 0.550 0.000 0.050 0.050
     4 0.125 0.125 0.625 0.000 0.125 0.000
     5 0.182 0.182 0.636 0.000 0.000 0.000
Epoch 14/200 | Train Loss: 0.7335, Train Acc: 0.6667 | Val Loss: 1.9948, Val Acc: 0.1833, Val AUC: nan, Val Balanced Acc: 0.1475 | Val Class Acc: {0: 0.09937888198757763, 1: 0.6730769230769231, 2: 0.0625, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.099 0.503 0.093 0.242 0.037 0.025
     1 0.077 0.673 0.077 0.173 0.000 0.000
     2 0.125 0.542 0.062 0.250 0.021 0.000
     3 0.150 0.550 0.200 0.050 0.050 0.000
     4 0.250 0.250 0.250 0.250 0.000 0.000
     5 0.364 0.364 0.091 0.182 0.000 0.000
Epoch 15/200 | Train Loss: 0.8157, Train Acc: 0.6583 | Val Loss: 1.7565, Val Acc: 0.2833, Val AUC: nan, Val Balanced Acc: 0.1825 | Val Class Acc: {0: 0.36024844720496896, 1: 0.38461538461538464, 2: 0.0, 3: 0.35, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.360 0.354 0.050 0.224 0.006 0.006
     1 0.308 0.385 0.019 0.269 0.019 0.000
     2 0.271 0.333 0.000 0.396 0.000 0.000
     3 0.100 0.450 0.050 0.350 0.000 0.050
     4 0.625 0.125 0.000 0.250 0.000 0.000
     5 0.818 0.091 0.000 0.091 0.000 0.000
Epoch 16/200 | Train Loss: 0.7044, Train Acc: 0.6975 | Val Loss: 1.9072, Val Acc: 0.3300, Val AUC: nan, Val Balanced Acc: 0.1721 | Val Class Acc: {0: 0.4968944099378882, 1: 0.2692307692307692, 2: 0.041666666666666664, 3: 0.1, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.497 0.149 0.087 0.199 0.062 0.006
     1 0.404 0.269 0.115 0.173 0.019 0.019
     2 0.500 0.271 0.042 0.146 0.042 0.000
     3 0.550 0.150 0.200 0.100 0.000 0.000
     4 0.250 0.125 0.125 0.250 0.125 0.125
     5 0.545 0.091 0.000 0.273 0.091 0.000
Epoch 17/200 | Train Loss: 0.7772, Train Acc: 0.6783 | Val Loss: 1.6146, Val Acc: 0.4467, Val AUC: nan, Val Balanced Acc: 0.2019 | Val Class Acc: {0: 0.7204968944099379, 1: 0.21153846153846154, 2: 0.10416666666666667, 3: 0.05, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.720 0.093 0.106 0.012 0.056 0.012
     1 0.577 0.212 0.135 0.038 0.038 0.000
     2 0.625 0.167 0.104 0.062 0.042 0.000
     3 0.600 0.150 0.200 0.050 0.000 0.000
     4 0.375 0.125 0.250 0.000 0.125 0.125
     5 0.909 0.000 0.091 0.000 0.000 0.000
Epoch 18/200 | Train Loss: 0.6173, Train Acc: 0.7442 | Val Loss: 1.8148, Val Acc: 0.4167, Val AUC: nan, Val Balanced Acc: 0.1896 | Val Class Acc: {0: 0.6708074534161491, 1: 0.25, 2: 0.041666666666666664, 3: 0.05, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.671 0.099 0.056 0.106 0.062 0.006
     1 0.462 0.250 0.115 0.154 0.019 0.000
     2 0.646 0.188 0.042 0.125 0.000 0.000
     3 0.600 0.250 0.100 0.050 0.000 0.000
     4 0.500 0.000 0.375 0.000 0.125 0.000
     5 0.818 0.000 0.000 0.000 0.182 0.000
Epoch 19/200 | Train Loss: 0.6880, Train Acc: 0.7050 | Val Loss: 1.9452, Val Acc: 0.2200, Val AUC: nan, Val Balanced Acc: 0.1653 | Val Class Acc: {0: 0.16149068322981366, 1: 0.38461538461538464, 2: 0.3958333333333333, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.161 0.261 0.466 0.081 0.019 0.012
     1 0.135 0.385 0.423 0.058 0.000 0.000
     2 0.104 0.438 0.396 0.042 0.000 0.021
     3 0.100 0.350 0.500 0.050 0.000 0.000
     4 0.250 0.125 0.500 0.000 0.000 0.125
     5 0.182 0.273 0.545 0.000 0.000 0.000
Epoch 20/200 | Train Loss: 0.5450, Train Acc: 0.7633 | Val Loss: 1.9818, Val Acc: 0.2633, Val AUC: nan, Val Balanced Acc: 0.1560 | Val Class Acc: {0: 0.2981366459627329, 1: 0.4423076923076923, 2: 0.14583333333333334, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.298 0.335 0.248 0.081 0.006 0.031
     1 0.231 0.442 0.212 0.115 0.000 0.000
     2 0.208 0.438 0.146 0.188 0.021 0.000
     3 0.250 0.350 0.300 0.050 0.000 0.050
     4 0.125 0.250 0.625 0.000 0.000 0.000
     5 0.818 0.091 0.000 0.091 0.000 0.000
Epoch 21/200 | Train Loss: 0.5790, Train Acc: 0.7600 | Val Loss: 2.0166, Val Acc: 0.2900, Val AUC: nan, Val Balanced Acc: 0.1445 | Val Class Acc: {0: 0.40993788819875776, 1: 0.11538461538461539, 2: 0.2916666666666667, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.410 0.093 0.348 0.137 0.006 0.006
     1 0.231 0.115 0.538 0.096 0.000 0.019
     2 0.354 0.104 0.292 0.250 0.000 0.000
     3 0.350 0.100 0.500 0.050 0.000 0.000
     4 0.375 0.000 0.625 0.000 0.000 0.000
     5 0.545 0.000 0.364 0.091 0.000 0.000
Epoch 22/200 | Train Loss: 0.5653, Train Acc: 0.7592 | Val Loss: 2.0457, Val Acc: 0.2733, Val AUC: nan, Val Balanced Acc: 0.2060 | Val Class Acc: {0: 0.2919254658385093, 1: 0.2692307692307692, 2: 0.375, 3: 0.05, 4: 0.25, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.292 0.106 0.429 0.093 0.081 0.000
     1 0.173 0.269 0.462 0.038 0.058 0.000
     2 0.312 0.146 0.375 0.125 0.042 0.000
     3 0.350 0.100 0.450 0.050 0.050 0.000
     4 0.125 0.125 0.500 0.000 0.250 0.000
     5 0.364 0.273 0.273 0.000 0.091 0.000
Epoch 23/200 | Train Loss: 0.5534, Train Acc: 0.7767 | Val Loss: 1.9682, Val Acc: 0.2900, Val AUC: nan, Val Balanced Acc: 0.1744 | Val Class Acc: {0: 0.3167701863354037, 1: 0.5961538461538461, 2: 0.08333333333333333, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.317 0.429 0.186 0.050 0.019 0.000
     1 0.250 0.596 0.115 0.038 0.000 0.000
     2 0.250 0.562 0.083 0.104 0.000 0.000
     3 0.250 0.450 0.250 0.050 0.000 0.000
     4 0.250 0.375 0.250 0.125 0.000 0.000
     5 0.364 0.636 0.000 0.000 0.000 0.000
Epoch 24/200 | Train Loss: 0.5607, Train Acc: 0.7950 | Val Loss: 2.0558, Val Acc: 0.2633, Val AUC: nan, Val Balanced Acc: 0.2174 | Val Class Acc: {0: 0.2546583850931677, 1: 0.5384615384615384, 2: 0.10416666666666667, 3: 0.1, 4: 0.125, 5: 0.18181818181818182}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.255 0.354 0.230 0.099 0.050 0.012
     1 0.192 0.538 0.135 0.058 0.038 0.038
     2 0.208 0.521 0.104 0.125 0.042 0.000
     3 0.250 0.450 0.150 0.100 0.050 0.000
     4 0.000 0.625 0.250 0.000 0.125 0.000
     5 0.364 0.364 0.091 0.000 0.000 0.182
Epoch 25/200 | Train Loss: 0.4355, Train Acc: 0.8150 | Val Loss: 2.1523, Val Acc: 0.2667, Val AUC: nan, Val Balanced Acc: 0.1687 | Val Class Acc: {0: 0.3105590062111801, 1: 0.3269230769230769, 2: 0.25, 3: 0.0, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.311 0.236 0.329 0.006 0.118 0.000
     1 0.212 0.327 0.385 0.019 0.058 0.000
     2 0.188 0.438 0.250 0.021 0.104 0.000
     3 0.250 0.300 0.400 0.000 0.050 0.000
     4 0.125 0.250 0.500 0.000 0.125 0.000
     5 0.545 0.182 0.182 0.000 0.091 0.000
Epoch 26/200 | Train Loss: 0.4552, Train Acc: 0.8317 | Val Loss: 2.1346, Val Acc: 0.2967, Val AUC: nan, Val Balanced Acc: 0.2043 | Val Class Acc: {0: 0.2857142857142857, 1: 0.5192307692307693, 2: 0.2708333333333333, 3: 0.15, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.286 0.304 0.298 0.093 0.006 0.012
     1 0.115 0.519 0.288 0.077 0.000 0.000
     2 0.167 0.500 0.271 0.062 0.000 0.000
     3 0.150 0.400 0.250 0.150 0.000 0.050
     4 0.000 0.750 0.125 0.125 0.000 0.000
     5 0.364 0.273 0.273 0.091 0.000 0.000
Epoch 27/200 | Train Loss: 0.4119, Train Acc: 0.8392 | Val Loss: 2.3461, Val Acc: 0.2567, Val AUC: nan, Val Balanced Acc: 0.1726 | Val Class Acc: {0: 0.2732919254658385, 1: 0.5, 2: 0.0625, 3: 0.2, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.273 0.391 0.099 0.199 0.031 0.006
     1 0.231 0.500 0.135 0.096 0.038 0.000
     2 0.188 0.625 0.062 0.104 0.021 0.000
     3 0.200 0.450 0.150 0.200 0.000 0.000
     4 0.125 0.250 0.375 0.250 0.000 0.000
     5 0.545 0.273 0.091 0.091 0.000 0.000
Epoch 28/200 | Train Loss: 0.3908, Train Acc: 0.8533 | Val Loss: 2.1677, Val Acc: 0.2800, Val AUC: nan, Val Balanced Acc: 0.1878 | Val Class Acc: {0: 0.3167701863354037, 1: 0.4807692307692308, 2: 0.10416666666666667, 3: 0.1, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.317 0.329 0.174 0.106 0.019 0.056
     1 0.231 0.481 0.115 0.135 0.019 0.019
     2 0.292 0.479 0.104 0.104 0.000 0.021
     3 0.200 0.500 0.200 0.100 0.000 0.000
     4 0.125 0.375 0.250 0.125 0.125 0.000
     5 0.364 0.545 0.091 0.000 0.000 0.000
Epoch 29/200 | Train Loss: 0.4986, Train Acc: 0.8042 | Val Loss: 1.9672, Val Acc: 0.3367, Val AUC: nan, Val Balanced Acc: 0.1921 | Val Class Acc: {0: 0.45962732919254656, 1: 0.38461538461538464, 2: 0.08333333333333333, 3: 0.1, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.460 0.261 0.180 0.062 0.037 0.000
     1 0.385 0.385 0.212 0.000 0.019 0.000
     2 0.417 0.333 0.083 0.125 0.042 0.000
     3 0.350 0.250 0.250 0.100 0.050 0.000
     4 0.250 0.250 0.250 0.125 0.125 0.000
     5 0.636 0.000 0.182 0.000 0.182 0.000
Epoch 30/200 | Train Loss: 0.3715, Train Acc: 0.8642 | Val Loss: 2.1721, Val Acc: 0.3033, Val AUC: nan, Val Balanced Acc: 0.1527 | Val Class Acc: {0: 0.4161490683229814, 1: 0.34615384615384615, 2: 0.10416666666666667, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.416 0.391 0.099 0.056 0.037 0.000
     1 0.423 0.346 0.173 0.038 0.019 0.000
     2 0.375 0.458 0.104 0.021 0.042 0.000
     3 0.300 0.400 0.250 0.050 0.000 0.000
     4 0.250 0.500 0.250 0.000 0.000 0.000
     5 0.364 0.455 0.091 0.000 0.091 0.000
Epoch 31/200 | Train Loss: 0.3708, Train Acc: 0.8625 | Val Loss: 2.4026, Val Acc: 0.2900, Val AUC: nan, Val Balanced Acc: 0.1596 | Val Class Acc: {0: 0.4161490683229814, 1: 0.25, 2: 0.041666666666666664, 3: 0.25, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.416 0.118 0.143 0.304 0.006 0.012
     1 0.288 0.250 0.231 0.231 0.000 0.000
     2 0.333 0.250 0.042 0.375 0.000 0.000
     3 0.300 0.250 0.200 0.250 0.000 0.000
     4 0.500 0.000 0.125 0.375 0.000 0.000
     5 0.636 0.182 0.182 0.000 0.000 0.000
Epoch 32/200 | Train Loss: 0.3287, Train Acc: 0.8808 | Val Loss: 2.0809, Val Acc: 0.4200, Val AUC: nan, Val Balanced Acc: 0.1771 | Val Class Acc: {0: 0.6894409937888198, 1: 0.11538461538461539, 2: 0.16666666666666666, 3: 0.0, 4: 0.0, 5: 0.09090909090909091}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.689 0.081 0.174 0.037 0.019 0.000
     1 0.635 0.115 0.250 0.000 0.000 0.000
     2 0.708 0.042 0.167 0.083 0.000 0.000
     3 0.600 0.100 0.300 0.000 0.000 0.000
     4 0.375 0.250 0.125 0.125 0.000 0.125
     5 0.818 0.000 0.091 0.000 0.000 0.091
Epoch 33/200 | Train Loss: 0.2941, Train Acc: 0.9008 | Val Loss: 2.1398, Val Acc: 0.4033, Val AUC: nan, Val Balanced Acc: 0.1651 | Val Class Acc: {0: 0.6521739130434783, 1: 0.28846153846153844, 2: 0.0, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.652 0.211 0.124 0.006 0.000 0.006
     1 0.519 0.288 0.154 0.019 0.019 0.000
     2 0.667 0.312 0.000 0.021 0.000 0.000
     3 0.550 0.250 0.150 0.050 0.000 0.000
     4 0.500 0.375 0.000 0.125 0.000 0.000
     5 0.545 0.273 0.182 0.000 0.000 0.000
Epoch 34/200 | Train Loss: 0.3605, Train Acc: 0.8692 | Val Loss: 2.1854, Val Acc: 0.3700, Val AUC: nan, Val Balanced Acc: 0.1678 | Val Class Acc: {0: 0.5403726708074534, 1: 0.40384615384615385, 2: 0.0625, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.540 0.360 0.037 0.025 0.025 0.012
     1 0.462 0.404 0.135 0.000 0.000 0.000
     2 0.417 0.479 0.062 0.021 0.021 0.000
     3 0.400 0.500 0.050 0.000 0.000 0.050
     4 0.375 0.500 0.125 0.000 0.000 0.000
     5 0.636 0.182 0.000 0.000 0.182 0.000
Epoch 35/200 | Train Loss: 0.3342, Train Acc: 0.8842 | Val Loss: 2.3750, Val Acc: 0.2967, Val AUC: nan, Val Balanced Acc: 0.1742 | Val Class Acc: {0: 0.39751552795031053, 1: 0.36538461538461536, 2: 0.041666666666666664, 3: 0.15, 4: 0.0, 5: 0.09090909090909091}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.398 0.342 0.081 0.161 0.000 0.019
     1 0.423 0.365 0.077 0.135 0.000 0.000
     2 0.333 0.396 0.042 0.208 0.021 0.000
     3 0.350 0.350 0.150 0.150 0.000 0.000
     4 0.375 0.250 0.250 0.125 0.000 0.000
     5 0.455 0.273 0.091 0.091 0.000 0.091
Epoch 36/200 | Train Loss: 0.2291, Train Acc: 0.9133 | Val Loss: 2.5854, Val Acc: 0.3667, Val AUC: nan, Val Balanced Acc: 0.1944 | Val Class Acc: {0: 0.5031055900621118, 1: 0.1346153846153846, 2: 0.4375, 3: 0.0, 4: 0.0, 5: 0.09090909090909091}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.503 0.112 0.360 0.000 0.019 0.006
     1 0.346 0.135 0.462 0.000 0.058 0.000
     2 0.458 0.083 0.438 0.000 0.021 0.000
     3 0.550 0.100 0.350 0.000 0.000 0.000
     4 0.375 0.250 0.375 0.000 0.000 0.000
     5 0.636 0.091 0.182 0.000 0.000 0.091
Epoch 37/200 | Train Loss: 0.3037, Train Acc: 0.8983 | Val Loss: 2.3036, Val Acc: 0.3667, Val AUC: nan, Val Balanced Acc: 0.1577 | Val Class Acc: {0: 0.5900621118012422, 1: 0.17307692307692307, 2: 0.08333333333333333, 3: 0.1, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.590 0.130 0.149 0.112 0.019 0.000
     1 0.635 0.173 0.135 0.038 0.019 0.000
     2 0.729 0.146 0.083 0.042 0.000 0.000
     3 0.650 0.100 0.150 0.100 0.000 0.000
     4 0.500 0.125 0.250 0.125 0.000 0.000
     5 0.727 0.091 0.182 0.000 0.000 0.000
Epoch 38/200 | Train Loss: 0.1950, Train Acc: 0.9317 | Val Loss: 2.2985, Val Acc: 0.4267, Val AUC: nan, Val Balanced Acc: 0.1685 | Val Class Acc: {0: 0.7080745341614907, 1: 0.21153846153846154, 2: 0.041666666666666664, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.708 0.130 0.068 0.093 0.000 0.000
     1 0.654 0.212 0.096 0.038 0.000 0.000
     2 0.833 0.083 0.042 0.042 0.000 0.000
     3 0.650 0.150 0.150 0.050 0.000 0.000
     4 0.750 0.000 0.250 0.000 0.000 0.000
     5 0.909 0.091 0.000 0.000 0.000 0.000
Epoch 39/200 | Train Loss: 0.2477, Train Acc: 0.9192 | Val Loss: 2.2877, Val Acc: 0.4200, Val AUC: nan, Val Balanced Acc: 0.1635 | Val Class Acc: {0: 0.6894409937888198, 1: 0.25, 2: 0.041666666666666664, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.689 0.230 0.056 0.019 0.000 0.006
     1 0.635 0.250 0.096 0.019 0.000 0.000
     2 0.667 0.250 0.042 0.021 0.021 0.000
     3 0.600 0.250 0.150 0.000 0.000 0.000
     4 0.625 0.125 0.125 0.000 0.000 0.125
     5 0.727 0.273 0.000 0.000 0.000 0.000
Epoch 40/200 | Train Loss: 0.1942, Train Acc: 0.9342 | Val Loss: 2.2347, Val Acc: 0.4467, Val AUC: nan, Val Balanced Acc: 0.1544 | Val Class Acc: {0: 0.7888198757763976, 1: 0.09615384615384616, 2: 0.041666666666666664, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.789 0.037 0.143 0.000 0.031 0.000
     1 0.654 0.096 0.250 0.000 0.000 0.000
     2 0.792 0.104 0.042 0.000 0.062 0.000
     3 0.750 0.050 0.200 0.000 0.000 0.000
     4 0.875 0.000 0.125 0.000 0.000 0.000
     5 0.909 0.091 0.000 0.000 0.000 0.000
Epoch 41/200 | Train Loss: 0.2872, Train Acc: 0.8975 | Val Loss: 2.4197, Val Acc: 0.3200, Val AUC: nan, Val Balanced Acc: 0.1772 | Val Class Acc: {0: 0.4472049689440994, 1: 0.21153846153846154, 2: 0.22916666666666666, 3: 0.05, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.447 0.217 0.255 0.019 0.056 0.006
     1 0.365 0.212 0.365 0.000 0.058 0.000
     2 0.500 0.250 0.229 0.000 0.021 0.000
     3 0.400 0.150 0.400 0.050 0.000 0.000
     4 0.500 0.250 0.000 0.125 0.125 0.000
     5 0.364 0.182 0.273 0.000 0.182 0.000
Epoch 42/200 | Train Loss: 0.2207, Train Acc: 0.9258 | Val Loss: 2.3210, Val Acc: 0.4300, Val AUC: nan, Val Balanced Acc: 0.1799 | Val Class Acc: {0: 0.6832298136645962, 1: 0.34615384615384615, 2: 0.0, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.683 0.199 0.019 0.043 0.050 0.006
     1 0.577 0.346 0.038 0.019 0.000 0.019
     2 0.667 0.333 0.000 0.000 0.000 0.000
     3 0.450 0.400 0.050 0.050 0.000 0.050
     4 0.625 0.375 0.000 0.000 0.000 0.000
     5 0.727 0.182 0.000 0.000 0.091 0.000
Epoch 43/200 | Train Loss: 0.2022, Train Acc: 0.9367 | Val Loss: 2.3225, Val Acc: 0.4200, Val AUC: nan, Val Balanced Acc: 0.1787 | Val Class Acc: {0: 0.6459627329192547, 1: 0.38461538461538464, 2: 0.041666666666666664, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.646 0.242 0.087 0.000 0.025 0.000
     1 0.500 0.385 0.115 0.000 0.000 0.000
     2 0.667 0.292 0.042 0.000 0.000 0.000
     3 0.700 0.150 0.150 0.000 0.000 0.000
     4 0.875 0.000 0.125 0.000 0.000 0.000
     5 0.727 0.273 0.000 0.000 0.000 0.000
Epoch 44/200 | Train Loss: 0.2488, Train Acc: 0.9100 | Val Loss: 2.6827, Val Acc: 0.2800, Val AUC: nan, Val Balanced Acc: 0.1509 | Val Class Acc: {0: 0.39751552795031053, 1: 0.3076923076923077, 2: 0.0, 3: 0.2, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.398 0.161 0.050 0.366 0.025 0.000
     1 0.346 0.308 0.077 0.269 0.000 0.000
     2 0.396 0.208 0.000 0.396 0.000 0.000
     3 0.500 0.250 0.050 0.200 0.000 0.000
     4 0.375 0.250 0.000 0.375 0.000 0.000
     5 0.545 0.273 0.000 0.182 0.000 0.000
Epoch 45/200 | Train Loss: 0.2086, Train Acc: 0.9258 | Val Loss: 2.1239, Val Acc: 0.4200, Val AUC: nan, Val Balanced Acc: 0.1681 | Val Class Acc: {0: 0.6770186335403726, 1: 0.2692307692307692, 2: 0.0625, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.677 0.174 0.099 0.025 0.019 0.006
     1 0.519 0.269 0.212 0.000 0.000 0.000
     2 0.688 0.250 0.062 0.000 0.000 0.000
     3 0.550 0.300 0.150 0.000 0.000 0.000
     4 0.250 0.375 0.375 0.000 0.000 0.000
     5 0.727 0.273 0.000 0.000 0.000 0.000
Epoch 46/200 | Train Loss: 0.1848, Train Acc: 0.9408 | Val Loss: 2.3887, Val Acc: 0.4300, Val AUC: nan, Val Balanced Acc: 0.2024 | Val Class Acc: {0: 0.6645962732919255, 1: 0.15384615384615385, 2: 0.2708333333333333, 3: 0.0, 4: 0.125, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.665 0.037 0.261 0.012 0.025 0.000
     1 0.519 0.154 0.308 0.000 0.019 0.000
     2 0.708 0.021 0.271 0.000 0.000 0.000
     3 0.450 0.200 0.350 0.000 0.000 0.000
     4 0.625 0.000 0.250 0.000 0.125 0.000
     5 0.727 0.091 0.182 0.000 0.000 0.000
Epoch 47/200 | Train Loss: 0.2262, Train Acc: 0.9283 | Val Loss: 2.7305, Val Acc: 0.3233, Val AUC: nan, Val Balanced Acc: 0.1627 | Val Class Acc: {0: 0.4720496894409938, 1: 0.25, 2: 0.10416666666666667, 3: 0.15, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.472 0.124 0.193 0.199 0.012 0.000
     1 0.442 0.250 0.212 0.096 0.000 0.000
     2 0.604 0.125 0.104 0.167 0.000 0.000
     3 0.450 0.250 0.150 0.150 0.000 0.000
     4 0.375 0.000 0.375 0.250 0.000 0.000
     5 0.727 0.000 0.182 0.091 0.000 0.000
Epoch 48/200 | Train Loss: 0.2490, Train Acc: 0.9083 | Val Loss: 2.3374, Val Acc: 0.4067, Val AUC: nan, Val Balanced Acc: 0.1694 | Val Class Acc: {0: 0.6521739130434783, 1: 0.23076923076923078, 2: 0.08333333333333333, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.652 0.155 0.050 0.068 0.019 0.056
     1 0.577 0.231 0.135 0.038 0.019 0.000
     2 0.688 0.146 0.083 0.062 0.000 0.021
     3 0.450 0.300 0.200 0.050 0.000 0.000
     4 0.750 0.250 0.000 0.000 0.000 0.000
     5 0.818 0.091 0.000 0.091 0.000 0.000
Epoch 49/200 | Train Loss: 0.1502, Train Acc: 0.9500 | Val Loss: 2.5431, Val Acc: 0.4233, Val AUC: nan, Val Balanced Acc: 0.1711 | Val Class Acc: {0: 0.6770186335403726, 1: 0.3076923076923077, 2: 0.041666666666666664, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.677 0.211 0.062 0.031 0.019 0.000
     1 0.577 0.308 0.077 0.038 0.000 0.000
     2 0.625 0.271 0.042 0.062 0.000 0.000
     3 0.550 0.350 0.100 0.000 0.000 0.000
     4 0.500 0.500 0.000 0.000 0.000 0.000
     5 0.818 0.182 0.000 0.000 0.000 0.000
Epoch 50/200 | Train Loss: 0.1883, Train Acc: 0.9325 | Val Loss: 2.3703, Val Acc: 0.3967, Val AUC: nan, Val Balanced Acc: 0.2142 | Val Class Acc: {0: 0.5900621118012422, 1: 0.25, 2: 0.10416666666666667, 3: 0.25, 4: 0.0, 5: 0.09090909090909091}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.590 0.255 0.050 0.062 0.019 0.025
     1 0.635 0.250 0.058 0.058 0.000 0.000
     2 0.583 0.208 0.104 0.104 0.000 0.000
     3 0.450 0.200 0.100 0.250 0.000 0.000
     4 0.500 0.000 0.250 0.250 0.000 0.000
     5 0.545 0.182 0.000 0.182 0.000 0.091
Epoch 51/200 | Train Loss: 0.1941, Train Acc: 0.9400 | Val Loss: 2.5093, Val Acc: 0.4467, Val AUC: nan, Val Balanced Acc: 0.1750 | Val Class Acc: {0: 0.7453416149068323, 1: 0.19230769230769232, 2: 0.0625, 3: 0.05, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.745 0.124 0.075 0.050 0.006 0.000
     1 0.635 0.192 0.096 0.077 0.000 0.000
     2 0.688 0.188 0.062 0.062 0.000 0.000
     3 0.600 0.200 0.150 0.050 0.000 0.000
     4 0.625 0.250 0.125 0.000 0.000 0.000
     5 0.909 0.000 0.000 0.091 0.000 0.000
Epoch 52/200 | Train Loss: 0.2076, Train Acc: 0.9283 | Val Loss: 2.4244, Val Acc: 0.4000, Val AUC: nan, Val Balanced Acc: 0.1752 | Val Class Acc: {0: 0.6086956521739131, 1: 0.19230769230769232, 2: 0.25, 3: 0.0, 4: 0.0, 5: 0.0}
Validation Confusion Matrix (normalize=true):
           0     1     2     3     4     5
     0 0.609 0.236 0.137 0.006 0.000 0.012
     1 0.635 0.192 0.154 0.019 0.000 0.000
     2 0.625 0.125 0.250 0.000 0.000 0.000
     3 0.500 0.300 0.200 0.000 0.000 0.000
     4 0.625 0.375 0.000 0.000 0.000 0.000
     5 0.636 0.091 0.273 0.000 0.000 0.000
