ARGS: Namespace(checkpoint=PosixPath('/Users/emma/Desktop/QUEENS/THESIS/contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth'), images_dir=PosixPath('/Users/emma/Desktop/QUEENS/THESIS/contrastive/mri_data/nnUNet_raw_data/Task2203_picai_baseline/imagesTr'), marksheet_csv=PosixPath('/Users/emma/Desktop/QUEENS/THESIS/contrastive/mri_data/picai_labels/clinical_information/marksheet_folds.csv'), train_folds=['fold1', 'fold2', 'fold3', 'fold4'], val_folds=['fold0'], epochs=20, batch_size=1, lr=0.0001, weight_decay=0.0001, num_workers=2, proj_dim=128, model_type='vit_b', device='cpu', out_dir=PosixPath('/Users/emma/Desktop/QUEENS/THESIS/contrastive/mri_model_medsam_finetune/results'), max_lr_epochs=None)
Using device: {device}
ISUPMedSAM(
  (image_encoder): ImageEncoderViT(
    (patch_embed): PatchEmbed(
      (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    )
    (blocks): ModuleList(
      (0-11): 12 x Block(
        (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=768, out_features=2304, bias=True)
          (proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (mlp): MLPBlock(
          (lin1): Linear(in_features=768, out_features=3072, bias=True)
          (lin2): Linear(in_features=3072, out_features=768, bias=True)
          (act): GELU(approximate='none')
        )
      )
    )
    (neck): Identity()
  )
  (projector): ABMILProjector(
    (attn_fc): Sequential(
      (0): Linear(in_features=768, out_features=256, bias=True)
      (1): Tanh()
    )
    (attn_score): Linear(in_features=256, out_features=1, bias=True)
    (embed_head): Sequential(
      (0): Linear(in_features=768, out_features=128, bias=True)
      (1): ReLU()
      (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (classifier): Linear(in_features=128, out_features=6, bias=True)
)
Training cases: 1199, Validation cases: 300
Class weights: tensor([0.1074, 0.4187, 0.3962, 0.9328, 2.3028, 1.8422])
