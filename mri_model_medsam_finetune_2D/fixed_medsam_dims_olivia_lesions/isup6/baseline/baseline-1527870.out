Host: kn069
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Sat Nov 29 01:53:26 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:CA:00.0 Off |                    0 |
| N/A   26C    P8             35W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
/project/6106383/ewillis/pca_contrastive/venv/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/project/6106383/ewillis/pca_contrastive/venv/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
SCRIPT: train.py
ARGS: Namespace(seed=42, manifest='/home/ewillis/projects/aip-medilab/shared/picai/manifests/slices_manifest_olivia_lesion.csv', sam_checkpoint='/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth', outdir='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/fixed_medsam_dims_olivia_lesions/isup6/baseline', target='isup6', folds_train='1,2,3', folds_val='0', folds_test='4', batch_size=16, epochs=40, patience=10, lr=1e-05, wd=0.0, pos_ratio=0.33, proj_dim=512, use_skip=False, label6_column='label6', freeze_epochs=2, wandb=True, wandb_project='mri-training', wandb_run_name='olivia-method-isup6')
wandb: Currently logged in as: jesande7 (jesande7-queens) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Changes to your `wandb` environment variables will be ignored because your `wandb` session has already started. For more information on how to modify your settings with `wandb.init()` arguments, please refer to https://wandb.me/wandb-init.
wandb: Tracking run with wandb version 0.21.2
wandb: Run data is saved locally in /project/6106383/shared/picai/wandb/run-20251129_015332-4orax97t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run olivia-method-isup6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jesande7-queens/mri-training
wandb: üöÄ View run at https://wandb.ai/jesande7-queens/mri-training/runs/4orax97t
!!!!!! classes_present [0, 1, 2, 3, 4, 5]
[probe][epoch1 batch 00] has_lesion: 4/16 (25%) || labels: ISUP0=10 (62%) | ISUP1=2 (12%) | ISUP2=2 (12%) | ISUP3=2 (12%)
[probe][epoch1 batch 01] has_lesion: 5/16 (31%) || labels: ISUP0=8 (50%) | ISUP1=3 (19%) | ISUP3=2 (12%) | ISUP4=1 (6%) | ISUP5=2 (12%)
[probe][epoch1 batch 02] has_lesion: 3/16 (19%) || labels: ISUP0=12 (75%) | ISUP2=3 (19%) | ISUP3=1 (6%)
[probe][epoch1 batch 03] has_lesion: 3/16 (19%) || labels: ISUP0=11 (69%) | ISUP1=2 (12%) | ISUP2=2 (12%) | ISUP5=1 (6%)
[probe][epoch1 batch 04] has_lesion: 8/16 (50%) || labels: ISUP0=6 (38%) | ISUP1=2 (12%) | ISUP2=5 (31%) | ISUP3=1 (6%) | ISUP4=1 (6%) | ISUP5=1 (6%)
[probe][epoch1 batch 05] has_lesion: 4/16 (25%) || labels: ISUP0=11 (69%) | ISUP1=1 (6%) | ISUP2=1 (6%) | ISUP3=1 (6%) | ISUP5=2 (12%)
[probe][epoch1 batch 06] has_lesion: 1/16 (6%) || labels: ISUP0=11 (69%) | ISUP1=3 (19%) | ISUP2=2 (12%)
[probe][epoch1 batch 07] has_lesion: 6/16 (38%) || labels: ISUP0=10 (62%) | ISUP2=2 (12%) | ISUP3=1 (6%) | ISUP4=1 (6%) | ISUP5=2 (12%)
[001] train: loss 1.7412 bacc 0.2302 acc 0.2533 f1 0.1728 | val: loss 0.7185 acc 0.3074 BAL-acc 0.2680 f1 0.1877 | acc[c0]=0.410  acc[c1]=0.189  acc[c2]=0.108  acc[c3]=0.122  acc[c4]=0.000  acc[c5]=0.780 | auc[c0]=0.788  auc[c1]=0.553  auc[c2]=0.513  auc[c3]=0.837  auc[c4]=0.708  auc[c5]=0.802 | macroAUC=0.700 | macroSens=0.268 macroSpec=0.864 | sens[c0]=0.410  sens[c1]=0.189  sens[c2]=0.108  sens[c3]=0.122  sens[c4]=0.000  sens[c5]=0.780 | spec[c0]=0.883  spec[c1]=0.855  spec[c2]=0.905  spec[c3]=0.895  spec[c4]=1.000  spec[c5]=0.645
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     331     146      74      64       0     193
    ISUP1      63      51      35      38       0      83
    ISUP2      13      29      25      34       0     130
    ISUP3       3       2      10      14       0      86
    ISUP4       3       2       2       3       0      26
    ISUP5       1       2       2       8       0      46
  ‚Ü≥ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/fixed_medsam_dims_olivia_lesions/isup6/baseline/ckpt_best.pt (BAL-acc=0.2680)
[002] train: loss 1.6394 bacc 0.3163 acc 0.4808 f1 0.2842 | val: loss 0.6843 acc 0.4760 BAL-acc 0.2944 f1 0.2478 | acc[c0]=0.720  acc[c1]=0.019  acc[c2]=0.260  acc[c3]=0.583  acc[c4]=0.083  acc[c5]=0.102 | auc[c0]=0.795  auc[c1]=0.539  auc[c2]=0.604  auc[c3]=0.833  auc[c4]=0.733  auc[c5]=0.791 | macroAUC=0.716 | macroSens=0.294 macroSpec=0.881 | sens[c0]=0.720  sens[c1]=0.019  sens[c2]=0.260  sens[c3]=0.583  sens[c4]=0.083  sens[c5]=0.102 | spec[c0]=0.730  spec[c1]=0.993  spec[c2]=0.817  spec[c3]=0.793  spec[c4]=0.974  spec[c5]=0.980
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     582       2     128      82       6       8
    ISUP1     123       5      74      59       9       0
    ISUP2      52       6      60     102       5       6
    ISUP3       8       0      19      67      12       9
    ISUP4       5       1       5      16       3       6
    ISUP5       4       0      10      32       7       6
  ‚Ü≥ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/fixed_medsam_dims_olivia_lesions/isup6/baseline/ckpt_best.pt (BAL-acc=0.2944)
‚Üí Unfroze encoder at epoch 3; added to optimizer with lr=1e-06
[003] train: loss 1.5296 bacc 0.3626 acc 0.5031 f1 0.3351 | val: loss 0.6712 acc 0.4154 BAL-acc 0.2754 f1 0.2487 | acc[c0]=0.587  acc[c1]=0.133  acc[c2]=0.368  acc[c3]=0.139  acc[c4]=0.222  acc[c5]=0.203 | auc[c0]=0.805  auc[c1]=0.543  auc[c2]=0.631  auc[c3]=0.821  auc[c4]=0.760  auc[c5]=0.738 | macroAUC=0.716 | macroSens=0.275 macroSpec=0.878 | sens[c0]=0.587  sens[c1]=0.133  sens[c2]=0.368  sens[c3]=0.139  sens[c4]=0.222  sens[c5]=0.203 | spec[c0]=0.838  spec[c1]=0.912  spec[c2]=0.771  spec[c3]=0.967  spec[c4]=0.898  spec[c5]=0.883
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     474      78     155      14      33      54
    ISUP1      88      36      85      13      28      20
    ISUP2      20      30      85      15      34      47
    ISUP3       4       0      24      16      36      35
    ISUP4       2       0      10       1       8      15
    ISUP5       1       2      21       3      20      12
  ‚Ü≥ no improvement (1/10)
[004] train: loss 1.4731 bacc 0.3926 acc 0.5187 f1 0.3536 | val: loss 0.6741 acc 0.4575 BAL-acc 0.2806 f1 0.2575 | acc[c0]=0.677  acc[c1]=0.111  acc[c2]=0.355  acc[c3]=0.130  acc[c4]=0.139  acc[c5]=0.271 | auc[c0]=0.812  auc[c1]=0.581  auc[c2]=0.639  auc[c3]=0.798  auc[c4]=0.788  auc[c5]=0.731 | macroAUC=0.725 | macroSens=0.281 macroSpec=0.882 | sens[c0]=0.677  sens[c1]=0.111  sens[c2]=0.355  sens[c3]=0.130  sens[c4]=0.139  sens[c5]=0.271 | spec[c0]=0.789  spec[c1]=0.932  spec[c2]=0.800  spec[c3]=0.965  spec[c4]=0.960  spec[c5]=0.847
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     547      50     125      12       9      65
    ISUP1     110      30      77      14       8      31
    ISUP2      30      29      82      17       9      64
    ISUP3       5       1      28      15      21      45
    ISUP4       3       1       8       1       5      18
    ISUP5       2       4      20       5      12      16
  ‚Ü≥ no improvement (2/10)
[005] train: loss 1.3947 bacc 0.4316 acc 0.5270 f1 0.3984 | val: loss 0.6601 acc 0.4595 BAL-acc 0.3158 f1 0.2895 | acc[c0]=0.635  acc[c1]=0.296  acc[c2]=0.208  acc[c3]=0.313  acc[c4]=0.222  acc[c5]=0.220 | auc[c0]=0.815  auc[c1]=0.586  auc[c2]=0.636  auc[c3]=0.811  auc[c4]=0.792  auc[c5]=0.776 | macroAUC=0.736 | macroSens=0.316 macroSpec=0.884 | sens[c0]=0.635  sens[c1]=0.296  sens[c2]=0.208  sens[c3]=0.313  sens[c4]=0.222  sens[c5]=0.220 | spec[c0]=0.823  spec[c1]=0.823  spec[c2]=0.889  spec[c3]=0.916  spec[c4]=0.927  spec[c5]=0.929
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     513     149      75      31      21      19
    ISUP1      93      80      43      24      19      11
    ISUP2      24      57      48      45      22      35
    ISUP3       4       5      13      36      31      26
    ISUP4       4       4       5       2       8      13
    ISUP5       1       6       7      16      16      13
  ‚Ü≥ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/fixed_medsam_dims_olivia_lesions/isup6/baseline/ckpt_best.pt (BAL-acc=0.3158)
[006] train: loss 1.2921 bacc 0.5103 acc 0.5497 f1 0.4626 | val: loss 0.6709 acc 0.5135 BAL-acc 0.3435 f1 0.3152 | acc[c0]=0.746  acc[c1]=0.193  acc[c2]=0.290  acc[c3]=0.296  acc[c4]=0.333  acc[c5]=0.203 | auc[c0]=0.819  auc[c1]=0.603  auc[c2]=0.673  auc[c3]=0.806  auc[c4]=0.809  auc[c5]=0.745 | macroAUC=0.743 | macroSens=0.344 macroSpec=0.889 | sens[c0]=0.746  sens[c1]=0.193  sens[c2]=0.290  sens[c3]=0.296  sens[c4]=0.333  sens[c5]=0.203 | spec[c0]=0.745  spec[c1]=0.912  spec[c2]=0.870  spec[c3]=0.943  spec[c4]=0.908  spec[c5]=0.956
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     603      72      79      22      23       9
    ISUP1     118      52      53      18      23       6
    ISUP2      46      31      67      30      32      25
    ISUP3      10       2      18      34      35      16
    ISUP4       4       2       8       2      12       8
    ISUP5       3       3      10       8      23      12
  ‚Ü≥ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/fixed_medsam_dims_olivia_lesions/isup6/baseline/ckpt_best.pt (BAL-acc=0.3435)
[007] train: loss 1.1988 bacc 0.5323 acc 0.5779 f1 0.4788 | val: loss 0.6853 acc 0.5056 BAL-acc 0.3401 f1 0.3190 | acc[c0]=0.720  acc[c1]=0.174  acc[c2]=0.312  acc[c3]=0.409  acc[c4]=0.222  acc[c5]=0.203 | auc[c0]=0.820  auc[c1]=0.599  auc[c2]=0.670  auc[c3]=0.799  auc[c4]=0.819  auc[c5]=0.740 | macroAUC=0.741 | macroSens=0.340 macroSpec=0.887 | sens[c0]=0.720  sens[c1]=0.174  sens[c2]=0.312  sens[c3]=0.409  sens[c4]=0.222  sens[c5]=0.203 | spec[c0]=0.759  spec[c1]=0.904  spec[c2]=0.828  spec[c3]=0.907  spec[c4]=0.967  spec[c5]=0.960
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     582      77     100      33       9       7
    ISUP1     114      47      66      30       8       5
    ISUP2      40      37      72      48      11      23
    ISUP3      11       1      27      47      14      15
    ISUP4       4       2      11       3       8       8
    ISUP5       2       3      18      17       7      12
  ‚Ü≥ no improvement (1/10)
[008] train: loss 1.0929 bacc 0.5756 acc 0.5853 f1 0.5212 | val: loss 0.7029 acc 0.4213 BAL-acc 0.3345 f1 0.2912 | acc[c0]=0.533  acc[c1]=0.267  acc[c2]=0.351  acc[c3]=0.235  acc[c4]=0.333  acc[c5]=0.288 | auc[c0]=0.819  auc[c1]=0.584  auc[c2]=0.631  auc[c3]=0.704  auc[c4]=0.813  auc[c5]=0.722 | macroAUC=0.712 | macroSens=0.334 macroSpec=0.880 | sens[c0]=0.533  sens[c1]=0.267  sens[c2]=0.351  sens[c3]=0.235  sens[c4]=0.333  sens[c5]=0.288 | spec[c0]=0.865  spec[c1]=0.851  spec[c2]=0.793  spec[c3]=0.927  spec[c4]=0.929  spec[c5]=0.917
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     431     147     162      29      15      24
    ISUP1      70      72      68      28      20      12
    ISUP2      19      31      81      36      21      43
    ISUP3       4       2      19      27      32      31
    ISUP4       3       1       7       2      12      11
    ISUP5       0       5      11       8      18      17
  ‚Ü≥ no improvement (2/10)
[009] train: loss 1.0388 bacc 0.6052 acc 0.6035 f1 0.5485 | val: loss 0.7069 acc 0.4187 BAL-acc 0.3310 f1 0.2967 | acc[c0]=0.509  acc[c1]=0.322  acc[c2]=0.381  acc[c3]=0.191  acc[c4]=0.278  acc[c5]=0.305 | auc[c0]=0.822  auc[c1]=0.591  auc[c2]=0.665  auc[c3]=0.721  auc[c4]=0.824  auc[c5]=0.729 | macroAUC=0.726 | macroSens=0.331 macroSpec=0.879 | sens[c0]=0.509  sens[c1]=0.322  sens[c2]=0.381  sens[c3]=0.191  sens[c4]=0.278  sens[c5]=0.305 | spec[c0]=0.871  spec[c1]=0.788  spec[c2]=0.783  spec[c3]=0.950  spec[c4]=0.946  spec[c5]=0.934
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     411     204     150      14      13      16
    ISUP1      68      87      69      19      16      11
    ISUP2      17      51      88      26      17      32
    ISUP3       4       3      34      22      24      28
    ISUP4       3       2      10       2      10       9
    ISUP5       0       5      17       9      10      18
  ‚Ü≥ no improvement (3/10)
[010] train: loss 0.9367 bacc 0.6731 acc 0.6325 f1 0.6134 | val: loss 0.7344 acc 0.4905 BAL-acc 0.3248 f1 0.3028 | acc[c0]=0.700  acc[c1]=0.178  acc[c2]=0.320  acc[c3]=0.296  acc[c4]=0.167  acc[c5]=0.288 | auc[c0]=0.824  auc[c1]=0.599  auc[c2]=0.665  auc[c3]=0.731  auc[c4]=0.828  auc[c5]=0.734 | macroAUC=0.730 | macroSens=0.325 macroSpec=0.888 | sens[c0]=0.700  sens[c1]=0.178  sens[c2]=0.320  sens[c3]=0.296  sens[c4]=0.167  sens[c5]=0.288 | spec[c0]=0.793  spec[c1]=0.897  spec[c2]=0.828  spec[c3]=0.897  spec[c4]=0.968  spec[c5]=0.942
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     566      88      98      36      11       9
    ISUP1     104      48      67      34       9       8
    ISUP2      31      33      74      52       8      33
    ISUP3       9       1      30      34      15      26
    ISUP4       3       2      10       6       6       9
    ISUP5       0       5      16      16       5      17
  ‚Ü≥ no improvement (4/10)
[011] train: loss 0.8478 bacc 0.7011 acc 0.6620 f1 0.6512 | val: loss 0.7527 acc 0.4727 BAL-acc 0.3374 f1 0.3089 | acc[c0]=0.632  acc[c1]=0.237  acc[c2]=0.403  acc[c3]=0.191  acc[c4]=0.222  acc[c5]=0.339 | auc[c0]=0.823  auc[c1]=0.597  auc[c2]=0.664  auc[c3]=0.683  auc[c4]=0.836  auc[c5]=0.737 | macroAUC=0.723 | macroSens=0.337 macroSpec=0.886 | sens[c0]=0.632  sens[c1]=0.237  sens[c2]=0.403  sens[c3]=0.191  sens[c4]=0.222  sens[c5]=0.339 | spec[c0]=0.828  spec[c1]=0.880  spec[c2]=0.780  spec[c3]=0.941  spec[c4]=0.955  spec[c5]=0.934
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     511     109     143      17      16      12
    ISUP1      87      64      72      25      11      11
    ISUP2      26      32      93      31      15      34
    ISUP3       7       2      36      22      19      29
    ISUP4       2       2      12       2       8      10
    ISUP5       0       5      21       8       5      20
  ‚Ü≥ no improvement (5/10)
[012] train: loss 0.7471 bacc 0.7441 acc 0.6758 f1 0.6925 | val: loss 0.7854 acc 0.4549 BAL-acc 0.3431 f1 0.3193 | acc[c0]=0.551  acc[c1]=0.389  acc[c2]=0.416  acc[c3]=0.165  acc[c4]=0.250  acc[c5]=0.288 | auc[c0]=0.822  auc[c1]=0.596  auc[c2]=0.682  auc[c3]=0.701  auc[c4]=0.842  auc[c5]=0.718 | macroAUC=0.727 | macroSens=0.343 macroSpec=0.884 | sens[c0]=0.551  sens[c1]=0.389  sens[c2]=0.416  sens[c3]=0.165  sens[c4]=0.250  sens[c5]=0.288 | spec[c0]=0.865  spec[c1]=0.764  spec[c2]=0.808  spec[c3]=0.949  spec[c4]=0.963  spec[c5]=0.956
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     445     216     113      15      11       8
    ISUP1      71     105      58      20      11       5
    ISUP2      18      62      96      24      10      21
    ISUP3       6       5      45      19      18      22
    ISUP4       1       3      12       3       9       8
    ISUP5       0       9      19       9       5      17
  ‚Ü≥ no improvement (6/10)
[013] train: loss 0.6813 bacc 0.7724 acc 0.6958 f1 0.7169 | val: loss 0.8282 acc 0.4483 BAL-acc 0.3306 f1 0.3093 | acc[c0]=0.545  acc[c1]=0.341  acc[c2]=0.437  acc[c3]=0.217  acc[c4]=0.139  acc[c5]=0.305 | auc[c0]=0.821  auc[c1]=0.584  auc[c2]=0.665  auc[c3]=0.681  auc[c4]=0.846  auc[c5]=0.701 | macroAUC=0.716 | macroSens=0.331 macroSpec=0.883 | sens[c0]=0.545  sens[c1]=0.341  sens[c2]=0.437  sens[c3]=0.217  sens[c4]=0.139  sens[c5]=0.305 | spec[c0]=0.854  spec[c1]=0.819  spec[c2]=0.769  spec[c3]=0.936  spec[c4]=0.977  spec[c5]=0.941
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     440     176     152      21       7      12
    ISUP1      72      92      67      22       6      11
    ISUP2      24      39     101      33       7      27
    ISUP3       6       3      43      25      11      27
    ISUP4       2       2      13       5       5       9
    ISUP5       0       6      23       9       3      18
  ‚Ü≥ no improvement (7/10)
[014] train: loss 0.5765 bacc 0.8071 acc 0.7107 f1 0.7524 | val: loss 0.8739 acc 0.4720 BAL-acc 0.3284 f1 0.3153 | acc[c0]=0.614  acc[c1]=0.285  acc[c2]=0.416  acc[c3]=0.235  acc[c4]=0.167  acc[c5]=0.254 | auc[c0]=0.816  auc[c1]=0.588  auc[c2]=0.670  auc[c3]=0.692  auc[c4]=0.843  auc[c5]=0.699 | macroAUC=0.718 | macroSens=0.328 macroSpec=0.884 | sens[c0]=0.614  sens[c1]=0.285  sens[c2]=0.416  sens[c3]=0.235  sens[c4]=0.167  sens[c5]=0.254 | spec[c0]=0.817  spec[c1]=0.837  spec[c2]=0.788  spec[c3]=0.931  spec[c4]=0.976  spec[c5]=0.957
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     496     148     126      26       5       7
    ISUP1      88      77      72      22       6       5
    ISUP2      30      40      96      34       8      23
    ISUP3      10       5      40      27      13      20
    ISUP4       1       3      13       5       6       8
    ISUP5       1       8      22      10       3      15
  ‚Ü≥ no improvement (8/10)
[015] train: loss 0.4841 bacc 0.8331 acc 0.7502 f1 0.7883 | val: loss 0.9324 acc 0.4700 BAL-acc 0.3145 f1 0.3049 | acc[c0]=0.624  acc[c1]=0.267  acc[c2]=0.403  acc[c3]=0.235  acc[c4]=0.139  acc[c5]=0.220 | auc[c0]=0.813  auc[c1]=0.589  auc[c2]=0.660  auc[c3]=0.709  auc[c4]=0.834  auc[c5]=0.705 | macroAUC=0.718 | macroSens=0.315 macroSpec=0.884 | sens[c0]=0.624  sens[c1]=0.267  sens[c2]=0.403  sens[c3]=0.235  sens[c4]=0.139  sens[c5]=0.220 | spec[c0]=0.812  spec[c1]=0.845  spec[c2]=0.783  spec[c3]=0.921  spec[c4]=0.980  spec[c5]=0.960
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     504     134     131      28       4       7
    ISUP1      94      72      69      26       5       4
    ISUP2      29      39      93      42       7      21
    ISUP3       8       7      45      27      10      18
    ISUP4       1       3      13       5       5       9
    ISUP5       2      10      21      10       3      13
  ‚Ü≥ no improvement (9/10)
[016] train: loss 0.4329 bacc 0.8558 acc 0.7699 f1 0.8152 | val: loss 0.9772 acc 0.4595 BAL-acc 0.3120 f1 0.3013 | acc[c0]=0.595  acc[c1]=0.293  acc[c2]=0.429  acc[c3]=0.191  acc[c4]=0.194  acc[c5]=0.169 | auc[c0]=0.809  auc[c1]=0.593  auc[c2]=0.670  auc[c3]=0.691  auc[c4]=0.830  auc[c5]=0.688 | macroAUC=0.714 | macroSens=0.312 macroSpec=0.882 | sens[c0]=0.595  sens[c1]=0.293  sens[c2]=0.429  sens[c3]=0.191  sens[c4]=0.194  sens[c5]=0.169 | spec[c0]=0.824  spec[c1]=0.821  spec[c2]=0.769  spec[c3]=0.940  spec[c4]=0.974  spec[c5]=0.964
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     481     154     136      22       8       7
    ISUP1      87      79      73      21       6       4
    ISUP2      27      46      99      30       9      20
    ISUP3       8      10      48      22      12      15
    ISUP4       1       3      13       5       7       7
    ISUP5       2      11      27       6       3      10
  ‚Ü≥ no improvement (10/10)
Early stopping at epoch 16.

=== Final model: Sensitivity at fixed specificity === (validation)
       class |          AUC |  Sens@Spec40 |  Sens@Spec60 |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec99
          c0 |        0.819 |        0.950 |        0.880 |        0.694 |        0.431 |        0.256 |        0.083
          c1 |        0.603 |        0.737 |        0.556 |        0.319 |        0.156 |        0.059 |        0.026
          c2 |        0.673 |        0.823 |        0.667 |        0.398 |        0.203 |        0.113 |        0.009
          c3 |        0.806 |        0.965 |        0.843 |        0.583 |        0.478 |        0.304 |        0.113
          c4 |        0.809 |        0.944 |        0.889 |        0.611 |        0.361 |        0.250 |        0.028
          c5 |        0.745 |        0.898 |        0.797 |        0.475 |        0.288 |        0.237 |        0.051
       macro |        0.743 |        0.886 |        0.772 |        0.513 |        0.320 |        0.203 |        0.052
[TEST] loss 0.6376 acc 0.5382 f1 0.3389 | acc[c0]=0.785  acc[c1]=0.184  acc[c2]=0.285  acc[c3]=0.202  acc[c4]=0.595  acc[c5]=0.308 | auc[c0]=0.823  auc[c1]=0.616  auc[c2]=0.660  auc[c3]=0.780  auc[c4]=0.878  auc[c5]=0.794 | macroAUC=0.758 | macroSens=0.393 macroSpec=0.891 | sens[c0]=0.785  sens[c1]=0.184  sens[c2]=0.285  sens[c3]=0.202  sens[c4]=0.595  sens[c5]=0.308 | spec[c0]=0.714  spec[c1]=0.904  spec[c2]=0.889  spec[c3]=0.951  spec[c4]=0.931  spec[c5]=0.955
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     638      78      60      14      12      11
    ISUP1     124      45      41      12      15       7
    ISUP2      50      29      72      30      33      39
    ISUP3      15      13      30      26      37       8
    ISUP4       5       1       4       6      25       1
    ISUP5       8       2       6       6       5      12

=== Final model: Sensitivity at fixed specificity === (test)
       class |          AUC |  Sens@Spec40 |  Sens@Spec60 |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec99
          c0 |        0.823 |        0.964 |        0.903 |        0.646 |        0.427 |        0.285 |        0.129
          c1 |        0.616 |        0.766 |        0.553 |        0.320 |        0.197 |        0.111 |        0.025
          c2 |        0.660 |        0.806 |        0.644 |        0.399 |        0.249 |        0.178 |        0.036
          c3 |        0.780 |        0.922 |        0.853 |        0.612 |        0.310 |        0.225 |        0.031
          c4 |        0.878 |        1.000 |        0.929 |        0.714 |        0.667 |        0.548 |        0.143
          c5 |        0.794 |        0.897 |        0.795 |        0.718 |        0.513 |        0.308 |        0.077
       macro |        0.758 |        0.893 |        0.779 |        0.568 |        0.394 |        0.276 |        0.073
wandb: updating run metadata
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:             aux/lr ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: aux/test/macro_tnr ‚ñÅ
wandb: aux/test/macro_tpr ‚ñÅ
wandb:      aux/train/acc ‚ñÅ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà
wandb: aux/train/f1_macro ‚ñÅ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñà
wandb:  aux/val/macro_tnr ‚ñÅ‚ñÜ‚ñÖ‚ñÜ‚ñá‚ñà‚ñà‚ñÜ‚ñÖ‚ñà‚ñá‚ñá‚ñÜ‚ñá‚ñÜ‚ñÜ
wandb:  aux/val/macro_tpr ‚ñÅ‚ñÉ‚ñÇ‚ñÇ‚ñÖ‚ñà‚ñà‚ñá‚ñá‚ñÜ‚ñá‚ñà‚ñá‚ñá‚ñÖ‚ñÖ
wandb:              epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñà
wandb:        test/acc_c0 ‚ñÅ
wandb:        test/acc_c1 ‚ñÅ
wandb:                +30 ...
wandb: 
wandb: Run summary:
wandb:             aux/lr 1e-05
wandb: aux/test/macro_tnr 0.89069
wandb: aux/test/macro_tpr 0.39304
wandb:      aux/train/acc 0.76988
wandb: aux/train/f1_macro 0.81524
wandb:  aux/val/macro_tnr 0.88208
wandb:  aux/val/macro_tpr 0.31195
wandb:              epoch 40
wandb:        test/acc_c0 0.78475
wandb:        test/acc_c1 0.18443
wandb:                +30 ...
wandb: 
wandb: üöÄ View run olivia-method-isup6 at: https://wandb.ai/jesande7-queens/mri-training/runs/4orax97t
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/jesande7-queens/mri-training
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251129_015332-4orax97t/logs
