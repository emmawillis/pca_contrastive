Host: kn045
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Fri Oct 17 15:31:19 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:65:00.0 Off |                    0 |
| N/A   27C    P8             35W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[probe][epoch1 batch 00] has_lesion: 7/16 (44%) || labels: ISUP01=9 (56%) | ISUP23=5 (31%) | ISUP45=2 (12%)
[probe][epoch1 batch 01] has_lesion: 8/16 (50%) || labels: ISUP01=8 (50%) | ISUP23=4 (25%) | ISUP45=4 (25%)
[001] train: loss 0.9349 acc 0.2219 f1 0.1857 | val: loss 1.9720 acc 0.0473 f1 0.0523 | acc[c0]=0.000  acc[c1]=0.630  acc[c2]=0.451 | auc[c0]=0.597  auc[c1]=0.555  auc[c2]=0.540 | macroAUC=0.564 | macroSens=0.360 macroSpec=0.668 | sens[c0]=0.000  sens[c1]=0.630  sens[c2]=0.451 | spec[c0]=1.000  spec[c1]=0.410  spec[c2]=0.593
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01       0    2976    2062
   ISUP23       0     218     128
   ISUP45       0      50      41
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_smaller_lr/results512/baseline/ckpt_best.pt (BAL-acc=0.3602)
[002] train: loss 0.9165 acc 0.2093 f1 0.1828 | val: loss 1.9053 acc 0.0499 f1 0.0535 | acc[c0]=0.000  acc[c1]=0.671  acc[c2]=0.440 | auc[c0]=0.650  auc[c1]=0.580  auc[c2]=0.537 | macroAUC=0.589 | macroSens=0.370 macroSpec=0.668 | sens[c0]=0.000  sens[c1]=0.671  sens[c2]=0.440 | spec[c0]=1.000  spec[c1]=0.373  spec[c2]=0.631
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01       1    3166    1871
   ISUP23       0     232     114
   ISUP45       0      51      40
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_smaller_lr/results512/baseline/ckpt_best.pt (BAL-acc=0.3701)
→ Unfroze encoder at epoch 3; added to optimizer with lr=1e-06
[003] train: loss 0.7831 acc 0.2695 f1 0.2539 | val: loss 1.5027 acc 0.1688 f1 0.1352 | acc[c0]=0.125  acc[c1]=0.760  acc[c2]=0.352 | auc[c0]=0.793  auc[c1]=0.638  auc[c2]=0.643 | macroAUC=0.691 | macroSens=0.412 macroSpec=0.704 | sens[c0]=0.125  sens[c1]=0.760  sens[c2]=0.352 | spec[c0]=0.991  spec[c1]=0.305  spec[c2]=0.817
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     629    3505     904
   ISUP23       3     263      80
   ISUP45       1      58      32
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_smaller_lr/results512/baseline/ckpt_best.pt (BAL-acc=0.4122)
[004] train: loss 0.4670 acc 0.5108 f1 0.5297 | val: loss 1.1145 acc 0.5452 f1 0.3186 | acc[c0]=0.540  acc[c1]=0.714  acc[c2]=0.198 | auc[c0]=0.823  auc[c1]=0.707  auc[c2]=0.646 | macroAUC=0.725 | macroSens=0.484 macroSpec=0.804 | sens[c0]=0.540  sens[c1]=0.714  sens[c2]=0.198 | spec[c0]=0.883  spec[c1]=0.600  spec[c2]=0.928
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2720    1988     330
   ISUP23      40     247      59
   ISUP45      11      62      18
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_smaller_lr/results512/baseline/ckpt_best.pt (BAL-acc=0.4839)
[005] train: loss 0.2193 acc 0.7550 f1 0.7590 | val: loss 0.9939 acc 0.7037 f1 0.4008 | acc[c0]=0.714  acc[c1]=0.668  acc[c2]=0.275 | auc[c0]=0.849  auc[c1]=0.763  auc[c2]=0.662 | macroAUC=0.758 | macroSens=0.552 macroSpec=0.842 | sens[c0]=0.714  sens[c1]=0.668  sens[c2]=0.275 | spec[c0]=0.824  spec[c1]=0.754  spec[c2]=0.947
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3597    1208     233
   ISUP23      65     231      50
   ISUP45      12      54      25
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_smaller_lr/results512/baseline/ckpt_best.pt (BAL-acc=0.5521)
[006] train: loss 0.1099 acc 0.8825 f1 0.8770 | val: loss 0.9193 acc 0.8274 f1 0.4483 | acc[c0]=0.859  acc[c1]=0.532  acc[c2]=0.176 | auc[c0]=0.847  auc[c1]=0.790  auc[c2]=0.727 | macroAUC=0.788 | macroSens=0.522 macroSpec=0.830 | sens[c0]=0.859  sens[c1]=0.532  sens[c2]=0.176 | spec[c0]=0.641  spec[c1]=0.880  spec[c2]=0.968
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4330     577     131
   ISUP23     121     184      41
   ISUP45      36      39      16
  ↳ no improvement (1/10)
[007] train: loss 0.0496 acc 0.9454 f1 0.9388 | val: loss 1.0969 acc 0.8542 f1 0.4694 | acc[c0]=0.893  acc[c1]=0.445  acc[c2]=0.253 | auc[c0]=0.849  auc[c1]=0.796  auc[c2]=0.775 | macroAUC=0.807 | macroSens=0.530 macroSpec=0.826 | sens[c0]=0.893  sens[c1]=0.445  sens[c2]=0.253 | spec[c0]=0.597  spec[c1]=0.916  spec[c2]=0.965
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4500     398     140
   ISUP23     141     154      51
   ISUP45      35      33      23
  ↳ no improvement (2/10)
[008] train: loss 0.0204 acc 0.9707 f1 0.9671 | val: loss 1.3141 acc 0.8875 f1 0.4895 | acc[c0]=0.933  acc[c1]=0.410  acc[c2]=0.187 | auc[c0]=0.850  auc[c1]=0.810  auc[c2]=0.800 | macroAUC=0.820 | macroSens=0.510 macroSpec=0.811 | sens[c0]=0.933  sens[c1]=0.410  sens[c2]=0.187 | spec[c0]=0.510  spec[c1]=0.941  spec[c2]=0.982
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4700     276      62
   ISUP23     169     142      35
   ISUP45      45      29      17
  ↳ no improvement (3/10)
[009] train: loss 0.0086 acc 0.9863 f1 0.9834 | val: loss 1.6419 acc 0.9047 f1 0.4906 | acc[c0]=0.957  acc[c1]=0.332  acc[c2]=0.165 | auc[c0]=0.845  auc[c1]=0.809  auc[c2]=0.807 | macroAUC=0.820 | macroSens=0.485 macroSpec=0.788 | sens[c0]=0.957  sens[c1]=0.332  sens[c2]=0.165 | spec[c0]=0.416  spec[c1]=0.962  spec[c2]=0.986
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4823     169      46
   ISUP23     203     115      28
   ISUP45      52      24      15
  ↳ no improvement (4/10)
[010] train: loss 0.0048 acc 0.9931 f1 0.9918 | val: loss 1.8551 acc 0.9100 f1 0.4946 | acc[c0]=0.965  acc[c1]=0.306  acc[c2]=0.165 | auc[c0]=0.840  auc[c1]=0.809  auc[c2]=0.809 | macroAUC=0.819 | macroSens=0.479 macroSpec=0.777 | sens[c0]=0.965  sens[c1]=0.306  sens[c2]=0.165 | spec[c0]=0.373  spec[c1]=0.969  spec[c2]=0.989
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4861     141      36
   ISUP23     217     106      23
   ISUP45      57      19      15
  ↳ no improvement (5/10)
[011] train: loss 0.0025 acc 0.9957 f1 0.9948 | val: loss 2.0797 acc 0.9100 f1 0.4739 | acc[c0]=0.969  acc[c1]=0.257  acc[c2]=0.143 | auc[c0]=0.839  auc[c1]=0.802  auc[c2]=0.814 | macroAUC=0.818 | macroSens=0.456 macroSpec=0.766 | sens[c0]=0.969  sens[c1]=0.257  sens[c2]=0.143 | spec[c0]=0.336  spec[c1]=0.973  spec[c2]=0.988
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4880     121      37
   ISUP23     232      89      25
   ISUP45      58      20      13
  ↳ no improvement (6/10)
[012] train: loss 0.0016 acc 0.9975 f1 0.9971 | val: loss 2.2967 acc 0.9123 f1 0.4701 | acc[c0]=0.973  acc[c1]=0.237  acc[c2]=0.132 | auc[c0]=0.836  auc[c1]=0.800  auc[c2]=0.811 | macroAUC=0.816 | macroSens=0.447 macroSpec=0.757 | sens[c0]=0.973  sens[c1]=0.237  sens[c2]=0.132 | spec[c0]=0.304  spec[c1]=0.975  spec[c2]=0.991
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4901     108      29
   ISUP23     244      82      20
   ISUP45      60      19      12
  ↳ no improvement (7/10)
[013] train: loss 0.0006 acc 0.9989 f1 0.9988 | val: loss 2.3046 acc 0.9098 f1 0.4846 | acc[c0]=0.967  acc[c1]=0.263  acc[c2]=0.176 | auc[c0]=0.845  auc[c1]=0.809  auc[c2]=0.826 | macroAUC=0.827 | macroSens=0.469 macroSpec=0.771 | sens[c0]=0.967  sens[c1]=0.263  sens[c2]=0.176 | spec[c0]=0.352  spec[c1]=0.972  spec[c2]=0.988
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4874     125      39
   ISUP23     228      91      27
   ISUP45      55      20      16
  ↳ no improvement (8/10)
[014] train: loss 0.0007 acc 0.9992 f1 0.9989 | val: loss 2.3934 acc 0.9121 f1 0.4893 | acc[c0]=0.969  acc[c1]=0.286  acc[c2]=0.154 | auc[c0]=0.844  auc[c1]=0.811  auc[c2]=0.822 | macroAUC=0.826 | macroSens=0.470 macroSpec=0.775 | sens[c0]=0.969  sens[c1]=0.286  sens[c2]=0.154 | spec[c0]=0.364  spec[c1]=0.971  spec[c2]=0.990
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4881     128      29
   ISUP23     224      99      23
   ISUP45      54      23      14
  ↳ no improvement (9/10)
[015] train: loss 0.0003 acc 0.9997 f1 0.9997 | val: loss 2.6378 acc 0.9147 f1 0.4711 | acc[c0]=0.975  acc[c1]=0.246  acc[c2]=0.121 | auc[c0]=0.838  auc[c1]=0.807  auc[c2]=0.818 | macroAUC=0.821 | macroSens=0.447 macroSpec=0.761 | sens[c0]=0.975  sens[c1]=0.246  sens[c2]=0.121 | spec[c0]=0.316  spec[c1]=0.977  spec[c2]=0.991
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4912      99      27
   ISUP23     239      85      22
   ISUP45      60      20      11
  ↳ no improvement (10/10)
Early stopping triggered at epoch 15: no BAL-acc improvement for 10 epochs.

=== Final model: Sensitivity at fixed specificity (validation) ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.849 |        0.746 |        0.584 |        0.459 |        0.369 |        0.250
          c1 |        0.763 |        0.598 |        0.431 |        0.298 |        0.182 |        0.098
          c2 |        0.662 |        0.505 |        0.385 |        0.286 |        0.110 |        0.033
       macro |        0.758 |        0.617 |        0.466 |        0.347 |        0.220 |        0.127
