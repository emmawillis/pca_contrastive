Host: kn080
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Sun Oct 19 23:12:11 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:E3:00.0 Off |                    0 |
| N/A   28C    P8             34W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[probe][epoch1 batch 00] has_lesion: 1/16 (6%) || labels: ISUP01=15 (94%) | ISUP23=1 (6%)
[probe][epoch1 batch 01] has_lesion: 5/16 (31%) || labels: ISUP01=11 (69%) | ISUP23=5 (31%)
[001] train: loss 1.0900 acc 0.2640 f1 0.2295 | val: loss 1.2567 acc 0.0776 f1 0.0659 | acc[c0]=0.028  acc[c1]=0.786  acc[c2]=0.143 | auc[c0]=0.498  auc[c1]=0.509  auc[c2]=0.469 | macroAUC=0.492 | macroSens=0.319 macroSpec=0.672 | sens[c0]=0.028  sens[c1]=0.786  sens[c2]=0.143 | spec[c0]=0.986  spec[c1]=0.277  spec[c2]=0.752
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     140    3629    1269
   ISUP23       6     272      68
   ISUP45       0      78      13
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3189)
[002] train: loss 1.0157 acc 0.2102 f1 0.1599 | val: loss 1.4274 acc 0.0608 f1 0.0487 | acc[c0]=0.004  acc[c1]=0.890  acc[c2]=0.077 | auc[c0]=0.525  auc[c1]=0.520  auc[c2]=0.505 | macroAUC=0.517 | macroSens=0.324 macroSpec=0.668 | sens[c0]=0.004  sens[c1]=0.890  sens[c2]=0.077 | spec[c0]=1.000  spec[c1]=0.157  spec[c2]=0.848
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01      18    4238     782
   ISUP23       0     308      38
   ISUP45       0      84       7
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3236)
→ Unfroze encoder at epoch 3; added to optimizer with lr=1e-07
[003] train: loss 0.9598 acc 0.2272 f1 0.1615 | val: loss 1.6159 acc 0.0612 f1 0.0433 | acc[c0]=0.001  acc[c1]=0.954  acc[c2]=0.011 | auc[c0]=0.619  auc[c1]=0.576  auc[c2]=0.561 | macroAUC=0.585 | macroSens=0.322 macroSpec=0.668 | sens[c0]=0.001  sens[c1]=0.954  sens[c2]=0.011 | spec[c0]=1.000  spec[c1]=0.103  spec[c2]=0.900
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01       4    4511     523
   ISUP23       0     330      16
   ISUP45       0      90       1
  ↳ no improvement (1/10)
[004] train: loss 0.9385 acc 0.2235 f1 0.1544 | val: loss 1.7143 acc 0.0643 f1 0.0460 | acc[c0]=0.003  acc[c1]=0.974  acc[c2]=0.011 | auc[c0]=0.664  auc[c1]=0.606  auc[c2]=0.583 | macroAUC=0.618 | macroSens=0.329 macroSpec=0.669 | sens[c0]=0.003  sens[c1]=0.974  sens[c2]=0.011 | spec[c0]=1.000  spec[c1]=0.119  spec[c2]=0.888
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01      14    4431     593
   ISUP23       0     337       9
   ISUP45       0      90       1
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3293)
[005] train: loss 0.9249 acc 0.2337 f1 0.1670 | val: loss 1.7676 acc 0.0690 f1 0.0505 | acc[c0]=0.008  acc[c1]=0.971  acc[c2]=0.011 | auc[c0]=0.693  auc[c1]=0.632  auc[c2]=0.587 | macroAUC=0.637 | macroSens=0.330 macroSpec=0.671 | sens[c0]=0.008  sens[c1]=0.971  sens[c2]=0.011 | spec[c0]=1.000  spec[c1]=0.146  spec[c2]=0.867
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01      41    4290     707
   ISUP23       0     336      10
   ISUP45       0      90       1
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3301)
[006] train: loss 0.9102 acc 0.2433 f1 0.1816 | val: loss 1.7919 acc 0.0789 f1 0.0624 | acc[c0]=0.021  acc[c1]=0.936  acc[c2]=0.044 | auc[c0]=0.713  auc[c1]=0.654  auc[c2]=0.587 | macroAUC=0.651 | macroSens=0.334 macroSpec=0.676 | sens[c0]=0.021  sens[c1]=0.936  sens[c2]=0.044 | spec[c0]=1.000  spec[c1]=0.227  spec[c2]=0.800
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     104    3879    1055
   ISUP23       0     324      22
   ISUP45       0      87       4
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3337)
[007] train: loss 0.9052 acc 0.2576 f1 0.2001 | val: loss 1.7944 acc 0.0946 f1 0.0757 | acc[c0]=0.038  acc[c1]=0.934  acc[c2]=0.066 | auc[c0]=0.728  auc[c1]=0.673  auc[c2]=0.588 | macroAUC=0.663 | macroSens=0.346 macroSpec=0.681 | sens[c0]=0.038  sens[c1]=0.934  sens[c2]=0.066 | spec[c0]=1.000  spec[c1]=0.264  spec[c2]=0.780
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     189    3690    1159
   ISUP23       0     323      23
   ISUP45       0      85       6
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3457)
[008] train: loss 0.9006 acc 0.2594 f1 0.2119 | val: loss 1.7663 acc 0.1089 f1 0.0903 | acc[c0]=0.054  acc[c1]=0.905  acc[c2]=0.110 | auc[c0]=0.742  auc[c1]=0.692  auc[c2]=0.599 | macroAUC=0.678 | macroSens=0.356 macroSpec=0.688 | sens[c0]=0.054  sens[c1]=0.905  sens[c2]=0.110 | spec[c0]=1.000  spec[c1]=0.345  spec[c2]=0.718
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     273    3279    1486
   ISUP23       0     313      33
   ISUP45       0      81      10
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3562)
[009] train: loss 0.8941 acc 0.2774 f1 0.2395 | val: loss 1.7340 acc 0.1226 f1 0.1039 | acc[c0]=0.070  acc[c1]=0.870  acc[c2]=0.165 | auc[c0]=0.753  auc[c1]=0.710  auc[c2]=0.600 | macroAUC=0.688 | macroSens=0.368 macroSpec=0.692 | sens[c0]=0.070  sens[c1]=0.870  sens[c2]=0.165 | spec[c0]=0.995  spec[c1]=0.412  spec[c2]=0.668
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     355    2940    1743
   ISUP23       2     301      43
   ISUP45       0      76      15
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3684)
[010] train: loss 0.8779 acc 0.2954 f1 0.2604 | val: loss 1.6934 acc 0.1386 f1 0.1168 | acc[c0]=0.089  acc[c1]=0.847  acc[c2]=0.198 | auc[c0]=0.761  auc[c1]=0.724  auc[c2]=0.599 | macroAUC=0.695 | macroSens=0.378 macroSpec=0.698 | sens[c0]=0.089  sens[c1]=0.847  sens[c2]=0.198 | spec[c0]=0.995  spec[c1]=0.449  spec[c2]=0.649
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     448    2751    1839
   ISUP23       2     293      51
   ISUP45       0      73      18
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3778)
[011] train: loss 0.8676 acc 0.3113 f1 0.2769 | val: loss 1.6573 acc 0.1580 f1 0.1301 | acc[c0]=0.111  acc[c1]=0.824  acc[c2]=0.209 | auc[c0]=0.766  auc[c1]=0.735  auc[c2]=0.594 | macroAUC=0.698 | macroSens=0.381 macroSpec=0.705 | sens[c0]=0.111  sens[c1]=0.824  sens[c2]=0.209 | spec[c0]=0.995  spec[c1]=0.474  spec[c2]=0.646
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     561    2628    1849
   ISUP23       2     285      59
   ISUP45       0      72      19
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3813)
[012] train: loss 0.8490 acc 0.3352 f1 0.2979 | val: loss 1.6182 acc 0.1817 f1 0.1453 | acc[c0]=0.139  acc[c1]=0.801  acc[c2]=0.220 | auc[c0]=0.770  auc[c1]=0.739  auc[c2]=0.595 | macroAUC=0.701 | macroSens=0.386 macroSpec=0.713 | sens[c0]=0.139  sens[c1]=0.801  sens[c2]=0.220 | spec[c0]=0.995  spec[c1]=0.496  spec[c2]=0.648
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     698    2512    1828
   ISUP23       2     277      67
   ISUP45       0      71      20
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.3863)
[013] train: loss 0.8309 acc 0.3611 f1 0.3297 | val: loss 1.5902 acc 0.2053 f1 0.1615 | acc[c0]=0.165  acc[c1]=0.769  acc[c2]=0.275 | auc[c0]=0.774  auc[c1]=0.741  auc[c2]=0.599 | macroAUC=0.705 | macroSens=0.403 macroSpec=0.722 | sens[c0]=0.165  sens[c1]=0.769  sens[c2]=0.275 | spec[c0]=0.995  spec[c1]=0.532  spec[c2]=0.638
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     833    2332    1873
   ISUP23       2     266      78
   ISUP45       0      66      25
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4030)
[014] train: loss 0.8126 acc 0.3786 f1 0.3471 | val: loss 1.5513 acc 0.2331 f1 0.1781 | acc[c0]=0.195  acc[c1]=0.777  acc[c2]=0.297 | auc[c0]=0.776  auc[c1]=0.744  auc[c2]=0.588 | macroAUC=0.703 | macroSens=0.423 macroSpec=0.731 | sens[c0]=0.195  sens[c1]=0.777  sens[c2]=0.297 | spec[c0]=0.993  spec[c1]=0.541  spec[c2]=0.658
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     980    2291    1767
   ISUP23       3     269      74
   ISUP45       0      64      27
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4229)
[015] train: loss 0.7844 acc 0.4049 f1 0.3785 | val: loss 1.5150 acc 0.2495 f1 0.1887 | acc[c0]=0.215  acc[c1]=0.737  acc[c2]=0.330 | auc[c0]=0.778  auc[c1]=0.743  auc[c2]=0.588 | macroAUC=0.703 | macroSens=0.427 macroSpec=0.735 | sens[c0]=0.215  sens[c1]=0.737  sens[c2]=0.330 | spec[c0]=0.986  spec[c1]=0.577  spec[c2]=0.641
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1081    2109    1848
   ISUP23       6     255      85
   ISUP45       0      61      30
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4271)
[016] train: loss 0.7621 acc 0.4220 f1 0.3998 | val: loss 1.4953 acc 0.2616 f1 0.1951 | acc[c0]=0.228  acc[c1]=0.725  acc[c2]=0.330 | auc[c0]=0.781  auc[c1]=0.744  auc[c2]=0.584 | macroAUC=0.703 | macroSens=0.428 macroSpec=0.738 | sens[c0]=0.228  sens[c1]=0.725  sens[c2]=0.330 | spec[c0]=0.984  spec[c1]=0.585  spec[c2]=0.645
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1151    2066    1821
   ISUP23       7     251      88
   ISUP45       0      61      30
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4279)
[017] train: loss 0.7278 acc 0.4400 f1 0.4170 | val: loss 1.4728 acc 0.2800 f1 0.2056 | acc[c0]=0.248  acc[c1]=0.723  acc[c2]=0.352 | auc[c0]=0.784  auc[c1]=0.745  auc[c2]=0.575 | macroAUC=0.701 | macroSens=0.441 macroSpec=0.743 | sens[c0]=0.248  sens[c1]=0.723  sens[c2]=0.352 | spec[c0]=0.979  spec[c1]=0.596  spec[c2]=0.655
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1251    2016    1771
   ISUP23       8     250      88
   ISUP45       1      58      32
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4408)
[018] train: loss 0.7008 acc 0.4570 f1 0.4348 | val: loss 1.4474 acc 0.3056 f1 0.2186 | acc[c0]=0.276  acc[c1]=0.725  acc[c2]=0.352 | auc[c0]=0.789  auc[c1]=0.746  auc[c2]=0.566 | macroAUC=0.700 | macroSens=0.451 macroSpec=0.751 | sens[c0]=0.276  sens[c1]=0.725  sens[c2]=0.352 | spec[c0]=0.975  spec[c1]=0.601  spec[c2]=0.676
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1390    1991    1657
   ISUP23      10     251      85
   ISUP45       1      58      32
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4510)
[019] train: loss 0.6662 acc 0.4711 f1 0.4507 | val: loss 1.4185 acc 0.3269 f1 0.2293 | acc[c0]=0.299  acc[c1]=0.720  acc[c2]=0.363 | auc[c0]=0.791  auc[c1]=0.747  auc[c2]=0.555 | macroAUC=0.698 | macroSens=0.461 macroSpec=0.757 | sens[c0]=0.299  sens[c1]=0.720  sens[c2]=0.363 | spec[c0]=0.970  spec[c1]=0.608  spec[c2]=0.692
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1508    1955    1575
   ISUP23      12     249      85
   ISUP45       1      57      33
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4605)
[020] train: loss 0.6326 acc 0.4939 f1 0.4716 | val: loss 1.3780 acc 0.3520 f1 0.2409 | acc[c0]=0.328  acc[c1]=0.705  acc[c2]=0.363 | auc[c0]=0.794  auc[c1]=0.746  auc[c2]=0.552 | macroAUC=0.697 | macroSens=0.465 macroSpec=0.762 | sens[c0]=0.328  sens[c1]=0.705  sens[c2]=0.363 | spec[c0]=0.961  spec[c1]=0.619  spec[c2]=0.707
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1650    1898    1490
   ISUP23      15     244      87
   ISUP45       2      56      33
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4651)
[021] train: loss 0.5885 acc 0.5091 f1 0.4880 | val: loss 1.3576 acc 0.3699 f1 0.2491 | acc[c0]=0.348  acc[c1]=0.697  acc[c2]=0.363 | auc[c0]=0.797  auc[c1]=0.747  auc[c2]=0.549 | macroAUC=0.698 | macroSens=0.469 macroSpec=0.767 | sens[c0]=0.348  sens[c1]=0.697  sens[c2]=0.363 | spec[c0]=0.957  spec[c1]=0.626  spec[c2]=0.719
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1751    1861    1426
   ISUP23      16     241      89
   ISUP45       3      55      33
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4689)
[022] train: loss 0.5513 acc 0.5314 f1 0.5125 | val: loss 1.3367 acc 0.3920 f1 0.2583 | acc[c0]=0.371  acc[c1]=0.705  acc[c2]=0.341 | auc[c0]=0.801  auc[c1]=0.748  auc[c2]=0.539 | macroAUC=0.696 | macroSens=0.472 macroSpec=0.774 | sens[c0]=0.371  sens[c1]=0.705  sens[c2]=0.341 | spec[c0]=0.954  spec[c1]=0.624  spec[c2]=0.744
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1871    1874    1293
   ISUP23      17     244      85
   ISUP45       3      57      31
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4724)
[023] train: loss 0.5180 acc 0.5586 f1 0.5383 | val: loss 1.3046 acc 0.4137 f1 0.2699 | acc[c0]=0.395  acc[c1]=0.697  acc[c2]=0.374 | auc[c0]=0.802  auc[c1]=0.745  auc[c2]=0.550 | macroAUC=0.699 | macroSens=0.488 macroSpec=0.780 | sens[c0]=0.395  sens[c1]=0.697  sens[c2]=0.374 | spec[c0]=0.947  spec[c1]=0.643  spec[c2]=0.749
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1990    1780    1268
   ISUP23      19     241      86
   ISUP45       4      53      34
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.4884)
[024] train: loss 0.4724 acc 0.5770 f1 0.5583 | val: loss 1.2849 acc 0.4300 f1 0.2754 | acc[c0]=0.413  acc[c1]=0.691  acc[c2]=0.352 | auc[c0]=0.804  auc[c1]=0.744  auc[c2]=0.547 | macroAUC=0.698 | macroSens=0.485 macroSpec=0.782 | sens[c0]=0.413  sens[c1]=0.691  sens[c2]=0.352 | spec[c0]=0.938  spec[c1]=0.640  spec[c2]=0.768
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2083    1791    1164
   ISUP23      22     239      85
   ISUP45       5      54      32
  ↳ no improvement (1/10)
[025] train: loss 0.4368 acc 0.5900 f1 0.5726 | val: loss 1.2691 acc 0.4499 f1 0.2827 | acc[c0]=0.435  acc[c1]=0.705  acc[c2]=0.319 | auc[c0]=0.808  auc[c1]=0.747  auc[c2]=0.540 | macroAUC=0.698 | macroSens=0.486 macroSpec=0.788 | sens[c0]=0.435  sens[c1]=0.705  sens[c2]=0.319 | spec[c0]=0.936  spec[c1]=0.631  spec[c2]=0.798
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2190    1838    1010
   ISUP23      23     244      79
   ISUP45       5      57      29
  ↳ no improvement (2/10)
[026] train: loss 0.3876 acc 0.6126 f1 0.5991 | val: loss 1.2487 acc 0.4679 f1 0.2921 | acc[c0]=0.455  acc[c1]=0.682  acc[c2]=0.363 | auc[c0]=0.811  auc[c1]=0.746  auc[c2]=0.549 | macroAUC=0.702 | macroSens=0.500 macroSpec=0.792 | sens[c0]=0.455  sens[c1]=0.682  sens[c2]=0.363 | spec[c0]=0.929  spec[c1]=0.651  spec[c2]=0.797
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2293    1739    1006
   ISUP23      25     236      85
   ISUP45       6      52      33
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5000)
[027] train: loss 0.3547 acc 0.6301 f1 0.6172 | val: loss 1.2132 acc 0.4981 f1 0.3042 | acc[c0]=0.489  acc[c1]=0.671  acc[c2]=0.341 | auc[c0]=0.815  auc[c1]=0.748  auc[c2]=0.555 | macroAUC=0.706 | macroSens=0.500 macroSpec=0.799 | sens[c0]=0.489  sens[c1]=0.671  sens[c2]=0.341 | spec[c0]=0.918  spec[c1]=0.671  spec[c2]=0.809
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2464    1633     941
   ISUP23      29     232      85
   ISUP45       7      53      31
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5001)
[028] train: loss 0.3230 acc 0.6611 f1 0.6432 | val: loss 1.1630 acc 0.5322 f1 0.3155 | acc[c0]=0.528  acc[c1]=0.659  acc[c2]=0.297 | auc[c0]=0.817  auc[c1]=0.753  auc[c2]=0.546 | macroAUC=0.705 | macroSens=0.494 macroSpec=0.804 | sens[c0]=0.528  sens[c1]=0.659  sens[c2]=0.297 | spec[c0]=0.895  spec[c1]=0.676  spec[c2]=0.841
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2659    1604     775
   ISUP23      38     228      80
   ISUP45       8      56      27
  ↳ no improvement (1/10)
[029] train: loss 0.2897 acc 0.6840 f1 0.6701 | val: loss 1.1272 acc 0.5602 f1 0.3282 | acc[c0]=0.559  acc[c1]=0.650  acc[c2]=0.308 | auc[c0]=0.820  auc[c1]=0.755  auc[c2]=0.558 | macroAUC=0.711 | macroSens=0.506 macroSpec=0.810 | sens[c0]=0.559  sens[c1]=0.650  sens[c2]=0.308 | spec[c0]=0.883  spec[c1]=0.696  spec[c2]=0.852
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2814    1504     720
   ISUP23      43     225      78
   ISUP45       8      55      28
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5055)
[030] train: loss 0.2564 acc 0.7145 f1 0.6970 | val: loss 1.1195 acc 0.5779 f1 0.3358 | acc[c0]=0.577  acc[c1]=0.668  acc[c2]=0.286 | auc[c0]=0.825  auc[c1]=0.760  auc[c2]=0.553 | macroAUC=0.713 | macroSens=0.510 macroSpec=0.816 | sens[c0]=0.577  sens[c1]=0.668  sens[c2]=0.286 | spec[c0]=0.883  spec[c1]=0.700  spec[c2]=0.866
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2907    1483     648
   ISUP23      43     231      72
   ISUP45       8      57      26
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5101)
[031] train: loss 0.2323 acc 0.7272 f1 0.7135 | val: loss 1.0704 acc 0.6102 f1 0.3494 | acc[c0]=0.613  acc[c1]=0.650  acc[c2]=0.286 | auc[c0]=0.828  auc[c1]=0.763  auc[c2]=0.562 | macroAUC=0.717 | macroSens=0.516 macroSpec=0.821 | sens[c0]=0.613  sens[c1]=0.650  sens[c2]=0.286 | spec[c0]=0.860  spec[c1]=0.722  spec[c2]=0.880
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3090    1369     579
   ISUP23      53     225      68
   ISUP45       8      57      26
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5164)
[032] train: loss 0.2069 acc 0.7513 f1 0.7374 | val: loss 1.0245 acc 0.6458 f1 0.3659 | acc[c0]=0.653  acc[c1]=0.636  acc[c2]=0.297 | auc[c0]=0.831  auc[c1]=0.766  auc[c2]=0.569 | macroAUC=0.722 | macroSens=0.528 macroSpec=0.830 | sens[c0]=0.653  sens[c1]=0.636  sens[c2]=0.297 | spec[c0]=0.851  spec[c1]=0.745  spec[c2]=0.895
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3289    1252     497
   ISUP23      56     220      70
   ISUP45       9      55      27
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5285)
[033] train: loss 0.1759 acc 0.7736 f1 0.7613 | val: loss 1.0071 acc 0.6606 f1 0.3731 | acc[c0]=0.669  acc[c1]=0.636  acc[c2]=0.297 | auc[c0]=0.836  auc[c1]=0.774  auc[c2]=0.568 | macroAUC=0.726 | macroSens=0.534 macroSpec=0.834 | sens[c0]=0.669  sens[c1]=0.636  sens[c2]=0.297 | spec[c0]=0.847  spec[c1]=0.753  spec[c2]=0.903
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3370    1213     455
   ISUP23      58     220      68
   ISUP45       9      55      27
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5338)
[034] train: loss 0.1609 acc 0.7907 f1 0.7820 | val: loss 0.9869 acc 0.6774 f1 0.3790 | acc[c0]=0.689  acc[c1]=0.618  acc[c2]=0.286 | auc[c0]=0.838  auc[c1]=0.777  auc[c2]=0.578 | macroAUC=0.731 | macroSens=0.531 macroSpec=0.836 | sens[c0]=0.689  sens[c1]=0.618  sens[c2]=0.286 | spec[c0]=0.833  spec[c1]=0.764  spec[c2]=0.910
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3469    1155     414
   ISUP23      61     214      71
   ISUP45      12      53      26
  ↳ no improvement (1/10)
[035] train: loss 0.1429 acc 0.8118 f1 0.8003 | val: loss 0.9433 acc 0.7118 f1 0.3952 | acc[c0]=0.728  acc[c1]=0.590  acc[c2]=0.297 | auc[c0]=0.840  auc[c1]=0.780  auc[c2]=0.594 | macroAUC=0.738 | macroSens=0.538 macroSpec=0.839 | sens[c0]=0.728  sens[c1]=0.590  sens[c2]=0.297 | spec[c0]=0.803  spec[c1]=0.796  spec[c2]=0.917
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3666     996     376
   ISUP23      71     204      71
   ISUP45      15      49      27
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5380)
[036] train: loss 0.1283 acc 0.8276 f1 0.8171 | val: loss 0.9441 acc 0.7200 f1 0.3992 | acc[c0]=0.736  acc[c1]=0.604  acc[c2]=0.275 | auc[c0]=0.843  auc[c1]=0.785  auc[c2]=0.590 | macroAUC=0.739 | macroSens=0.538 macroSpec=0.841 | sens[c0]=0.736  sens[c1]=0.604  sens[c2]=0.275 | spec[c0]=0.801  spec[c1]=0.796  spec[c2]=0.926
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3708     996     334
   ISUP23      72     209      65
   ISUP45      15      51      25
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5383)
[037] train: loss 0.1202 acc 0.8408 f1 0.8282 | val: loss 0.8981 acc 0.7554 f1 0.4155 | acc[c0]=0.776  acc[c1]=0.578  acc[c2]=0.264 | auc[c0]=0.842  auc[c1]=0.788  auc[c2]=0.607 | macroAUC=0.746 | macroSens=0.539 macroSpec=0.844 | sens[c0]=0.776  sens[c1]=0.578  sens[c2]=0.264 | spec[c0]=0.769  spec[c1]=0.827  spec[c2]=0.934
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3912     837     289
   ISUP23      82     200      64
   ISUP45      19      48      24
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5394)
[038] train: loss 0.1027 acc 0.8615 f1 0.8498 | val: loss 0.8873 acc 0.7700 f1 0.4238 | acc[c0]=0.794  acc[c1]=0.558  acc[c2]=0.275 | auc[c0]=0.842  auc[c1]=0.788  auc[c2]=0.620 | macroAUC=0.750 | macroSens=0.542 macroSpec=0.842 | sens[c0]=0.794  sens[c1]=0.558  sens[c2]=0.275 | spec[c0]=0.746  spec[c1]=0.838  spec[c2]=0.941
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3998     786     254
   ISUP23      91     193      62
   ISUP45      20      46      25
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_lr_1e6_7/results128/baseline/ckpt_best.pt (BAL-acc=0.5420)
[039] train: loss 0.0905 acc 0.8723 f1 0.8641 | val: loss 0.8966 acc 0.7781 f1 0.4259 | acc[c0]=0.802  acc[c1]=0.566  acc[c2]=0.242 | auc[c0]=0.845  auc[c1]=0.794  auc[c2]=0.623 | macroAUC=0.754 | macroSens=0.537 macroSpec=0.844 | sens[c0]=0.802  sens[c1]=0.566  sens[c2]=0.242 | spec[c0]=0.746  spec[c1]=0.842  spec[c2]=0.945
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4042     763     233
   ISUP23      89     196      61
   ISUP45      22      47      22
  ↳ no improvement (1/10)
[040] train: loss 0.0834 acc 0.8875 f1 0.8772 | val: loss 0.8944 acc 0.7874 f1 0.4295 | acc[c0]=0.814  acc[c1]=0.546  acc[c2]=0.242 | auc[c0]=0.847  auc[c1]=0.796  auc[c2]=0.634 | macroAUC=0.759 | macroSens=0.534 macroSpec=0.842 | sens[c0]=0.814  sens[c1]=0.546  sens[c2]=0.242 | spec[c0]=0.728  spec[c1]=0.851  spec[c2]=0.948
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4100     718     220
   ISUP23      96     189      61
   ISUP45      23      46      22
  ↳ no improvement (2/10)
[041] train: loss 0.0741 acc 0.8967 f1 0.8886 | val: loss 0.8818 acc 0.8057 f1 0.4412 | acc[c0]=0.835  acc[c1]=0.523  acc[c2]=0.253 | auc[c0]=0.846  auc[c1]=0.798  auc[c2]=0.647 | macroAUC=0.764 | macroSens=0.537 macroSpec=0.839 | sens[c0]=0.835  sens[c1]=0.523  sens[c2]=0.253 | spec[c0]=0.696  spec[c1]=0.867  spec[c2]=0.954
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4207     639     192
   ISUP23     109     181      56
   ISUP45      24      44      23
  ↳ no improvement (3/10)
[042] train: loss 0.0673 acc 0.9065 f1 0.8962 | val: loss 0.8899 acc 0.8122 f1 0.4436 | acc[c0]=0.843  acc[c1]=0.506  acc[c2]=0.253 | auc[c0]=0.847  auc[c1]=0.801  auc[c2]=0.653 | macroAUC=0.767 | macroSens=0.534 macroSpec=0.836 | sens[c0]=0.843  sens[c1]=0.506  sens[c2]=0.253 | spec[c0]=0.680  spec[c1]=0.873  spec[c2]=0.956
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4249     605     184
   ISUP23     116     175      55
   ISUP45      24      44      23
  ↳ no improvement (4/10)
[043] train: loss 0.0621 acc 0.9141 f1 0.9048 | val: loss 0.8888 acc 0.8294 f1 0.4456 | acc[c0]=0.864  acc[c1]=0.486  acc[c2]=0.198 | auc[c0]=0.847  auc[c1]=0.804  auc[c2]=0.660 | macroAUC=0.770 | macroSens=0.516 macroSpec=0.830 | sens[c0]=0.864  sens[c1]=0.486  sens[c2]=0.198 | spec[c0]=0.641  spec[c1]=0.887  spec[c2]=0.963
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4355     536     147
   ISUP23     127     168      51
   ISUP45      30      43      18
  ↳ no improvement (5/10)
[044] train: loss 0.0544 acc 0.9226 f1 0.9144 | val: loss 0.9023 acc 0.8340 f1 0.4490 | acc[c0]=0.870  acc[c1]=0.483  acc[c2]=0.198 | auc[c0]=0.846  auc[c1]=0.804  auc[c2]=0.670 | macroAUC=0.774 | macroSens=0.517 macroSpec=0.828 | sens[c0]=0.870  sens[c1]=0.483  sens[c2]=0.198 | spec[c0]=0.629  spec[c1]=0.892  spec[c2]=0.964
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4381     514     143
   ISUP23     130     167      49
   ISUP45      32      41      18
  ↳ no improvement (6/10)
[045] train: loss 0.0486 acc 0.9284 f1 0.9205 | val: loss 0.9180 acc 0.8393 f1 0.4528 | acc[c0]=0.876  acc[c1]=0.477  acc[c2]=0.198 | auc[c0]=0.848  auc[c1]=0.807  auc[c2]=0.678 | macroAUC=0.778 | macroSens=0.517 macroSpec=0.826 | sens[c0]=0.876  sens[c1]=0.477  sens[c2]=0.198 | spec[c0]=0.616  spec[c1]=0.896  spec[c2]=0.966
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4412     492     134
   ISUP23     134     165      47
   ISUP45      34      39      18
  ↳ no improvement (7/10)
[046] train: loss 0.0454 acc 0.9352 f1 0.9286 | val: loss 0.9338 acc 0.8458 f1 0.4585 | acc[c0]=0.883  acc[c1]=0.477  acc[c2]=0.198 | auc[c0]=0.849  auc[c1]=0.810  auc[c2]=0.688 | macroAUC=0.782 | macroSens=0.519 macroSpec=0.828 | sens[c0]=0.883  sens[c1]=0.477  sens[c2]=0.198 | spec[c0]=0.616  spec[c1]=0.901  spec[c2]=0.969
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4448     471     119
   ISUP23     134     165      47
   ISUP45      34      39      18
  ↳ no improvement (8/10)
[047] train: loss 0.0373 acc 0.9430 f1 0.9363 | val: loss 0.9552 acc 0.8511 f1 0.4588 | acc[c0]=0.890  acc[c1]=0.462  acc[c2]=0.187 | auc[c0]=0.849  auc[c1]=0.813  auc[c2]=0.693 | macroAUC=0.785 | macroSens=0.513 macroSpec=0.826 | sens[c0]=0.890  sens[c1]=0.462  sens[c2]=0.187 | spec[c0]=0.602  spec[c1]=0.906  spec[c2]=0.971
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4483     444     111
   ISUP23     140     160      46
   ISUP45      34      40      17
  ↳ no improvement (9/10)
[048] train: loss 0.0344 acc 0.9484 f1 0.9417 | val: loss 0.9777 acc 0.8581 f1 0.4605 | acc[c0]=0.899  acc[c1]=0.436  acc[c2]=0.187 | auc[c0]=0.848  auc[c1]=0.813  auc[c2]=0.700 | macroAUC=0.787 | macroSens=0.507 macroSpec=0.822 | sens[c0]=0.899  sens[c1]=0.436  sens[c2]=0.187 | spec[c0]=0.579  spec[c1]=0.914  spec[c2]=0.971
Confusion matrix (val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4530     401     107
   ISUP23     148     151      47
   ISUP45      36      38      17
  ↳ no improvement (10/10)
Early stopping triggered at epoch 48: no BAL-acc improvement for 10 epochs.

=== Final model: Sensitivity at fixed specificity (validation) ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.842 |        0.741 |        0.574 |        0.386 |        0.268 |        0.134
          c1 |        0.788 |        0.607 |        0.425 |        0.257 |        0.171 |        0.069
          c2 |        0.620 |        0.484 |        0.341 |        0.231 |        0.165 |        0.099
       macro |        0.750 |        0.611 |        0.446 |        0.291 |        0.201 |        0.101
