Host: kn048
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Wed Oct 15 16:25:21 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:CA:00.0 Off |                    0 |
| N/A   28C    P8             34W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[PicaiSliceDataset] binary_low_high: dropped 922 rows with label3==1; kept 16136
[PicaiSliceDataset] binary_low_high: dropped 346 rows with label3==1; kept 5129
[001] train: loss 0.1841 acc 0.4015 f1 0.3573 | val: loss 2.1559 acc 0.2500 f1 0.2130 | acc[c0]=0.238  acc[c1]=0.934 | auc[c0]=0.759  auc[c1]=0.759 | macroAUC=0.759 | macroSens=0.586 macroSpec=0.586 | sens[c0]=0.238  sens[c1]=0.934 | spec[c0]=0.934  spec[c1]=0.238
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    1197    3841
HIGH(ISUP45)       6      85
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_low_high/results128/baseline/ckpt_best.pt (BAL-acc=0.5858)
[002] train: loss 0.1818 acc 0.4852 f1 0.4703 | val: loss 2.3344 acc 0.2078 f1 0.1831 | acc[c0]=0.194  acc[c1]=0.956 | auc[c0]=0.745  auc[c1]=0.745 | macroAUC=0.745 | macroSens=0.575 macroSpec=0.575 | sens[c0]=0.194  sens[c1]=0.956 | spec[c0]=0.956  spec[c1]=0.194
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)     979    4059
HIGH(ISUP45)       4      87
  ↳ no improvement (1/10)
→ Unfroze encoder at epoch 3; added to optimizer with lr=3e-05
[003] train: loss 0.0487 acc 0.9497 f1 0.9451 | val: loss 0.3755 acc 0.9811 f1 0.6305 | acc[c0]=0.995  acc[c1]=0.198 | auc[c0]=0.863  auc[c1]=0.863 | macroAUC=0.863 | macroSens=0.597 macroSpec=0.597 | sens[c0]=0.995  sens[c1]=0.198 | spec[c0]=0.198  spec[c1]=0.995
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5014      24
HIGH(ISUP45)      73      18
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_low_high/results128/baseline/ckpt_best.pt (BAL-acc=0.5965)
[004] train: loss 0.0015 acc 0.9980 f1 0.9977 | val: loss 0.5240 acc 0.9786 f1 0.6072 | acc[c0]=0.993  acc[c1]=0.176 | auc[c0]=0.812  auc[c1]=0.812 | macroAUC=0.812 | macroSens=0.584 macroSpec=0.584 | sens[c0]=0.993  sens[c1]=0.176 | spec[c0]=0.176  spec[c1]=0.993
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5003      35
HIGH(ISUP45)      75      16
  ↳ no improvement (1/10)
[005] train: loss 0.0020 acc 0.9986 f1 0.9985 | val: loss 0.5572 acc 0.9795 f1 0.6471 | acc[c0]=0.993  acc[c1]=0.253 | auc[c0]=0.851  auc[c1]=0.848 | macroAUC=0.849 | macroSens=0.623 macroSpec=0.623 | sens[c0]=0.993  sens[c1]=0.253 | spec[c0]=0.253  spec[c1]=0.993
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5001      37
HIGH(ISUP45)      68      23
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_low_high/results128/baseline/ckpt_best.pt (BAL-acc=0.6227)
[006] train: loss 0.0045 acc 0.9977 f1 0.9974 | val: loss 0.7852 acc 0.9821 f1 0.5163 | acc[c0]=0.999  acc[c1]=0.022 | auc[c0]=0.729  auc[c1]=0.731 | macroAUC=0.730 | macroSens=0.511 macroSpec=0.511 | sens[c0]=0.999  sens[c1]=0.022 | spec[c0]=0.022  spec[c1]=0.999
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5035       3
HIGH(ISUP45)      89       2
  ↳ no improvement (1/10)
[007] train: loss 0.0001 acc 0.9999 f1 0.9999 | val: loss 0.7402 acc 0.9811 f1 0.5735 | acc[c0]=0.997  acc[c1]=0.099 | auc[c0]=0.796  auc[c1]=0.801 | macroAUC=0.798 | macroSens=0.548 macroSpec=0.548 | sens[c0]=0.997  sens[c1]=0.099 | spec[c0]=0.099  spec[c1]=0.997
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5023      15
HIGH(ISUP45)      82       9
  ↳ no improvement (2/10)
[008] train: loss 0.0149 acc 0.9949 f1 0.9942 | val: loss 0.7570 acc 0.9821 f1 0.5261 | acc[c0]=0.999  acc[c1]=0.033 | auc[c0]=0.760  auc[c1]=0.766 | macroAUC=0.763 | macroSens=0.516 macroSpec=0.516 | sens[c0]=0.999  sens[c1]=0.033 | spec[c0]=0.033  spec[c1]=0.999
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5034       4
HIGH(ISUP45)      88       3
  ↳ no improvement (3/10)
[009] train: loss 0.0004 acc 0.9997 f1 0.9996 | val: loss 0.8002 acc 0.9821 f1 0.5773 | acc[c0]=0.998  acc[c1]=0.099 | auc[c0]=0.767  auc[c1]=0.781 | macroAUC=0.774 | macroSens=0.548 macroSpec=0.548 | sens[c0]=0.998  sens[c1]=0.099 | spec[c0]=0.099  spec[c1]=0.998
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5028      10
HIGH(ISUP45)      82       9
  ↳ no improvement (4/10)
[010] train: loss 0.0053 acc 0.9976 f1 0.9973 | val: loss 0.7917 acc 0.9809 f1 0.5728 | acc[c0]=0.997  acc[c1]=0.099 | auc[c0]=0.778  auc[c1]=0.769 | macroAUC=0.773 | macroSens=0.548 macroSpec=0.548 | sens[c0]=0.997  sens[c1]=0.099 | spec[c0]=0.099  spec[c1]=0.997
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5022      16
HIGH(ISUP45)      82       9
  ↳ no improvement (5/10)
[011] train: loss 0.0000 acc 1.0000 f1 1.0000 | val: loss 0.7911 acc 0.9809 f1 0.6000 | acc[c0]=0.996  acc[c1]=0.143 | auc[c0]=0.773  auc[c1]=0.787 | macroAUC=0.780 | macroSens=0.569 macroSpec=0.569 | sens[c0]=0.996  sens[c1]=0.143 | spec[c0]=0.143  spec[c1]=0.996
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5018      20
HIGH(ISUP45)      78      13
  ↳ no improvement (6/10)
[012] train: loss 0.0000 acc 1.0000 f1 1.0000 | val: loss 0.8002 acc 0.9801 f1 0.6086 | acc[c0]=0.995  acc[c1]=0.165 | auc[c0]=0.763  auc[c1]=0.777 | macroAUC=0.770 | macroSens=0.580 macroSpec=0.580 | sens[c0]=0.995  sens[c1]=0.165 | spec[c0]=0.165  spec[c1]=0.995
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5012      26
HIGH(ISUP45)      76      15
  ↳ no improvement (7/10)
[013] train: loss 0.0000 acc 1.0000 f1 1.0000 | val: loss 0.8437 acc 0.9805 f1 0.5784 | acc[c0]=0.996  acc[c1]=0.110 | auc[c0]=0.739  auc[c1]=0.754 | macroAUC=0.746 | macroSens=0.553 macroSpec=0.553 | sens[c0]=0.996  sens[c1]=0.110 | spec[c0]=0.110  spec[c1]=0.996
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5019      19
HIGH(ISUP45)      81      10
  ↳ no improvement (8/10)
[014] train: loss 0.0000 acc 1.0000 f1 1.0000 | val: loss 0.8417 acc 0.9805 f1 0.5852 | acc[c0]=0.996  acc[c1]=0.121 | auc[c0]=0.740  auc[c1]=0.759 | macroAUC=0.750 | macroSens=0.558 macroSpec=0.558 | sens[c0]=0.996  sens[c1]=0.121 | spec[c0]=0.121  spec[c1]=0.996
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5018      20
HIGH(ISUP45)      80      11
  ↳ no improvement (9/10)
[015] train: loss 0.0000 acc 1.0000 f1 1.0000 | val: loss 0.8423 acc 0.9805 f1 0.5982 | acc[c0]=0.996  acc[c1]=0.143 | auc[c0]=0.733  auc[c1]=0.762 | macroAUC=0.747 | macroSens=0.569 macroSpec=0.569 | sens[c0]=0.996  sens[c1]=0.143 | spec[c0]=0.143  spec[c1]=0.996
Confusion matrix (val): rows=true, cols=pred
true\pred LOW(ISUP01) HIGH(ISUP45)
LOW(ISUP01)    5016      22
HIGH(ISUP45)      78      13
  ↳ no improvement (10/10)
Early stopping triggered at epoch 15: no BAL-acc improvement for 10 epochs.

=== Final model: Sensitivity at fixed specificity (validation) ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.851 |        0.693 |        0.423 |        0.151 |        0.151 |        0.000
          c1 |        0.848 |        0.780 |        0.714 |        0.582 |        0.440 |        0.308
       macro |        0.849 |        0.736 |        0.569 |        0.367 |        0.295 |        0.154
