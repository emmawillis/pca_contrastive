Host: kn143
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Wed Oct 15 15:53:56 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:E3:00.0 Off |                    0 |
| N/A   30C    P8             35W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[load_encoder_only] Loaded encoder weights from /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/run_2_full/results128/triplet_logreg/ckpt_best.pt
Traceback (most recent call last):
  File "/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/train_head_from_encoder.py", line 455, in <module>
    main()
  File "/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/train_head_from_encoder.py", line 359, in main
    tr_loss = run_epoch_ce(train_loader, model, w_ce=w_ce, optimizer=optimizer, device=device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/train_head_from_encoder.py", line 214, in run_epoch_ce
    ce = nn.CrossEntropyLoss(weights=w_ce)  # (keep as-is)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CrossEntropyLoss.__init__() got an unexpected keyword argument 'weights'
srun: error: kn143: task 0: Exited with exit code 1
