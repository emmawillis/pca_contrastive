Host: kn062
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Wed Oct 22 16:01:15 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:65:00.0 Off |                    0 |
| N/A   46C    P8             37W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
ARGS:  Namespace(manifest='/project/aip-medilab/shared/picai/manifests/slices_manifest.csv', sam_checkpoint='/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth', outdir='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline', target='binary_all', folds_train='1,2,3', folds_val='0', batch_size=16, epochs=100, lr=1e-05, wd=0.0, pos_ratio=0.5, proj_dim=512, use_skip=False, freeze_epochs=2)
[probe][epoch1 batch 00] has_lesion: 7/16 (44%) || labels: no csPCa=4 (25%) | yes csPCa=12 (75%)
[probe][epoch1 batch 01] has_lesion: 8/16 (50%) || labels: no csPCa=4 (25%) | yes csPCa=12 (75%)
[probe][epoch1 batch 02] has_lesion: 11/16 (69%) || labels: no csPCa=4 (25%) | yes csPCa=12 (75%)
[probe][epoch1 batch 03] has_lesion: 8/16 (50%) || labels: no csPCa=7 (44%) | yes csPCa=9 (56%)
[probe][epoch1 batch 04] has_lesion: 6/16 (38%) || labels: no csPCa=8 (50%) | yes csPCa=8 (50%)
[probe][epoch1 batch 05] has_lesion: 9/16 (56%) || labels: no csPCa=7 (44%) | yes csPCa=9 (56%)
[probe][epoch1 batch 06] has_lesion: 7/16 (44%) || labels: no csPCa=8 (50%) | yes csPCa=8 (50%)
[probe][epoch1 batch 07] has_lesion: 10/16 (62%) || labels: no csPCa=6 (38%) | yes csPCa=10 (62%)
[001] train: loss 0.1986 acc 0.6141 f1 0.3824 | val: loss 1.8905 acc 0.2842 f1 0.2213 | acc[c0]=0.000  acc[c1]=1.000 | auc[c0]=0.505  auc[c1]=0.505 | macroAUC=0.505 | macroSens=0.500 macroSpec=0.500 | sens[c0]=0.000  sens[c1]=1.000 | spec[c0]=1.000  spec[c1]=0.000
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa       0    4793
yes csPCa       0    1903
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5000)
[002] train: loss 0.1770 acc 0.6118 f1 0.3796 | val: loss 1.8978 acc 0.2842 f1 0.2213 | acc[c0]=0.000  acc[c1]=1.000 | auc[c0]=0.513  auc[c1]=0.513 | macroAUC=0.513 | macroSens=0.500 macroSpec=0.500 | sens[c0]=0.000  sens[c1]=1.000 | spec[c0]=1.000  spec[c1]=0.000
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa       0    4793
yes csPCa       0    1903
  ↳ no improvement (1/10)
→ Unfroze encoder at epoch 3; added to optimizer with lr=1e-06
[003] train: loss 0.1562 acc 0.6138 f1 0.3806 | val: loss 1.5358 acc 0.2848 f1 0.2227 | acc[c0]=0.001  acc[c1]=0.998 | auc[c0]=0.596  auc[c1]=0.596 | macroAUC=0.596 | macroSens=0.500 macroSpec=0.500 | sens[c0]=0.001  sens[c1]=0.998 | spec[c0]=0.998  spec[c1]=0.001
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa       7    4786
yes csPCa       3    1900
  ↳ no improvement (2/10)
[004] train: loss 0.1340 acc 0.6299 f1 0.4218 | val: loss 1.4714 acc 0.3363 f1 0.3038 | acc[c0]=0.084  acc[c1]=0.972 | auc[c0]=0.619  auc[c1]=0.619 | macroAUC=0.619 | macroSens=0.528 macroSpec=0.528 | sens[c0]=0.084  sens[c1]=0.972 | spec[c0]=0.972  spec[c1]=0.084
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa     402    4391
yes csPCa      53    1850
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5280)
[005] train: loss 0.1259 acc 0.6706 f1 0.5274 | val: loss 1.3683 acc 0.3807 f1 0.3652 | acc[c0]=0.157  acc[c1]=0.945 | auc[c0]=0.630  auc[c1]=0.630 | macroAUC=0.630 | macroSens=0.551 macroSpec=0.551 | sens[c0]=0.157  sens[c1]=0.945 | spec[c0]=0.945  spec[c1]=0.157
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa     751    4042
yes csPCa     105    1798
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5508)
[006] train: loss 0.1185 acc 0.7186 f1 0.6291 | val: loss 1.2651 acc 0.4344 f1 0.4314 | acc[c0]=0.252  acc[c1]=0.893 | auc[c0]=0.630  auc[c1]=0.630 | macroAUC=0.630 | macroSens=0.573 macroSpec=0.573 | sens[c0]=0.252  sens[c1]=0.893 | spec[c0]=0.893  spec[c1]=0.252
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    1209    3584
yes csPCa     203    1700
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5728)
[007] train: loss 0.1107 acc 0.7489 f1 0.6812 | val: loss 1.1690 acc 0.4745 f1 0.4744 | acc[c0]=0.335  acc[c1]=0.824 | auc[c0]=0.632  auc[c1]=0.632 | macroAUC=0.632 | macroSens=0.580 macroSpec=0.580 | sens[c0]=0.335  sens[c1]=0.824 | spec[c0]=0.824  spec[c1]=0.335
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    1608    3185
yes csPCa     334    1569
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5800)
[008] train: loss 0.1063 acc 0.7823 f1 0.7346 | val: loss 1.2321 acc 0.4703 f1 0.4703 | acc[c0]=0.328  acc[c1]=0.828 | auc[c0]=0.631  auc[c1]=0.631 | macroAUC=0.631 | macroSens=0.578 macroSpec=0.578 | sens[c0]=0.328  sens[c1]=0.828 | spec[c0]=0.828  spec[c1]=0.328
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    1574    3219
yes csPCa     328    1575
  ↳ no improvement (1/10)
[009] train: loss 0.1010 acc 0.7982 f1 0.7601 | val: loss 1.2558 acc 0.5090 f1 0.5059 | acc[c0]=0.410  acc[c1]=0.758 | auc[c0]=0.632  auc[c1]=0.632 | macroAUC=0.632 | macroSens=0.584 macroSpec=0.584 | sens[c0]=0.410  sens[c1]=0.758 | spec[c0]=0.758  spec[c1]=0.410
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    1966    2827
yes csPCa     461    1442
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5840)
[010] train: loss 0.0965 acc 0.8252 f1 0.7963 | val: loss 1.3947 acc 0.4897 f1 0.4888 | acc[c0]=0.371  acc[c1]=0.789 | auc[c0]=0.632  auc[c1]=0.632 | macroAUC=0.632 | macroSens=0.580 macroSpec=0.580 | sens[c0]=0.371  sens[c1]=0.789 | spec[c0]=0.789  spec[c1]=0.371
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    1778    3015
yes csPCa     402    1501
  ↳ no improvement (1/10)
[011] train: loss 0.0912 acc 0.8476 f1 0.8263 | val: loss 1.2576 acc 0.5493 f1 0.5372 | acc[c0]=0.497  acc[c1]=0.682 | auc[c0]=0.628  auc[c1]=0.628 | macroAUC=0.628 | macroSens=0.589 macroSpec=0.589 | sens[c0]=0.497  sens[c1]=0.682 | spec[c0]=0.682  spec[c1]=0.497
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    2380    2413
yes csPCa     605    1298
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/binary_all/results512/baseline/ckpt_best.pt (BAL-acc=0.5893)
[012] train: loss 0.0898 acc 0.8662 f1 0.8486 | val: loss 1.2230 acc 0.5530 f1 0.5357 | acc[c0]=0.521  acc[c1]=0.633 | auc[c0]=0.606  auc[c1]=0.606 | macroAUC=0.606 | macroSens=0.577 macroSpec=0.577 | sens[c0]=0.521  sens[c1]=0.633 | spec[c0]=0.633  spec[c1]=0.521
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    2498    2295
yes csPCa     698    1205
  ↳ no improvement (1/10)
[013] train: loss 0.0829 acc 0.8912 f1 0.8803 | val: loss 1.2977 acc 0.5992 f1 0.5582 | acc[c0]=0.631  acc[c1]=0.519 | auc[c0]=0.610  auc[c1]=0.610 | macroAUC=0.610 | macroSens=0.575 macroSpec=0.575 | sens[c0]=0.631  sens[c1]=0.519 | spec[c0]=0.519  spec[c1]=0.631
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3025    1768
yes csPCa     916     987
  ↳ no improvement (2/10)
[014] train: loss 0.0790 acc 0.9072 f1 0.8985 | val: loss 1.4129 acc 0.5915 f1 0.5533 | acc[c0]=0.618  acc[c1]=0.526 | auc[c0]=0.605  auc[c1]=0.605 | macroAUC=0.605 | macroSens=0.572 macroSpec=0.572 | sens[c0]=0.618  sens[c1]=0.526 | spec[c0]=0.526  spec[c1]=0.618
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    2960    1833
yes csPCa     902    1001
  ↳ no improvement (3/10)
[015] train: loss 0.0702 acc 0.9244 f1 0.9182 | val: loss 1.5075 acc 0.6171 f1 0.5601 | acc[c0]=0.682  acc[c1]=0.452 | auc[c0]=0.595  auc[c1]=0.595 | macroAUC=0.595 | macroSens=0.567 macroSpec=0.567 | sens[c0]=0.682  sens[c1]=0.452 | spec[c0]=0.452  spec[c1]=0.682
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3271    1522
yes csPCa    1042     861
  ↳ no improvement (4/10)
[016] train: loss 0.0676 acc 0.9344 f1 0.9294 | val: loss 1.7013 acc 0.6139 f1 0.5543 | acc[c0]=0.684  acc[c1]=0.437 | auc[c0]=0.596  auc[c1]=0.596 | macroAUC=0.596 | macroSens=0.561 macroSpec=0.561 | sens[c0]=0.684  sens[c1]=0.437 | spec[c0]=0.437  spec[c1]=0.684
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3280    1513
yes csPCa    1072     831
  ↳ no improvement (5/10)
[017] train: loss 0.0656 acc 0.9473 f1 0.9436 | val: loss 1.7448 acc 0.6323 f1 0.5560 | acc[c0]=0.731  acc[c1]=0.383 | auc[c0]=0.595  auc[c1]=0.595 | macroAUC=0.595 | macroSens=0.557 macroSpec=0.557 | sens[c0]=0.731  sens[c1]=0.383 | spec[c0]=0.383  spec[c1]=0.731
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3505    1288
yes csPCa    1174     729
  ↳ no improvement (6/10)
[018] train: loss 0.0603 acc 0.9573 f1 0.9546 | val: loss 1.9854 acc 0.5909 f1 0.5463 | acc[c0]=0.632  acc[c1]=0.488 | auc[c0]=0.591  auc[c1]=0.591 | macroAUC=0.591 | macroSens=0.560 macroSpec=0.560 | sens[c0]=0.632  sens[c1]=0.488 | spec[c0]=0.488  spec[c1]=0.632
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3029    1764
yes csPCa     975     928
  ↳ no improvement (7/10)
[019] train: loss 0.0497 acc 0.9628 f1 0.9605 | val: loss 2.1000 acc 0.6417 f1 0.5562 | acc[c0]=0.755  acc[c1]=0.357 | auc[c0]=0.598  auc[c1]=0.598 | macroAUC=0.598 | macroSens=0.556 macroSpec=0.556 | sens[c0]=0.755  sens[c1]=0.357 | spec[c0]=0.357  spec[c1]=0.755
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3618    1175
yes csPCa    1224     679
  ↳ no improvement (8/10)
[020] train: loss 0.0433 acc 0.9731 f1 0.9715 | val: loss 2.3361 acc 0.6507 f1 0.5457 | acc[c0]=0.790  acc[c1]=0.299 | auc[c0]=0.588  auc[c1]=0.588 | macroAUC=0.588 | macroSens=0.545 macroSpec=0.545 | sens[c0]=0.790  sens[c1]=0.299 | spec[c0]=0.299  spec[c1]=0.790
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3788    1005
yes csPCa    1334     569
  ↳ no improvement (9/10)
[021] train: loss 0.0407 acc 0.9778 f1 0.9765 | val: loss 2.5055 acc 0.6104 f1 0.5536 | acc[c0]=0.675  acc[c1]=0.447 | auc[c0]=0.590  auc[c1]=0.590 | macroAUC=0.590 | macroSens=0.561 macroSpec=0.561 | sens[c0]=0.675  sens[c1]=0.447 | spec[c0]=0.447  spec[c1]=0.675
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3237    1556
yes csPCa    1053     850
  ↳ no improvement (10/10)
Early stopping triggered at epoch 21: no BAL-acc improvement for 10 epochs.

=== Final model: Sensitivity at fixed specificity (validation) ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.628 |        0.352 |        0.218 |        0.131 |        0.068 |        0.024
          c1 |        0.628 |        0.348 |        0.208 |        0.127 |        0.075 |        0.028
       macro |        0.628 |        0.350 |        0.213 |        0.129 |        0.071 |        0.026
