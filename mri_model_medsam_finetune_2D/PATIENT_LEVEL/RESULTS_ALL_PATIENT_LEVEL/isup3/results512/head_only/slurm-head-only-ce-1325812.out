Host: kn037
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Thu Oct 23 14:04:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:CA:00.0 Off |                    0 |
| N/A   29C    P8             34W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
ARGS: Namespace(manifest='/project/aip-medilab/shared/picai/manifests/slices_manifest.csv', sam_checkpoint='/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth', encoder_ckpt='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/triplet_logreg_karolinska/ckpt_best.pt', outdir='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only', target='isup3', folds_train='1,2,3', folds_val='0', batch_size=32, epochs=100, lr_head=1e-05, wd=0.0, pos_ratio=0.33, proj_dim=512, train_proj=False, use_skip=False)
[load_encoder_only] Loaded encoder weights from /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/triplet_logreg_karolinska/ckpt_best.pt
[001] head-train: loss 0.7302 || val: loss 0.3087 acc 0.2183 BAL-acc 0.3600 f1 0.1834 | acc[c0]=0.003  acc[c1]=0.909  acc[c2]=0.168 | auc[c0]=0.668  auc[c1]=0.517  auc[c2]=0.600 | macroAUC=0.595 | macroSens=0.360 macroSpec=0.665 | sens[c0]=0.003  sens[c1]=0.909  sens[c2]=0.168 | spec[c0]=0.999  spec[c1]=0.030  spec[c2]=0.967
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0      15    4703      75
    ISUP1       2    1383     136
    ISUP2       0     318      64
  ↳ new best (val BAL-acc=0.3600) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[002] head-train: loss 0.6003 || val: loss 0.3203 acc 0.2761 BAL-acc 0.3769 f1 0.2345 | acc[c0]=0.111  acc[c1]=0.813  acc[c2]=0.207 | auc[c0]=0.673  auc[c1]=0.557  auc[c2]=0.572 | macroAUC=0.601 | macroSens=0.377 macroSpec=0.687 | sens[c0]=0.111  sens[c1]=0.813  sens[c2]=0.207 | spec[c0]=0.963  spec[c1]=0.193  spec[c2]=0.905
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     534    3890     369
    ISUP1      55    1236     230
    ISUP2      16     287      79
  ↳ new best (val BAL-acc=0.3769) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[003] head-train: loss 0.5536 || val: loss 0.3335 acc 0.2999 BAL-acc 0.3837 f1 0.2571 | acc[c0]=0.169  acc[c1]=0.723  acc[c2]=0.259 | auc[c0]=0.675  auc[c1]=0.561  auc[c2]=0.566 | macroAUC=0.601 | macroSens=0.384 macroSpec=0.698 | sens[c0]=0.169  sens[c1]=0.723  sens[c2]=0.259 | spec[c0]=0.942  spec[c1]=0.312  spec[c2]=0.839
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     809    3303     681
    ISUP1      83    1100     338
    ISUP2      27     256      99
  ↳ new best (val BAL-acc=0.3837) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[004] head-train: loss 0.5399 || val: loss 0.3381 acc 0.2809 BAL-acc 0.3817 f1 0.2457 | acc[c0]=0.152  acc[c1]=0.679  acc[c2]=0.314 | auc[c0]=0.675  auc[c1]=0.568  auc[c2]=0.552 | macroAUC=0.598 | macroSens=0.382 macroSpec=0.697 | sens[c0]=0.152  sens[c1]=0.679  sens[c2]=0.314 | spec[c0]=0.951  spec[c1]=0.382  spec[c2]=0.758
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     728    2959    1106
    ISUP1      69    1033     419
    ISUP2      24     238     120
  ↳ no improvement (1/10)
[005] head-train: loss 0.5233 || val: loss 0.3454 acc 0.2826 BAL-acc 0.3817 f1 0.2513 | acc[c0]=0.169  acc[c1]=0.623  acc[c2]=0.353 | auc[c0]=0.676  auc[c1]=0.571  auc[c2]=0.549 | macroAUC=0.599 | macroSens=0.382 macroSpec=0.701 | sens[c0]=0.169  sens[c1]=0.623  sens[c2]=0.353 | spec[c0]=0.947  spec[c1]=0.449  spec[c2]=0.707
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     810    2631    1352
    ISUP1      75     947     499
    ISUP2      26     221     135
  ↳ no improvement (2/10)
[006] head-train: loss 0.5264 || val: loss 0.3526 acc 0.2964 BAL-acc 0.3856 f1 0.2580 | acc[c0]=0.177  acc[c1]=0.671  acc[c2]=0.309 | auc[c0]=0.677  auc[c1]=0.566  auc[c2]=0.552 | macroAUC=0.598 | macroSens=0.386 macroSpec=0.702 | sens[c0]=0.177  sens[c1]=0.671  sens[c2]=0.309 | spec[c0]=0.943  spec[c1]=0.394  spec[c2]=0.767
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     846    2897    1050
    ISUP1      81    1021     419
    ISUP2      27     237     118
  ↳ new best (val BAL-acc=0.3856) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[007] head-train: loss 0.5169 || val: loss 0.3591 acc 0.3136 BAL-acc 0.3846 f1 0.2654 | acc[c0]=0.189  acc[c1]=0.724  acc[c2]=0.241 | auc[c0]=0.678  auc[c1]=0.570  auc[c2]=0.552 | macroAUC=0.600 | macroSens=0.385 macroSpec=0.704 | sens[c0]=0.189  sens[c1]=0.724  sens[c2]=0.241 | spec[c0]=0.941  spec[c1]=0.340  spec[c2]=0.831
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     907    3153     733
    ISUP1      84    1101     336
    ISUP2      28     262      92
  ↳ no improvement (1/10)
[008] head-train: loss 0.5127 || val: loss 0.3574 acc 0.2973 BAL-acc 0.3883 f1 0.2597 | acc[c0]=0.178  acc[c1]=0.667  acc[c2]=0.319 | auc[c0]=0.678  auc[c1]=0.567  auc[c2]=0.547 | macroAUC=0.597 | macroSens=0.388 macroSpec=0.704 | sens[c0]=0.178  sens[c1]=0.667  sens[c2]=0.319 | spec[c0]=0.948  spec[c1]=0.412  spec[c2]=0.752
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     854    2808    1131
    ISUP1      72    1015     434
    ISUP2      27     233     122
  ↳ new best (val BAL-acc=0.3883) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[009] head-train: loss 0.5148 || val: loss 0.3570 acc 0.2873 BAL-acc 0.3884 f1 0.2547 | acc[c0]=0.169  acc[c1]=0.642  acc[c2]=0.353 | auc[c0]=0.677  auc[c1]=0.563  auc[c2]=0.551 | macroAUC=0.597 | macroSens=0.388 macroSpec=0.702 | sens[c0]=0.169  sens[c1]=0.642  sens[c2]=0.353 | spec[c0]=0.951  spec[c1]=0.433  spec[c2]=0.724
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     812    2713    1268
    ISUP1      67     977     477
    ISUP2      27     220     135
  ↳ new best (val BAL-acc=0.3884) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[010] head-train: loss 0.5155 || val: loss 0.3576 acc 0.3100 BAL-acc 0.3887 f1 0.2681 | acc[c0]=0.197  acc[c1]=0.668  acc[c2]=0.301 | auc[c0]=0.678  auc[c1]=0.567  auc[c2]=0.555 | macroAUC=0.600 | macroSens=0.389 macroSpec=0.706 | sens[c0]=0.197  sens[c1]=0.668  sens[c2]=0.301 | spec[c0]=0.938  spec[c1]=0.409  spec[c2]=0.772
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     945    2827    1021
    ISUP1      85    1016     420
    ISUP2      33     234     115
  ↳ new best (val BAL-acc=0.3887) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[011] head-train: loss 0.5051 || val: loss 0.3584 acc 0.3114 BAL-acc 0.3965 f1 0.2744 | acc[c0]=0.210  acc[c1]=0.618  acc[c2]=0.361 | auc[c0]=0.677  auc[c1]=0.572  auc[c2]=0.553 | macroAUC=0.601 | macroSens=0.396 macroSpec=0.709 | sens[c0]=0.210  sens[c1]=0.618  sens[c2]=0.361 | spec[c0]=0.932  spec[c1]=0.470  spec[c2]=0.724
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0    1007    2530    1256
    ISUP1      97     940     484
    ISUP2      33     211     138
  ↳ new best (val BAL-acc=0.3965) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[012] head-train: loss 0.5062 || val: loss 0.3601 acc 0.3144 BAL-acc 0.3911 f1 0.2684 | acc[c0]=0.191  acc[c1]=0.715  acc[c2]=0.267 | auc[c0]=0.678  auc[c1]=0.569  auc[c2]=0.553 | macroAUC=0.600 | macroSens=0.391 macroSpec=0.706 | sens[c0]=0.191  sens[c1]=0.715  sens[c2]=0.267 | spec[c0]=0.942  spec[c1]=0.365  spec[c2]=0.811
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     915    3036     842
    ISUP1      81    1088     352
    ISUP2      30     250     102
  ↳ no improvement (1/10)
[013] head-train: loss 0.5042 || val: loss 0.3563 acc 0.2994 BAL-acc 0.3851 f1 0.2576 | acc[c0]=0.173  acc[c1]=0.702  acc[c2]=0.280 | auc[c0]=0.678  auc[c1]=0.564  auc[c2]=0.554 | macroAUC=0.599 | macroSens=0.385 macroSpec=0.702 | sens[c0]=0.173  sens[c1]=0.702  sens[c2]=0.280 | spec[c0]=0.949  spec[c1]=0.367  spec[c2]=0.791
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     830    3030     933
    ISUP1      69    1068     384
    ISUP2      29     246     107
  ↳ no improvement (2/10)
[014] head-train: loss 0.5027 || val: loss 0.3616 acc 0.3238 BAL-acc 0.3940 f1 0.2745 | acc[c0]=0.199  acc[c1]=0.737  acc[c2]=0.246 | auc[c0]=0.678  auc[c1]=0.568  auc[c2]=0.559 | macroAUC=0.602 | macroSens=0.394 macroSpec=0.707 | sens[c0]=0.199  sens[c1]=0.737  sens[c2]=0.246 | spec[c0]=0.939  spec[c1]=0.337  spec[c2]=0.845
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     953    3176     664
    ISUP1      85    1121     315
    ISUP2      32     256      94
  ↳ no improvement (3/10)
[015] head-train: loss 0.5070 || val: loss 0.3569 acc 0.3200 BAL-acc 0.3927 f1 0.2726 | acc[c0]=0.196  acc[c1]=0.728  acc[c2]=0.254 | auc[c0]=0.678  auc[c1]=0.565  auc[c2]=0.564 | macroAUC=0.602 | macroSens=0.393 macroSpec=0.705 | sens[c0]=0.196  sens[c1]=0.728  sens[c2]=0.254 | spec[c0]=0.939  spec[c1]=0.333  spec[c2]=0.844
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     938    3197     658
    ISUP1      85    1108     328
    ISUP2      32     253      97
  ↳ no improvement (4/10)
[016] head-train: loss 0.4777 || val: loss 0.3601 acc 0.3284 BAL-acc 0.3945 f1 0.2789 | acc[c0]=0.210  acc[c1]=0.719  acc[c2]=0.254 | auc[c0]=0.678  auc[c1]=0.565  auc[c2]=0.567 | macroAUC=0.604 | macroSens=0.394 macroSpec=0.708 | sens[c0]=0.210  sens[c1]=0.719  sens[c2]=0.254 | spec[c0]=0.934  spec[c1]=0.351  spec[c2]=0.840
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0    1008    3111     674
    ISUP1      91    1094     336
    ISUP2      35     250      97
  ↳ no improvement (5/10)
[017] head-train: loss 0.4972 || val: loss 0.3537 acc 0.2935 BAL-acc 0.3860 f1 0.2534 | acc[c0]=0.163  acc[c1]=0.707  acc[c2]=0.288 | auc[c0]=0.678  auc[c1]=0.561  auc[c2]=0.561 | macroAUC=0.600 | macroSens=0.386 macroSpec=0.701 | sens[c0]=0.163  sens[c1]=0.707  sens[c2]=0.288 | spec[c0]=0.956  spec[c1]=0.355  spec[c2]=0.793
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     779    3092     922
    ISUP1      60    1076     385
    ISUP2      24     248     110
  ↳ no improvement (6/10)
[018] head-train: loss 0.5051 || val: loss 0.3527 acc 0.3135 BAL-acc 0.3913 f1 0.2693 | acc[c0]=0.194  acc[c1]=0.697  acc[c2]=0.283 | auc[c0]=0.678  auc[c1]=0.564  auc[c2]=0.569 | macroAUC=0.604 | macroSens=0.391 macroSpec=0.706 | sens[c0]=0.194  sens[c1]=0.697  sens[c2]=0.283 | spec[c0]=0.942  spec[c1]=0.370  spec[c2]=0.806
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     931    3016     846
    ISUP1      79    1060     382
    ISUP2      32     242     108
  ↳ no improvement (7/10)
[019] head-train: loss 0.4923 || val: loss 0.3578 acc 0.3156 BAL-acc 0.3941 f1 0.2669 | acc[c0]=0.174  acc[c1]=0.786  acc[c2]=0.223 | auc[c0]=0.678  auc[c1]=0.571  auc[c2]=0.562 | macroAUC=0.604 | macroSens=0.394 macroSpec=0.703 | sens[c0]=0.174  sens[c1]=0.786  sens[c2]=0.223 | spec[c0]=0.951  spec[c1]=0.279  spec[c2]=0.880
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     832    3462     499
    ISUP1      68    1196     257
    ISUP2      26     271      85
  ↳ no improvement (8/10)
[020] head-train: loss 0.4987 || val: loss 0.3489 acc 0.2945 BAL-acc 0.3905 f1 0.2574 | acc[c0]=0.170  acc[c1]=0.679  acc[c2]=0.322 | auc[c0]=0.678  auc[c1]=0.562  auc[c2]=0.566 | macroAUC=0.602 | macroSens=0.390 macroSpec=0.703 | sens[c0]=0.170  sens[c1]=0.679  sens[c2]=0.322 | spec[c0]=0.953  spec[c1]=0.388  spec[c2]=0.767
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     816    2933    1044
    ISUP1      63    1033     425
    ISUP2      26     233     123
  ↳ no improvement (9/10)
[021] head-train: loss 0.4944 || val: loss 0.3480 acc 0.3106 BAL-acc 0.3980 f1 0.2704 | acc[c0]=0.193  acc[c1]=0.679  acc[c2]=0.322 | auc[c0]=0.678  auc[c1]=0.570  auc[c2]=0.568 | macroAUC=0.605 | macroSens=0.398 macroSpec=0.707 | sens[c0]=0.193  sens[c1]=0.679  sens[c2]=0.322 | spec[c0]=0.942  spec[c1]=0.398  spec[c2]=0.780
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     924    2886     983
    ISUP1      79    1033     409
    ISUP2      31     228     123
  ↳ new best (val BAL-acc=0.3980) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[022] head-train: loss 0.5013 || val: loss 0.3455 acc 0.3056 BAL-acc 0.3985 f1 0.2666 | acc[c0]=0.183  acc[c1]=0.688  acc[c2]=0.325 | auc[c0]=0.678  auc[c1]=0.569  auc[c2]=0.570 | macroAUC=0.606 | macroSens=0.399 macroSpec=0.706 | sens[c0]=0.183  sens[c1]=0.688  sens[c2]=0.325 | spec[c0]=0.949  spec[c1]=0.386  spec[c2]=0.782
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     875    2946     972
    ISUP1      71    1047     403
    ISUP2      27     231     124
  ↳ new best (val BAL-acc=0.3985) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[023] head-train: loss 0.4884 || val: loss 0.3461 acc 0.3151 BAL-acc 0.3968 f1 0.2707 | acc[c0]=0.189  acc[c1]=0.721  acc[c2]=0.280 | auc[c0]=0.679  auc[c1]=0.571  auc[c2]=0.573 | macroAUC=0.608 | macroSens=0.397 macroSpec=0.706 | sens[c0]=0.189  sens[c1]=0.721  sens[c2]=0.280 | spec[c0]=0.946  spec[c1]=0.349  spec[c2]=0.823
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     906    3121     766
    ISUP1      75    1097     349
    ISUP2      28     247     107
  ↳ no improvement (1/10)
[024] head-train: loss 0.4989 || val: loss 0.3476 acc 0.3184 BAL-acc 0.3976 f1 0.2714 | acc[c0]=0.185  acc[c1]=0.757  acc[c2]=0.251 | auc[c0]=0.679  auc[c1]=0.572  auc[c2]=0.575 | macroAUC=0.609 | macroSens=0.398 macroSpec=0.706 | sens[c0]=0.185  sens[c1]=0.757  sens[c2]=0.251 | spec[c0]=0.951  spec[c1]=0.312  spec[c2]=0.856
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     885    3298     610
    ISUP1      68    1151     302
    ISUP2      25     261      96
  ↳ no improvement (2/10)
[025] head-train: loss 0.4927 || val: loss 0.3457 acc 0.3233 BAL-acc 0.3995 f1 0.2759 | acc[c0]=0.194  acc[c1]=0.748  acc[c2]=0.257 | auc[c0]=0.678  auc[c1]=0.574  auc[c2]=0.577 | macroAUC=0.610 | macroSens=0.400 macroSpec=0.707 | sens[c0]=0.194  sens[c1]=0.748  sens[c2]=0.257 | spec[c0]=0.944  spec[c1]=0.325  spec[c2]=0.853
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     929    3239     625
    ISUP1      77    1138     306
    ISUP2      30     254      98
  ↳ new best (val BAL-acc=0.3995) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[026] head-train: loss 0.4953 || val: loss 0.3474 acc 0.3336 BAL-acc 0.4013 f1 0.2826 | acc[c0]=0.207  acc[c1]=0.756  acc[c2]=0.241 | auc[c0]=0.678  auc[c1]=0.580  auc[c2]=0.574 | macroAUC=0.611 | macroSens=0.401 macroSpec=0.709 | sens[c0]=0.207  sens[c1]=0.756  sens[c2]=0.241 | spec[c0]=0.934  spec[c1]=0.328  spec[c2]=0.864
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     992    3223     578
    ISUP1      90    1150     281
    ISUP2      35     255      92
  ↳ new best (val BAL-acc=0.4013) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[027] head-train: loss 0.4897 || val: loss 0.3506 acc 0.3265 BAL-acc 0.3994 f1 0.2781 | acc[c0]=0.191  acc[c1]=0.776  acc[c2]=0.230 | auc[c0]=0.679  auc[c1]=0.568  auc[c2]=0.583 | macroAUC=0.610 | macroSens=0.399 macroSpec=0.706 | sens[c0]=0.191  sens[c1]=0.776  sens[c2]=0.230 | spec[c0]=0.945  spec[c1]=0.284  spec[c2]=0.889
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     917    3437     439
    ISUP1      78    1181     262
    ISUP2      27     267      88
  ↳ no improvement (1/10)
[028] head-train: loss 0.4943 || val: loss 0.3439 acc 0.3160 BAL-acc 0.3936 f1 0.2712 | acc[c0]=0.194  acc[c1]=0.709  acc[c2]=0.277 | auc[c0]=0.678  auc[c1]=0.569  auc[c2]=0.581 | macroAUC=0.609 | macroSens=0.394 macroSpec=0.706 | sens[c0]=0.194  sens[c1]=0.709  sens[c2]=0.277 | spec[c0]=0.941  spec[c1]=0.354  spec[c2]=0.822
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     932    3100     761
    ISUP1      80    1078     363
    ISUP2      33     243     106
  ↳ no improvement (2/10)
[029] head-train: loss 0.4847 || val: loss 0.3470 acc 0.3257 BAL-acc 0.3998 f1 0.2782 | acc[c0]=0.200  acc[c1]=0.738  acc[c2]=0.262 | auc[c0]=0.678  auc[c1]=0.574  auc[c2]=0.575 | macroAUC=0.609 | macroSens=0.400 macroSpec=0.707 | sens[c0]=0.200  sens[c1]=0.738  sens[c2]=0.262 | spec[c0]=0.939  spec[c1]=0.335  spec[c2]=0.848
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     959    3192     642
    ISUP1      83    1122     316
    ISUP2      33     249     100
  ↳ no improvement (3/10)
[030] head-train: loss 0.4944 || val: loss 0.3468 acc 0.3277 BAL-acc 0.3991 f1 0.2800 | acc[c0]=0.207  acc[c1]=0.723  acc[c2]=0.267 | auc[c0]=0.678  auc[c1]=0.575  auc[c2]=0.579 | macroAUC=0.611 | macroSens=0.399 macroSpec=0.708 | sens[c0]=0.207  sens[c1]=0.723  sens[c2]=0.267 | spec[c0]=0.935  spec[c1]=0.348  spec[c2]=0.841
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     992    3130     671
    ISUP1      89    1100     332
    ISUP2      35     245     102
  ↳ no improvement (4/10)
[031] head-train: loss 0.4916 || val: loss 0.3437 acc 0.3175 BAL-acc 0.3991 f1 0.2730 | acc[c0]=0.191  acc[c1]=0.726  acc[c2]=0.280 | auc[c0]=0.678  auc[c1]=0.574  auc[c2]=0.578 | macroAUC=0.610 | macroSens=0.399 macroSpec=0.707 | sens[c0]=0.191  sens[c1]=0.726  sens[c2]=0.280 | spec[c0]=0.946  spec[c1]=0.342  spec[c2]=0.831
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     914    3155     724
    ISUP1      76    1105     340
    ISUP2      27     248     107
  ↳ no improvement (5/10)
[032] head-train: loss 0.4996 || val: loss 0.3465 acc 0.3345 BAL-acc 0.4055 f1 0.2849 | acc[c0]=0.201  acc[c1]=0.780  acc[c2]=0.236 | auc[c0]=0.678  auc[c1]=0.577  auc[c2]=0.579 | macroAUC=0.611 | macroSens=0.405 macroSpec=0.709 | sens[c0]=0.201  sens[c1]=0.780  sens[c2]=0.236 | spec[c0]=0.942  spec[c1]=0.298  spec[c2]=0.887
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     964    3370     459
    ISUP1      83    1186     252
    ISUP2      28     264      90
  ↳ new best (val BAL-acc=0.4055) saved to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/PATIENT_LEVEL/RESULTS/isup3/results512/head_only/ckpt_head_best.pt
[033] head-train: loss 0.4924 || val: loss 0.3514 acc 0.3332 BAL-acc 0.4016 f1 0.2831 | acc[c0]=0.195  acc[c1]=0.801  acc[c2]=0.209 | auc[c0]=0.678  auc[c1]=0.577  auc[c2]=0.582 | macroAUC=0.612 | macroSens=0.402 macroSpec=0.707 | sens[c0]=0.195  sens[c1]=0.801  sens[c2]=0.209 | spec[c0]=0.944  spec[c1]=0.266  spec[c2]=0.911
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     933    3526     334
    ISUP1      78    1218     225
    ISUP2      28     274      80
  ↳ no improvement (1/10)
[034] head-train: loss 0.4961 || val: loss 0.3403 acc 0.3166 BAL-acc 0.3961 f1 0.2708 | acc[c0]=0.187  acc[c1]=0.740  acc[c2]=0.262 | auc[c0]=0.678  auc[c1]=0.574  auc[c2]=0.584 | macroAUC=0.612 | macroSens=0.396 macroSpec=0.706 | sens[c0]=0.187  sens[c1]=0.740  sens[c2]=0.262 | spec[c0]=0.947  spec[c1]=0.325  spec[c2]=0.845
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     895    3240     658
    ISUP1      73    1125     323
    ISUP2      27     255     100
  ↳ no improvement (2/10)
[035] head-train: loss 0.4893 || val: loss 0.3405 acc 0.3124 BAL-acc 0.3973 f1 0.2707 | acc[c0]=0.192  acc[c1]=0.694  acc[c2]=0.306 | auc[c0]=0.678  auc[c1]=0.576  auc[c2]=0.577 | macroAUC=0.611 | macroSens=0.397 macroSpec=0.706 | sens[c0]=0.192  sens[c1]=0.694  sens[c2]=0.306 | spec[c0]=0.943  spec[c1]=0.375  spec[c2]=0.800
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     920    2994     879
    ISUP1      81    1055     385
    ISUP2      27     238     117
  ↳ no improvement (3/10)
[036] head-train: loss 0.4803 || val: loss 0.3458 acc 0.3236 BAL-acc 0.3991 f1 0.2749 | acc[c0]=0.188  acc[c1]=0.774  acc[c2]=0.236 | auc[c0]=0.678  auc[c1]=0.581  auc[c2]=0.571 | macroAUC=0.610 | macroSens=0.399 macroSpec=0.706 | sens[c0]=0.188  sens[c1]=0.774  sens[c2]=0.236 | spec[c0]=0.945  spec[c1]=0.298  spec[c2]=0.875
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     900    3369     524
    ISUP1      76    1177     268
    ISUP2      28     264      90
  ↳ no improvement (4/10)
[037] head-train: loss 0.4870 || val: loss 0.3473 acc 0.3541 BAL-acc 0.4053 f1 0.3005 | acc[c0]=0.259  acc[c1]=0.672  acc[c2]=0.285 | auc[c0]=0.678  auc[c1]=0.581  auc[c2]=0.583 | macroAUC=0.614 | macroSens=0.405 macroSpec=0.716 | sens[c0]=0.259  sens[c1]=0.672  sens[c2]=0.285 | spec[c0]=0.912  spec[c1]=0.414  spec[c2]=0.822
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0    1240    2797     756
    ISUP1     128    1022     371
    ISUP2      40     233     109
  ↳ no improvement (5/10)
[038] head-train: loss 0.4773 || val: loss 0.3449 acc 0.3094 BAL-acc 0.3937 f1 0.2645 | acc[c0]=0.172  acc[c1]=0.758  acc[c2]=0.251 | auc[c0]=0.678  auc[c1]=0.573  auc[c2]=0.574 | macroAUC=0.608 | macroSens=0.394 macroSpec=0.703 | sens[c0]=0.172  sens[c1]=0.758  sens[c2]=0.251 | spec[c0]=0.953  spec[c1]=0.297  spec[c2]=0.858
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     823    3374     596
    ISUP1      67    1153     301
    ISUP2      23     263      96
  ↳ no improvement (6/10)
[039] head-train: loss 0.4773 || val: loss 0.3506 acc 0.3395 BAL-acc 0.4002 f1 0.2881 | acc[c0]=0.227  acc[c1]=0.715  acc[c2]=0.259 | auc[c0]=0.678  auc[c1]=0.575  auc[c2]=0.576 | macroAUC=0.610 | macroSens=0.400 macroSpec=0.712 | sens[c0]=0.227  sens[c1]=0.715  sens[c2]=0.259 | spec[c0]=0.929  spec[c1]=0.362  spec[c2]=0.844
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0    1087    3054     652
    ISUP1     100    1087     334
    ISUP2      35     248      99
  ↳ no improvement (7/10)
[040] head-train: loss 0.4869 || val: loss 0.3506 acc 0.3254 BAL-acc 0.3985 f1 0.2760 | acc[c0]=0.181  acc[c1]=0.810  acc[c2]=0.204 | auc[c0]=0.678  auc[c1]=0.581  auc[c2]=0.573 | macroAUC=0.611 | macroSens=0.398 macroSpec=0.705 | sens[c0]=0.181  sens[c1]=0.810  sens[c2]=0.204 | spec[c0]=0.948  spec[c1]=0.253  spec[c2]=0.912
Confusion matrix (LR val): rows=true, cols=pred
true\pred   ISUP0   ISUP1   ISUP2   ISUP3   ISUP4   ISUP5
    ISUP0     869    3586     338
    ISUP1      74    1232     215
    ISUP2      25     279      78
  ↳ no improvement (8/10)
slurmstepd: error: *** STEP 1325812.0 ON kn037 CANCELLED AT 2025-10-24T14:04:15 DUE TO TIME LIMIT ***
slurmstepd: error: *** JOB 1325812 ON kn037 CANCELLED AT 2025-10-24T14:04:15 DUE TO TIME LIMIT ***
