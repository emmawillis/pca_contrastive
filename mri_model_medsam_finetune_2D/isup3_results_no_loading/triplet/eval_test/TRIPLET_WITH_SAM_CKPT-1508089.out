Host: kn042
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Wed Nov 26 16:34:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:65:00.0 Off |                    0 |
| N/A   37C    P8             36W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
ARGS: Namespace(manifest='/project/aip-medilab/shared/picai/manifests/slices_manifest.csv', sam_checkpoint='/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth', model_ckpt='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/isup3_results_no_loading/triplet/ckpt_head_best.pt', outdir='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/isup3_results_no_loading/triplet/eval_test', target='isup3', folds_train='1,2,3', fold_test='4', batch_size=16, pos_ratio=0.33, proj_dim=512, use_skip=False, label6_column='merged_ISUP', spec_targets='0.8,0.9,0.95,0.975,0.99', csv_path='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/isup3_results_no_loading/results.csv', pred_col_name='aligned_prediction')
!!!!!! classes_present [0, 1, 2]
[TEST] loss 0.2177 acc 0.7894 bacc 0.5452 f1 0.4316 | acc[c0]=0.811  acc[c1]=0.596  acc[c2]=0.229 | auc[c0]=0.854  auc[c1]=0.732  auc[c2]=0.552 | macroAUC=0.713 | macroSens=0.545 macroSpec=0.860 | sens[c0]=0.811  sens[c1]=0.596  sens[c2]=0.229 | spec[c0]=0.784  spec[c1]=0.830  spec[c2]=0.965
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5070    1032     151
   ISUP23      84     246      83
   ISUP45      26      48      22

=== Final model: Sensitivity at fixed specificity ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.854 |        0.779 |        0.528 |        0.257 |        0.122 |        0.097
          c1 |        0.732 |        0.620 |        0.443 |        0.278 |        0.165 |        0.085
          c2 |        0.552 |        0.406 |        0.354 |        0.271 |        0.198 |        0.083
       macro |        0.713 |        0.602 |        0.442 |        0.269 |        0.161 |        0.088
Saved per-sample predictions to: /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/isup3_results_no_loading/results.csv
