Host: kn076
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Sun Oct 19 23:34:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:CA:00.0 Off |                    0 |
| N/A   46C    P8             37W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[probe][epoch1 batch 00] has_lesion: 6/16 (38%) || labels: no csPCa=10 (62%) | yes csPCa=6 (38%)
[probe][epoch1 batch 01] has_lesion: 7/16 (44%) || labels: no csPCa=9 (56%) | yes csPCa=7 (44%)
[001] train: loss 0.2766 acc 0.5127 f1 0.3550 | val: loss 1.8472 acc 0.0948 f1 0.0911 | acc[c0]=0.017  acc[c1]=0.995 | auc[c0]=0.704  auc[c1]=0.704 | macroAUC=0.704 | macroSens=0.506 macroSpec=0.506 | sens[c0]=0.017  sens[c1]=0.995 | spec[c0]=0.995  spec[c1]=0.017
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa      84    4954
yes csPCa       2     435
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results512/baseline/ckpt_best.pt (BAL-acc=0.5060)
[002] train: loss 0.2570 acc 0.5197 f1 0.3703 | val: loss 1.7917 acc 0.1068 f1 0.1045 | acc[c0]=0.030  acc[c1]=0.991 | auc[c0]=0.711  auc[c1]=0.711 | macroAUC=0.711 | macroSens=0.511 macroSpec=0.511 | sens[c0]=0.030  sens[c1]=0.991 | spec[c0]=0.991  spec[c1]=0.030
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa     152    4886
yes csPCa       4     433
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results512/baseline/ckpt_best.pt (BAL-acc=0.5105)
→ Unfroze encoder at epoch 3; added to optimizer with lr=1e-06
[003] train: loss 0.1919 acc 0.6827 f1 0.6510 | val: loss 1.0496 acc 0.5728 f1 0.4805 | acc[c0]=0.540  acc[c1]=0.947 | auc[c0]=0.884  auc[c1]=0.884 | macroAUC=0.884 | macroSens=0.744 macroSpec=0.744 | sens[c0]=0.540  sens[c1]=0.947 | spec[c0]=0.947  spec[c1]=0.540
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    2722    2316
yes csPCa      23     414
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results512/baseline/ckpt_best.pt (BAL-acc=0.7438)
[004] train: loss 0.1263 acc 0.8444 f1 0.8418 | val: loss 0.6935 acc 0.7741 f1 0.6233 | acc[c0]=0.764  acc[c1]=0.886 | auc[c0]=0.895  auc[c1]=0.895 | macroAUC=0.895 | macroSens=0.825 macroSpec=0.825 | sens[c0]=0.764  sens[c1]=0.886 | spec[c0]=0.886  spec[c1]=0.764
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3851    1187
yes csPCa      50     387
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results512/baseline/ckpt_best.pt (BAL-acc=0.8250)
[005] train: loss 0.0699 acc 0.9176 f1 0.9173 | val: loss 0.6311 acc 0.8599 f1 0.6910 | acc[c0]=0.869  acc[c1]=0.755 | auc[c0]=0.894  auc[c1]=0.894 | macroAUC=0.894 | macroSens=0.812 macroSpec=0.812 | sens[c0]=0.869  sens[c1]=0.755 | spec[c0]=0.755  spec[c1]=0.869
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4378     660
yes csPCa     107     330
  ↳ no improvement (1/10)
[006] train: loss 0.0396 acc 0.9539 f1 0.9538 | val: loss 0.7648 acc 0.8809 f1 0.7064 | acc[c0]=0.898  acc[c1]=0.689 | auc[c0]=0.888  auc[c1]=0.888 | macroAUC=0.888 | macroSens=0.793 macroSpec=0.793 | sens[c0]=0.898  sens[c1]=0.689 | spec[c0]=0.689  spec[c1]=0.898
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4522     516
yes csPCa     136     301
  ↳ no improvement (2/10)
[007] train: loss 0.0191 acc 0.9766 f1 0.9766 | val: loss 1.0318 acc 0.9076 f1 0.7185 | acc[c0]=0.938  acc[c1]=0.551 | auc[c0]=0.870  auc[c1]=0.870 | macroAUC=0.870 | macroSens=0.745 macroSpec=0.745 | sens[c0]=0.938  sens[c1]=0.551 | spec[c0]=0.551  spec[c1]=0.938
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4728     310
yes csPCa     196     241
  ↳ no improvement (3/10)
[008] train: loss 0.0122 acc 0.9842 f1 0.9842 | val: loss 1.2732 acc 0.9136 f1 0.7191 | acc[c0]=0.949  acc[c1]=0.510 | auc[c0]=0.866  auc[c1]=0.866 | macroAUC=0.866 | macroSens=0.729 macroSpec=0.729 | sens[c0]=0.949  sens[c1]=0.510 | spec[c0]=0.510  spec[c1]=0.949
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4779     259
yes csPCa     214     223
  ↳ no improvement (4/10)
[009] train: loss 0.0086 acc 0.9904 f1 0.9904 | val: loss 1.4849 acc 0.9131 f1 0.7077 | acc[c0]=0.952  acc[c1]=0.469 | auc[c0]=0.858  auc[c1]=0.858 | macroAUC=0.858 | macroSens=0.710 macroSpec=0.710 | sens[c0]=0.952  sens[c1]=0.469 | spec[c0]=0.469  spec[c1]=0.952
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4794     244
yes csPCa     232     205
  ↳ no improvement (5/10)
[010] train: loss 0.0055 acc 0.9938 f1 0.9938 | val: loss 1.6168 acc 0.9173 f1 0.7187 | acc[c0]=0.955  acc[c1]=0.483 | auc[c0]=0.864  auc[c1]=0.864 | macroAUC=0.864 | macroSens=0.719 macroSpec=0.719 | sens[c0]=0.955  sens[c1]=0.483 | spec[c0]=0.483  spec[c1]=0.955
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4811     227
yes csPCa     226     211
  ↳ no improvement (6/10)
[011] train: loss 0.0039 acc 0.9961 f1 0.9961 | val: loss 1.8619 acc 0.9167 f1 0.7054 | acc[c0]=0.958  acc[c1]=0.437 | auc[c0]=0.843  auc[c1]=0.857 | macroAUC=0.850 | macroSens=0.698 macroSpec=0.698 | sens[c0]=0.958  sens[c1]=0.437 | spec[c0]=0.437  spec[c1]=0.958
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4828     210
yes csPCa     246     191
  ↳ no improvement (7/10)
[012] train: loss 0.0036 acc 0.9964 f1 0.9964 | val: loss 2.0141 acc 0.9185 f1 0.7047 | acc[c0]=0.961  acc[c1]=0.423 | auc[c0]=0.840  auc[c1]=0.855 | macroAUC=0.848 | macroSens=0.692 macroSpec=0.692 | sens[c0]=0.961  sens[c1]=0.423 | spec[c0]=0.423  spec[c1]=0.961
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4844     194
yes csPCa     252     185
  ↳ no improvement (8/10)
[013] train: loss 0.0011 acc 0.9987 f1 0.9987 | val: loss 2.1794 acc 0.9182 f1 0.7073 | acc[c0]=0.960  acc[c1]=0.435 | auc[c0]=0.831  auc[c1]=0.859 | macroAUC=0.845 | macroSens=0.697 macroSpec=0.697 | sens[c0]=0.960  sens[c1]=0.435 | spec[c0]=0.435  spec[c1]=0.960
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4837     201
yes csPCa     247     190
  ↳ no improvement (9/10)
[014] train: loss 0.0009 acc 0.9990 f1 0.9990 | val: loss 2.0191 acc 0.9131 f1 0.7148 | acc[c0]=0.949  acc[c1]=0.497 | auc[c0]=0.843  auc[c1]=0.868 | macroAUC=0.856 | macroSens=0.723 macroSpec=0.723 | sens[c0]=0.949  sens[c1]=0.497 | spec[c0]=0.497  spec[c1]=0.949
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4782     256
yes csPCa     220     217
  ↳ no improvement (10/10)
Early stopping triggered at epoch 14: no BAL-acc improvement for 10 epochs.

=== Final model: Sensitivity at fixed specificity (validation) ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.895 |        0.837 |        0.736 |        0.577 |        0.463 |        0.310
          c1 |        0.895 |        0.842 |        0.664 |        0.508 |        0.348 |        0.188
       macro |        0.895 |        0.839 |        0.700 |        0.543 |        0.405 |        0.249
