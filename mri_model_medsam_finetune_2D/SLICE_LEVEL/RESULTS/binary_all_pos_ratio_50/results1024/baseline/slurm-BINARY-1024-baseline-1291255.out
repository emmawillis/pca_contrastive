Host: kn076
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Sun Oct 19 23:34:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:65:00.0 Off |                    0 |
| N/A   47C    P8             41W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[probe][epoch1 batch 00] has_lesion: 10/16 (62%) || labels: no csPCa=6 (38%) | yes csPCa=10 (62%)
[probe][epoch1 batch 01] has_lesion: 6/16 (38%) || labels: no csPCa=10 (62%) | yes csPCa=6 (38%)
[001] train: loss 0.2815 acc 0.5019 f1 0.3349 | val: loss 1.8850 acc 0.0798 f1 0.0739 | acc[c0]=0.000  acc[c1]=1.000 | auc[c0]=0.688  auc[c1]=0.688 | macroAUC=0.688 | macroSens=0.500 macroSpec=0.500 | sens[c0]=0.000  sens[c1]=1.000 | spec[c0]=1.000  spec[c1]=0.000
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa       0    5038
yes csPCa       0     437
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results1024/baseline/ckpt_best.pt (BAL-acc=0.5000)
[002] train: loss 0.2703 acc 0.4989 f1 0.3333 | val: loss 1.8038 acc 0.0802 f1 0.0743 | acc[c0]=0.000  acc[c1]=1.000 | auc[c0]=0.698  auc[c1]=0.698 | macroAUC=0.698 | macroSens=0.500 macroSpec=0.500 | sens[c0]=0.000  sens[c1]=1.000 | spec[c0]=1.000  spec[c1]=0.000
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa       2    5036
yes csPCa       0     437
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results1024/baseline/ckpt_best.pt (BAL-acc=0.5002)
→ Unfroze encoder at epoch 3; added to optimizer with lr=1e-06
[003] train: loss 0.2059 acc 0.6151 f1 0.5515 | val: loss 1.0108 acc 0.5591 f1 0.4722 | acc[c0]=0.524  acc[c1]=0.961 | auc[c0]=0.882  auc[c1]=0.882 | macroAUC=0.882 | macroSens=0.743 macroSpec=0.743 | sens[c0]=0.524  sens[c1]=0.961 | spec[c0]=0.961  spec[c1]=0.524
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    2641    2397
yes csPCa      17     420
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results1024/baseline/ckpt_best.pt (BAL-acc=0.7427)
[004] train: loss 0.1235 acc 0.8308 f1 0.8268 | val: loss 0.7107 acc 0.7637 f1 0.6076 | acc[c0]=0.758  acc[c1]=0.833 | auc[c0]=0.881  auc[c1]=0.881 | macroAUC=0.881 | macroSens=0.795 macroSpec=0.795 | sens[c0]=0.758  sens[c1]=0.833 | spec[c0]=0.833  spec[c1]=0.758
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    3817    1221
yes csPCa      73     364
  ↳ saved best to /project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/RESULTS/binary_all_pos_ratio_50/results1024/baseline/ckpt_best.pt (BAL-acc=0.7953)
[005] train: loss 0.0623 acc 0.9216 f1 0.9211 | val: loss 0.6821 acc 0.8617 f1 0.6820 | acc[c0]=0.877  acc[c1]=0.689 | auc[c0]=0.862  auc[c1]=0.862 | macroAUC=0.862 | macroSens=0.783 macroSpec=0.783 | sens[c0]=0.877  sens[c1]=0.689 | spec[c0]=0.689  spec[c1]=0.877
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4417     621
yes csPCa     136     301
  ↳ no improvement (1/10)
[006] train: loss 0.0313 acc 0.9597 f1 0.9597 | val: loss 0.9001 acc 0.8941 f1 0.7074 | acc[c0]=0.920  acc[c1]=0.597 | auc[c0]=0.853  auc[c1]=0.853 | macroAUC=0.853 | macroSens=0.759 macroSpec=0.759 | sens[c0]=0.920  sens[c1]=0.597 | spec[c0]=0.597  spec[c1]=0.920
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4634     404
yes csPCa     176     261
  ↳ no improvement (2/10)
[007] train: loss 0.0165 acc 0.9804 f1 0.9804 | val: loss 1.1153 acc 0.9028 f1 0.7154 | acc[c0]=0.932  acc[c1]=0.572 | auc[c0]=0.852  auc[c1]=0.852 | macroAUC=0.852 | macroSens=0.752 macroSpec=0.752 | sens[c0]=0.932  sens[c1]=0.572 | spec[c0]=0.572  spec[c1]=0.932
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4693     345
yes csPCa     187     250
  ↳ no improvement (3/10)
[008] train: loss 0.0099 acc 0.9877 f1 0.9877 | val: loss 1.3736 acc 0.9134 f1 0.7210 | acc[c0]=0.948  acc[c1]=0.519 | auc[c0]=0.840  auc[c1]=0.840 | macroAUC=0.840 | macroSens=0.734 macroSpec=0.734 | sens[c0]=0.948  sens[c1]=0.519 | spec[c0]=0.519  spec[c1]=0.948
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4774     264
yes csPCa     210     227
  ↳ no improvement (4/10)
[009] train: loss 0.0060 acc 0.9930 f1 0.9930 | val: loss 1.7052 acc 0.9222 f1 0.7087 | acc[c0]=0.966  acc[c1]=0.414 | auc[c0]=0.825  auc[c1]=0.827 | macroAUC=0.826 | macroSens=0.690 macroSpec=0.690 | sens[c0]=0.966  sens[c1]=0.414 | spec[c0]=0.414  spec[c1]=0.966
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4868     170
yes csPCa     256     181
  ↳ no improvement (5/10)
[010] train: loss 0.0031 acc 0.9958 f1 0.9958 | val: loss 1.8827 acc 0.9229 f1 0.7080 | acc[c0]=0.968  acc[c1]=0.407 | auc[c0]=0.826  auc[c1]=0.830 | macroAUC=0.828 | macroSens=0.687 macroSpec=0.687 | sens[c0]=0.968  sens[c1]=0.407 | spec[c0]=0.407  spec[c1]=0.968
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4875     163
yes csPCa     259     178
  ↳ no improvement (6/10)
[011] train: loss 0.0022 acc 0.9977 f1 0.9977 | val: loss 1.9249 acc 0.9216 f1 0.7097 | acc[c0]=0.965  acc[c1]=0.421 | auc[c0]=0.829  auc[c1]=0.834 | macroAUC=0.831 | macroSens=0.693 macroSpec=0.693 | sens[c0]=0.965  sens[c1]=0.421 | spec[c0]=0.421  spec[c1]=0.965
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4862     176
yes csPCa     253     184
  ↳ no improvement (7/10)
[012] train: loss 0.0012 acc 0.9986 f1 0.9986 | val: loss 2.0906 acc 0.9231 f1 0.7118 | acc[c0]=0.967  acc[c1]=0.419 | auc[c0]=0.821  auc[c1]=0.830 | macroAUC=0.825 | macroSens=0.693 macroSpec=0.693 | sens[c0]=0.967  sens[c1]=0.419 | spec[c0]=0.419  spec[c1]=0.967
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4871     167
yes csPCa     254     183
  ↳ no improvement (8/10)
[013] train: loss 0.0015 acc 0.9985 f1 0.9985 | val: loss 1.9859 acc 0.9165 f1 0.7132 | acc[c0]=0.956  acc[c1]=0.467 | auc[c0]=0.824  auc[c1]=0.834 | macroAUC=0.829 | macroSens=0.711 macroSpec=0.711 | sens[c0]=0.956  sens[c1]=0.467 | spec[c0]=0.467  spec[c1]=0.956
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4814     224
yes csPCa     233     204
  ↳ no improvement (9/10)
[014] train: loss 0.0007 acc 0.9992 f1 0.9992 | val: loss 2.4150 acc 0.9293 f1 0.7112 | acc[c0]=0.977  acc[c1]=0.378 | auc[c0]=0.792  auc[c1]=0.821 | macroAUC=0.806 | macroSens=0.677 macroSpec=0.677 | sens[c0]=0.977  sens[c1]=0.378 | spec[c0]=0.378  spec[c1]=0.977
Confusion matrix (val): rows=true, cols=pred
true\pred no csPCa yes csPCa
 no csPCa    4923     115
yes csPCa     272     165
  ↳ no improvement (10/10)
Early stopping triggered at epoch 14: no BAL-acc improvement for 10 epochs.

=== Final model: Sensitivity at fixed specificity (validation) ===
       class |          AUC |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec97 |  Sens@Spec99
          c0 |        0.881 |        0.816 |        0.649 |        0.498 |        0.354 |        0.218
          c1 |        0.881 |        0.808 |        0.673 |        0.503 |        0.355 |        0.188
       macro |        0.881 |        0.812 |        0.661 |        0.501 |        0.354 |        0.203
