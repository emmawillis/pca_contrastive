Host: kn046
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Fri Dec 19 11:39:27 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:65:00.0 Off |                    0 |
| N/A   31C    P8             36W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
TRAIN_MODE=baseline
OUTDIR_MODE=/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/LATEST/results_isup3_enc_lr_mult_0.01/baseline
/project/6106383/ewillis/pca_contrastive/venv/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/project/6106383/ewillis/pca_contrastive/venv/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
SCRIPT: train_triplet_full.py
ARGS: Namespace(train_mode='baseline', seed=42, manifest='/project/aip-medilab/shared/picai/manifests/slices_manifest.csv', target='isup3', folds_train='1,2,3', folds_val='0', folds_test='4', batch_size=16, pos_ratio=0.33, use_skip=False, label6_column='merged_ISUP', sam_checkpoint='/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth', proj_dim=512, histo_dir=None, histo_marksheet_dir=None, provider='all', triplet_epochs=40, triplet_patience=10, triplet_margin=0.2, lr_max_iter=5, head_epochs=40, head_patience=10, stage2_scope='all', lr=1e-05, wd=0.0, enc_lr_mult=0.01, patient_col='patient_id', case_col='case_id', outdir='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune_2D/LATEST/results_isup3_enc_lr_mult_0.01/baseline', wandb=True, wandb_project='MID_DEC_KILLARNEY_NEW_SPIE', wandb_run_name='isup3-baseline-scope-all')
!!!!!! classes_present [0, 1, 2]
[split-check] #patients: train=885, val=295, test=296
[split-check] patient overlaps: train‚à©val=0, train‚à©test=0, val‚à©test=0
wandb: Currently logged in as: jesande7 (jesande7-queens) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Changes to your `wandb` environment variables will be ignored because your `wandb` session has already started. For more information on how to modify your settings with `wandb.init()` arguments, please refer to https://wandb.me/wandb-init.
wandb: Tracking run with wandb version 0.21.2
wandb: Run data is saved locally in /project/6106383/shared/picai/wandb/run-20251219_113947-g1noougs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run isup3-baseline-scope-all
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jesande7-queens/MID_DEC_KILLARNEY_NEW_SPIE
wandb: üöÄ View run at https://wandb.ai/jesande7-queens/MID_DEC_KILLARNEY_NEW_SPIE/runs/g1noougs
[baseline] End-to-end CE training for total_epochs=80
[baseline] lr=1e-05 wd=0 enc_lr_mult=0.01
[BASELINE 001] train: loss 0.8426 bacc 0.4153 acc 0.2479 f1 0.2245 || val: loss 0.1235 acc 0.1791 BAL-acc 0.4265 f1 0.1385 | acc[c0]=0.142  acc[c1]=0.792  acc[c2]=0.345 | auc[c0]=0.866  auc[c1]=0.662  auc[c2]=0.717 | macroAUC=0.748 | macroSens=0.427 macroSpec=0.714 | sens[c0]=0.142  sens[c1]=0.792  sens[c2]=0.345 | spec[c0]=1.000  spec[c1]=0.337  spec[c2]=0.805
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01     887    4140    1213
   ISUP23       0     274      72
   ISUP45       0      72      38
  ‚Ü≥ [baseline] new best (val BAL-acc=0.4265) snapshot stored in memory
[BASELINE 002] train: loss 0.7434 bacc 0.5277 acc 0.3981 f1 0.3891 || val: loss 0.1222 acc 0.2739 BAL-acc 0.4826 f1 0.2057 | acc[c0]=0.246  acc[c1]=0.711  acc[c2]=0.491 | auc[c0]=0.884  auc[c1]=0.623  auc[c2]=0.807 | macroAUC=0.772 | macroSens=0.483 macroSpec=0.746 | sens[c0]=0.246  sens[c1]=0.711  sens[c2]=0.491 | spec[c0]=0.998  spec[c1]=0.353  spec[c2]=0.886
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1534    4054     652
   ISUP23       0     246     100
   ISUP45       1      55      54
  ‚Ü≥ [baseline] new best (val BAL-acc=0.4826) snapshot stored in memory
[BASELINE 003] train: loss 0.6551 bacc 0.5992 acc 0.4856 f1 0.4801 || val: loss 0.1214 acc 0.3312 BAL-acc 0.5100 f1 0.2326 | acc[c0]=0.307  acc[c1]=0.714  acc[c2]=0.509 | auc[c0]=0.888  auc[c1]=0.651  auc[c2]=0.787 | macroAUC=0.775 | macroSens=0.510 macroSpec=0.764 | sens[c0]=0.307  sens[c1]=0.714  sens[c2]=0.509 | spec[c0]=0.991  spec[c1]=0.427  spec[c2]=0.873
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1915    3585     740
   ISUP23       2     247      97
   ISUP45       2      52      56
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5100) snapshot stored in memory
[BASELINE 004] train: loss 0.5917 bacc 0.6509 acc 0.5391 f1 0.5290 || val: loss 0.1320 acc 0.3244 BAL-acc 0.5101 f1 0.2363 | acc[c0]=0.298  acc[c1]=0.760  acc[c2]=0.473 | auc[c0]=0.890  auc[c1]=0.661  auc[c2]=0.770 | macroAUC=0.774 | macroSens=0.510 macroSpec=0.761 | sens[c0]=0.298  sens[c1]=0.760  sens[c2]=0.473 | spec[c0]=0.991  spec[c1]=0.385  spec[c2]=0.907
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1857    3849     534
   ISUP23       2     263      81
   ISUP45       2      56      52
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5101) snapshot stored in memory
[BASELINE 005] train: loss 0.5287 bacc 0.6957 acc 0.5756 f1 0.5750 || val: loss 0.1269 acc 0.4341 BAL-acc 0.5380 f1 0.2821 | acc[c0]=0.417  acc[c1]=0.743  acc[c2]=0.455 | auc[c0]=0.894  auc[c1]=0.700  auc[c2]=0.749 | macroAUC=0.781 | macroSens=0.538 macroSpec=0.796 | sens[c0]=0.417  sens[c1]=0.743  sens[c2]=0.455 | spec[c0]=0.978  spec[c1]=0.511  spec[c2]=0.898
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2600    3052     588
   ISUP23       6     257      83
   ISUP45       4      56      50
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5380) snapshot stored in memory
[BASELINE 006] train: loss 0.4785 bacc 0.7268 acc 0.6122 f1 0.6101 || val: loss 0.1399 acc 0.4698 BAL-acc 0.5108 f1 0.2970 | acc[c0]=0.454  acc[c1]=0.824  acc[c2]=0.255 | auc[c0]=0.894  auc[c1]=0.748  auc[c2]=0.737 | macroAUC=0.793 | macroSens=0.511 macroSpec=0.806 | sens[c0]=0.454  sens[c1]=0.824  sens[c2]=0.255 | spec[c0]=0.974  spec[c1]=0.495  spec[c2]=0.949
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    2833    3127     280
   ISUP23       7     285      54
   ISUP45       5      77      28
  ‚Ü≥ [baseline] no improvement (1/10)
[BASELINE 007] train: loss 0.4168 bacc 0.7528 acc 0.6406 f1 0.6441 || val: loss 0.1421 acc 0.5509 BAL-acc 0.5520 f1 0.3311 | acc[c0]=0.542  acc[c1]=0.777  acc[c2]=0.336 | auc[c0]=0.897  auc[c1]=0.747  auc[c2]=0.725 | macroAUC=0.790 | macroSens=0.552 macroSpec=0.829 | sens[c0]=0.542  sens[c1]=0.777  sens[c2]=0.336 | spec[c0]=0.956  spec[c1]=0.604  spec[c2]=0.928
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3383    2450     407
   ISUP23      13     269      64
   ISUP45       7      66      37
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5520) snapshot stored in memory
[BASELINE 008] train: loss 0.3672 bacc 0.7754 acc 0.6608 f1 0.6655 || val: loss 0.1680 acc 0.5037 BAL-acc 0.5139 f1 0.3109 | acc[c0]=0.491  acc[c1]=0.824  acc[c2]=0.227 | auc[c0]=0.897  auc[c1]=0.772  auc[c2]=0.684 | macroAUC=0.784 | macroSens=0.514 macroSpec=0.815 | sens[c0]=0.491  sens[c1]=0.824  sens[c2]=0.227 | spec[c0]=0.965  spec[c1]=0.524  spec[c2]=0.957
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3063    2943     234
   ISUP23      11     285      50
   ISUP45       5      80      25
  ‚Ü≥ [baseline] no improvement (1/10)
[BASELINE 009] train: loss 0.3248 bacc 0.7976 acc 0.6921 f1 0.6980 || val: loss 0.1555 acc 0.6462 BAL-acc 0.5720 f1 0.3696 | acc[c0]=0.648  acc[c1]=0.714  acc[c2]=0.355 | auc[c0]=0.891  auc[c1]=0.738  auc[c2]=0.722 | macroAUC=0.784 | macroSens=0.572 macroSpec=0.853 | sens[c0]=0.648  sens[c1]=0.714  sens[c2]=0.355 | spec[c0]=0.925  spec[c1]=0.709  spec[c2]=0.927
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4041    1794     405
   ISUP23      20     247      79
   ISUP45      14      57      39
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5720) snapshot stored in memory
[BASELINE 010] train: loss 0.2959 bacc 0.8177 acc 0.7227 f1 0.7257 || val: loss 0.1749 acc 0.5799 BAL-acc 0.5299 f1 0.3354 | acc[c0]=0.575  acc[c1]=0.769  acc[c2]=0.245 | auc[c0]=0.893  auc[c1]=0.758  auc[c2]=0.700 | macroAUC=0.784 | macroSens=0.530 macroSpec=0.837 | sens[c0]=0.575  sens[c1]=0.769  sens[c2]=0.245 | spec[c0]=0.950  spec[c1]=0.624  spec[c2]=0.939
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3590    2311     339
   ISUP23      16     266      64
   ISUP45       7      76      27
  ‚Ü≥ [baseline] no improvement (1/10)
[BASELINE 011] train: loss 0.2634 bacc 0.8323 acc 0.7365 f1 0.7431 || val: loss 0.2091 acc 0.5747 BAL-acc 0.5325 f1 0.3406 | acc[c0]=0.567  acc[c1]=0.821  acc[c2]=0.209 | auc[c0]=0.886  auc[c1]=0.782  auc[c2]=0.678 | macroAUC=0.782 | macroSens=0.532 macroSpec=0.832 | sens[c0]=0.567  sens[c1]=0.821  sens[c2]=0.209 | spec[c0]=0.939  spec[c1]=0.594  spec[c2]=0.963
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3541    2501     198
   ISUP23      18     284      44
   ISUP45      10      77      23
  ‚Ü≥ [baseline] no improvement (2/10)
[BASELINE 012] train: loss 0.2323 bacc 0.8491 acc 0.7562 f1 0.7626 || val: loss 0.1836 acc 0.7053 BAL-acc 0.5759 f1 0.3942 | acc[c0]=0.714  acc[c1]=0.659  acc[c2]=0.355 | auc[c0]=0.888  auc[c1]=0.750  auc[c2]=0.729 | macroAUC=0.789 | macroSens=0.576 macroSpec=0.862 | sens[c0]=0.714  sens[c1]=0.659  sens[c2]=0.355 | spec[c0]=0.886  spec[c1]=0.768  spec[c2]=0.932
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4456    1421     363
   ISUP23      34     228      84
   ISUP45      18      53      39
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5759) snapshot stored in memory
[BASELINE 013] train: loss 0.2080 bacc 0.8665 acc 0.7822 f1 0.7866 || val: loss 0.1977 acc 0.6359 BAL-acc 0.5626 f1 0.3645 | acc[c0]=0.637  acc[c1]=0.705  acc[c2]=0.345 | auc[c0]=0.891  auc[c1]=0.751  auc[c2]=0.699 | macroAUC=0.780 | macroSens=0.563 macroSpec=0.852 | sens[c0]=0.637  sens[c1]=0.705  sens[c2]=0.345 | spec[c0]=0.932  spec[c1]=0.693  spec[c2]=0.930
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3976    1886     378
   ISUP23      21     244      81
   ISUP45      10      62      38
  ‚Ü≥ [baseline] no improvement (1/10)
[BASELINE 014] train: loss 0.1728 bacc 0.8827 acc 0.8046 f1 0.8110 || val: loss 0.2282 acc 0.7018 BAL-acc 0.5595 f1 0.3929 | acc[c0]=0.708  acc[c1]=0.734  acc[c2]=0.236 | auc[c0]=0.889  auc[c1]=0.786  auc[c2]=0.687 | macroAUC=0.787 | macroSens=0.560 macroSpec=0.862 | sens[c0]=0.708  sens[c1]=0.734  sens[c2]=0.236 | spec[c0]=0.890  spec[c1]=0.734  spec[c2]=0.961
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4419    1618     203
   ISUP23      35     254      57
   ISUP45      15      69      26
  ‚Ü≥ [baseline] no improvement (2/10)
[BASELINE 015] train: loss 0.1920 bacc 0.8878 acc 0.8186 f1 0.8192 || val: loss 0.2448 acc 0.6921 BAL-acc 0.5610 f1 0.3890 | acc[c0]=0.696  acc[c1]=0.769  acc[c2]=0.218 | auc[c0]=0.888  auc[c1]=0.790  auc[c2]=0.671 | macroAUC=0.783 | macroSens=0.561 macroSpec=0.862 | sens[c0]=0.696  sens[c1]=0.769  sens[c2]=0.218 | spec[c0]=0.904  spec[c1]=0.721  spec[c2]=0.963
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4344    1701     195
   ISUP23      29     266      51
   ISUP45      15      71      24
  ‚Ü≥ [baseline] no improvement (3/10)
[BASELINE 016] train: loss 0.1575 bacc 0.9012 acc 0.8341 f1 0.8345 || val: loss 0.2459 acc 0.7552 BAL-acc 0.5769 f1 0.4217 | acc[c0]=0.767  acc[c1]=0.691  acc[c2]=0.273 | auc[c0]=0.888  auc[c1]=0.789  auc[c2]=0.696 | macroAUC=0.791 | macroSens=0.577 macroSpec=0.868 | sens[c0]=0.767  sens[c1]=0.691  sens[c2]=0.273 | spec[c0]=0.849  spec[c1]=0.794  spec[c2]=0.961
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4788    1251     201
   ISUP23      48     239      59
   ISUP45      21      59      30
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5769) snapshot stored in memory
[BASELINE 017] train: loss 0.1562 bacc 0.9042 acc 0.8433 f1 0.8470 || val: loss 0.2365 acc 0.7672 BAL-acc 0.5801 f1 0.4262 | acc[c0]=0.781  acc[c1]=0.659  acc[c2]=0.300 | auc[c0]=0.889  auc[c1]=0.782  auc[c2]=0.709 | macroAUC=0.794 | macroSens=0.580 macroSpec=0.873 | sens[c0]=0.781  sens[c1]=0.659  sens[c2]=0.300 | spec[c0]=0.851  spec[c1]=0.813  spec[c2]=0.954
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4876    1131     233
   ISUP23      48     228      70
   ISUP45      20      57      33
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5801) snapshot stored in memory
[BASELINE 018] train: loss 0.1379 bacc 0.9133 acc 0.8518 f1 0.8553 || val: loss 0.2445 acc 0.7803 BAL-acc 0.5822 f1 0.4310 | acc[c0]=0.799  acc[c1]=0.575  acc[c2]=0.373 | auc[c0]=0.884  auc[c1]=0.748  auc[c2]=0.733 | macroAUC=0.788 | macroSens=0.582 macroSpec=0.865 | sens[c0]=0.799  sens[c1]=0.575  sens[c2]=0.373 | spec[c0]=0.811  spec[c1]=0.841  spec[c2]=0.943
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4985     963     292
   ISUP23      62     199      85
   ISUP45      24      45      41
  ‚Ü≥ [baseline] new best (val BAL-acc=0.5822) snapshot stored in memory
[BASELINE 019] train: loss 0.1329 bacc 0.9196 acc 0.8685 f1 0.8692 || val: loss 0.2552 acc 0.8182 BAL-acc 0.5723 f1 0.4506 | acc[c0]=0.841  acc[c1]=0.566  acc[c2]=0.309 | auc[c0]=0.884  auc[c1]=0.782  auc[c2]=0.723 | macroAUC=0.796 | macroSens=0.572 macroSpec=0.864 | sens[c0]=0.841  sens[c1]=0.566  sens[c2]=0.309 | spec[c0]=0.765  spec[c1]=0.869  spec[c2]=0.958
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5249     785     206
   ISUP23      79     196      71
   ISUP45      28      48      34
  ‚Ü≥ [baseline] no improvement (1/10)
[BASELINE 020] train: loss 0.1283 bacc 0.9274 acc 0.8792 f1 0.8794 || val: loss 0.2809 acc 0.8311 BAL-acc 0.5574 f1 0.4556 | acc[c0]=0.857  acc[c1]=0.552  acc[c2]=0.264 | auc[c0]=0.878  auc[c1]=0.788  auc[c2]=0.717 | macroAUC=0.794 | macroSens=0.557 macroSpec=0.851 | sens[c0]=0.857  sens[c1]=0.552  sens[c2]=0.264 | spec[c0]=0.711  spec[c1]=0.876  spec[c2]=0.968
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5345     744     151
   ISUP23      97     191      58
   ISUP45      35      46      29
  ‚Ü≥ [baseline] no improvement (2/10)
[BASELINE 021] train: loss 0.1258 bacc 0.9323 acc 0.8874 f1 0.8866 || val: loss 0.2773 acc 0.7649 BAL-acc 0.5595 f1 0.4195 | acc[c0]=0.781  acc[c1]=0.624  acc[c2]=0.273 | auc[c0]=0.875  auc[c1]=0.765  auc[c2]=0.705 | macroAUC=0.782 | macroSens=0.559 macroSpec=0.860 | sens[c0]=0.781  sens[c1]=0.624  sens[c2]=0.273 | spec[c0]=0.811  spec[c1]=0.809  spec[c2]=0.958
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4876    1157     207
   ISUP23      62     216      68
   ISUP45      24      56      30
  ‚Ü≥ [baseline] no improvement (3/10)
[BASELINE 022] train: loss 0.1109 bacc 0.9356 acc 0.8941 f1 0.8918 || val: loss 0.2928 acc 0.8056 BAL-acc 0.5690 f1 0.4447 | acc[c0]=0.827  acc[c1]=0.590  acc[c2]=0.291 | auc[c0]=0.877  auc[c1]=0.772  auc[c2]=0.713 | macroAUC=0.787 | macroSens=0.569 macroSpec=0.859 | sens[c0]=0.827  sens[c1]=0.590  sens[c2]=0.291 | spec[c0]=0.763  spec[c1]=0.851  spec[c2]=0.963
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5158     896     186
   ISUP23      83     204      59
   ISUP45      25      53      32
  ‚Ü≥ [baseline] no improvement (4/10)
[BASELINE 023] train: loss 0.1122 bacc 0.9421 acc 0.9055 f1 0.9020 || val: loss 0.3143 acc 0.8163 BAL-acc 0.5521 f1 0.4429 | acc[c0]=0.841  acc[c1]=0.552  acc[c2]=0.264 | auc[c0]=0.871  auc[c1]=0.769  auc[c2]=0.691 | macroAUC=0.777 | macroSens=0.552 macroSpec=0.850 | sens[c0]=0.841  sens[c1]=0.552  sens[c2]=0.264 | spec[c0]=0.724  spec[c1]=0.864  spec[c2]=0.963
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5246     809     185
   ISUP23      97     191      58
   ISUP45      29      52      29
  ‚Ü≥ [baseline] no improvement (5/10)
[BASELINE 024] train: loss 0.1070 bacc 0.9453 acc 0.9120 f1 0.9106 || val: loss 0.3244 acc 0.8256 BAL-acc 0.5490 f1 0.4530 | acc[c0]=0.850  acc[c1]=0.569  acc[c2]=0.227 | auc[c0]=0.871  auc[c1]=0.793  auc[c2]=0.699 | macroAUC=0.788 | macroSens=0.549 macroSpec=0.847 | sens[c0]=0.850  sens[c1]=0.569  sens[c2]=0.227 | spec[c0]=0.704  spec[c1]=0.861  spec[c2]=0.977
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5306     830     104
   ISUP23     100     197      49
   ISUP45      35      50      25
  ‚Ü≥ [baseline] no improvement (6/10)
[BASELINE 025] train: loss 0.0939 bacc 0.9513 acc 0.9210 f1 0.9158 || val: loss 0.3483 acc 0.8371 BAL-acc 0.5486 f1 0.4568 | acc[c0]=0.865  acc[c1]=0.517  acc[c2]=0.264 | auc[c0]=0.876  auc[c1]=0.786  auc[c2]=0.709 | macroAUC=0.790 | macroSens=0.549 macroSpec=0.846 | sens[c0]=0.865  sens[c1]=0.517  sens[c2]=0.264 | spec[c0]=0.686  spec[c1]=0.881  spec[c2]=0.971
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5397     707     136
   ISUP23     109     179      58
   ISUP45      34      47      29
  ‚Ü≥ [baseline] no improvement (7/10)
[BASELINE 026] train: loss 0.0977 bacc 0.9548 acc 0.9285 f1 0.9257 || val: loss 0.3464 acc 0.8154 BAL-acc 0.5491 f1 0.4462 | acc[c0]=0.840  acc[c1]=0.543  acc[c2]=0.264 | auc[c0]=0.862  auc[c1]=0.770  auc[c2]=0.696 | macroAUC=0.776 | macroSens=0.549 macroSpec=0.842 | sens[c0]=0.840  sens[c1]=0.543  sens[c2]=0.264 | spec[c0]=0.697  spec[c1]=0.857  spec[c2]=0.971
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5243     860     137
   ISUP23     103     188      55
   ISUP45      35      46      29
  ‚Ü≥ [baseline] no improvement (8/10)
[BASELINE 027] train: loss 0.0862 bacc 0.9575 acc 0.9297 f1 0.9267 || val: loss 0.3490 acc 0.7905 BAL-acc 0.5700 f1 0.4377 | acc[c0]=0.809  acc[c1]=0.610  acc[c2]=0.291 | auc[c0]=0.872  auc[c1]=0.774  auc[c2]=0.693 | macroAUC=0.780 | macroSens=0.570 macroSpec=0.858 | sens[c0]=0.809  sens[c1]=0.610  sens[c2]=0.291 | spec[c0]=0.779  spec[c1]=0.834  spec[c2]=0.962
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5050    1004     186
   ISUP23      74     211      61
   ISUP45      27      51      32
  ‚Ü≥ [baseline] no improvement (9/10)
[BASELINE 028] train: loss 0.0963 bacc 0.9593 acc 0.9364 f1 0.9331 || val: loss 0.3643 acc 0.8289 BAL-acc 0.5345 f1 0.4470 | acc[c0]=0.858  acc[c1]=0.491  acc[c2]=0.255 | auc[c0]=0.857  auc[c1]=0.758  auc[c2]=0.689 | macroAUC=0.768 | macroSens=0.535 macroSpec=0.838 | sens[c0]=0.858  sens[c1]=0.491  sens[c2]=0.255 | spec[c0]=0.669  spec[c1]=0.873  spec[c2]=0.972
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5352     761     127
   ISUP23     117     170      59
   ISUP45      34      48      28
  ‚Ü≥ [baseline] no improvement (10/10)
[baseline] Early stopping at epoch 28.
[FINAL VAL] loss 0.2445 acc 0.7803 f1 0.4310 | acc[c0]=0.799  acc[c1]=0.575  acc[c2]=0.373 | auc[c0]=0.884  auc[c1]=0.748  auc[c2]=0.733 | macroAUC=0.788 | macroSens=0.582 macroSpec=0.865 | sens[c0]=0.799  sens[c1]=0.575  sens[c2]=0.373 | spec[c0]=0.811  spec[c1]=0.841  spec[c2]=0.943
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    4985     963     292
   ISUP23      62     199      85
   ISUP45      24      45      41

=== Final model: Sensitivity at fixed specificity ===
       class |          AUC |  Sens@Spec40 |  Sens@Spec60 |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec99
          c0 |        0.884 |        0.967 |        0.916 |        0.810 |        0.683 |        0.530 |        0.254
          c1 |        0.748 |        0.850 |        0.769 |        0.627 |        0.474 |        0.332 |        0.104
          c2 |        0.733 |        0.800 |        0.745 |        0.627 |        0.491 |        0.345 |        0.164
       macro |        0.788 |        0.872 |        0.810 |        0.688 |        0.549 |        0.403 |        0.174
[FINAL TEST] loss 0.2569 acc 0.7944 f1 0.4190 | acc[c0]=0.823  acc[c1]=0.499  acc[c2]=0.229 | auc[c0]=0.857  auc[c1]=0.739  auc[c2]=0.695 | macroAUC=0.764 | macroSens=0.517 macroSpec=0.844 | sens[c0]=0.823  sens[c1]=0.499  sens[c2]=0.229 | spec[c0]=0.725  spec[c1]=0.857  spec[c2]=0.948
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5144     864     245
   ISUP23     107     206     100
   ISUP45      33      41      22

=== Final model: Sensitivity at fixed specificity ===
       class |          AUC |  Sens@Spec40 |  Sens@Spec60 |  Sens@Spec80 |  Sens@Spec90 |  Sens@Spec95 |  Sens@Spec99
          c0 |        0.857 |        0.969 |        0.905 |        0.739 |        0.569 |        0.406 |        0.175
          c1 |        0.739 |        0.847 |        0.753 |        0.571 |        0.424 |        0.315 |        0.123
          c2 |        0.695 |        0.750 |        0.698 |        0.500 |        0.333 |        0.229 |        0.125
       macro |        0.764 |        0.855 |        0.785 |        0.604 |        0.442 |        0.317 |        0.141
wandb: updating run metadata
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:  aux/baseline/lr_enc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: aux/baseline/lr_head ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: aux/baseline/lr_proj ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:   aux/test/macro_tnr ‚ñÅ
wandb:   aux/test/macro_tpr ‚ñÅ
wandb:        aux/train/acc ‚ñÅ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:   aux/train/f1_macro ‚ñÅ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:    aux/val/macro_tnr ‚ñÅ‚ñÇ‚ñÉ‚ñÉ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñá‚ñÜ‚ñÜ‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñÜ
wandb:    aux/val/macro_tpr ‚ñÅ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñá‚ñÖ‚ñà‚ñÜ‚ñÜ‚ñà‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñÜ
wandb:                epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñà
wandb:                  +20 ...
wandb: 
wandb: Run summary:
wandb:  aux/baseline/lr_enc 0.0
wandb: aux/baseline/lr_head 1e-05
wandb: aux/baseline/lr_proj 1e-05
wandb:   aux/test/macro_tnr 0.84355
wandb:   aux/test/macro_tpr 0.51687
wandb:        aux/train/acc 0.93638
wandb:   aux/train/f1_macro 0.93313
wandb:    aux/val/macro_tnr 0.83774
wandb:    aux/val/macro_tpr 0.53452
wandb:                epoch 80
wandb:                  +20 ...
wandb: 
wandb: üöÄ View run isup3-baseline-scope-all at: https://wandb.ai/jesande7-queens/MID_DEC_KILLARNEY_NEW_SPIE/runs/g1noougs
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/jesande7-queens/MID_DEC_KILLARNEY_NEW_SPIE
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251219_113947-g1noougs/logs
