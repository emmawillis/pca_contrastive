Host: kn055
/project/6106383/ewillis/pca_contrastive/venv/bin/python
Python 3.11.4
Thu Nov  6 00:34:25 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:17:00.0 Off |                    0 |
| N/A   34C    P8             33W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
SCRIPT: baseline.py
ARGS: Namespace(manifest='/project/aip-medilab/shared/picai/manifests/slices_manifest.csv', sam_checkpoint='/project/aip-medilab/ewillis/pca_contrastive/mri_model_medsam_finetune/work_dir/MedSAM/medsam_vit_b.pth', outdir='/home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline', target='isup3', folds_train='1,2,3', folds_val='0', batch_size=16, epochs=50, lr=1e-05, wd=0.0, pos_ratio=0.33, proj_dim=512, use_skip=False, label6_column='merged_ISUP')
[probe][epoch1 batch 00] has_lesion: 8/16 (50%) || labels: ISUP01=8 (50%) | ISUP23=6 (38%) | ISUP45=2 (12%)
[probe][epoch1 batch 01] has_lesion: 7/16 (44%) || labels: ISUP01=9 (56%) | ISUP23=7 (44%)
[probe][epoch1 batch 02] has_lesion: 7/16 (44%) || labels: ISUP01=9 (56%) | ISUP23=7 (44%)
[probe][epoch1 batch 03] has_lesion: 7/16 (44%) || labels: ISUP01=9 (56%) | ISUP23=5 (31%) | ISUP45=2 (12%)
[probe][epoch1 batch 04] has_lesion: 2/16 (12%) || labels: ISUP01=14 (88%) | ISUP45=2 (12%)
[probe][epoch1 batch 05] has_lesion: 4/16 (25%) || labels: ISUP01=12 (75%) | ISUP23=3 (19%) | ISUP45=1 (6%)
[probe][epoch1 batch 06] has_lesion: 9/16 (56%) || labels: ISUP01=7 (44%) | ISUP23=8 (50%) | ISUP45=1 (6%)
[probe][epoch1 batch 07] has_lesion: 7/16 (44%) || labels: ISUP01=8 (50%) | ISUP23=6 (38%) | ISUP45=2 (12%)
[001] train: loss 0.8807 acc 0.2579 f1 0.2413 | val: loss 0.1195 acc 0.0464 f1 0.0531 | acc[c0]=0.000  acc[c1]=0.832  acc[c2]=0.209 | auc[c0]=0.862  auc[c1]=0.756  auc[c2]=0.574 | macroAUC=0.731 | macroSens=0.347 macroSpec=0.666 | sens[c0]=0.000  sens[c1]=0.832  sens[c2]=0.209 | spec[c0]=1.000  spec[c1]=0.076  spec[c2]=0.921
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01       0    5779     461
   ISUP23       0     288      58
   ISUP45       0      87      23
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/ckpt_best.pt (BAL-acc=0.3472)
  ↳ saved best val embeddings to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/best_embeddings/val.pt
[002] train: loss 0.5563 acc 0.3035 f1 0.3275 | val: loss 0.1356 acc 0.0464 f1 0.0537 | acc[c0]=0.000  acc[c1]=0.809  acc[c2]=0.282 | auc[c0]=0.873  auc[c1]=0.724  auc[c2]=0.478 | macroAUC=0.692 | macroSens=0.364 macroSpec=0.666 | sens[c0]=0.000  sens[c1]=0.809  sens[c2]=0.282 | spec[c0]=1.000  spec[c1]=0.107  spec[c2]=0.891
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01       0    5589     651
   ISUP23       0     280      66
   ISUP45       0      79      31
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/ckpt_best.pt (BAL-acc=0.3637)
  ↳ saved best val embeddings to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/best_embeddings/val.pt
[003] train: loss 0.3258 acc 0.4334 f1 0.4864 | val: loss 0.1819 acc 0.3274 f1 0.2213 | acc[c0]=0.298  acc[c1]=0.893  acc[c2]=0.200 | auc[c0]=0.890  auc[c1]=0.792  auc[c2]=0.421 | macroAUC=0.701 | macroSens=0.464 macroSpec=0.762 | sens[c0]=0.298  sens[c1]=0.893  sens[c2]=0.200 | spec[c0]=0.993  spec[c1]=0.366  spec[c2]=0.928
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    1861    3939     440
   ISUP23       3     309      34
   ISUP45       0      88      22
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/ckpt_best.pt (BAL-acc=0.4638)
  ↳ saved best val embeddings to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/best_embeddings/val.pt
[004] train: loss 0.2000 acc 0.6882 f1 0.7066 | val: loss 0.1758 acc 0.6378 f1 0.3672 | acc[c0]=0.637  acc[c1]=0.737  acc[c2]=0.382 | auc[c0]=0.876  auc[c1]=0.723  auc[c2]=0.562 | macroAUC=0.721 | macroSens=0.585 macroSpec=0.855 | sens[c0]=0.637  sens[c1]=0.737  sens[c2]=0.382 | spec[c0]=0.941  spec[c1]=0.714  spec[c2]=0.912
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    3974    1760     506
   ISUP23      16     255      75
   ISUP45      11      57      42
  ↳ saved best to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/ckpt_best.pt (BAL-acc=0.5852)
  ↳ saved best val embeddings to /home/ewillis/projects/aip-medilab/ewillis/pca_contrastive/old_SPIE/results/baseline/best_embeddings/val.pt
[005] train: loss 0.1250 acc 0.8336 f1 0.8286 | val: loss 0.1974 acc 0.8203 f1 0.4541 | acc[c0]=0.842  acc[c1]=0.627  acc[c2]=0.200 | auc[c0]=0.873  auc[c1]=0.789  auc[c2]=0.503 | macroAUC=0.722 | macroSens=0.556 macroSpec=0.850 | sens[c0]=0.842  sens[c1]=0.627  sens[c2]=0.200 | spec[c0]=0.719  spec[c1]=0.850  spec[c2]=0.981
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5254     895      91
   ISUP23      95     217      34
   ISUP45      33      55      22
[006] train: loss 0.0908 acc 0.9114 f1 0.9012 | val: loss 0.1961 acc 0.8741 f1 0.4570 | acc[c0]=0.916  acc[c1]=0.243  acc[c2]=0.464 | auc[c0]=0.862  auc[c1]=0.633  auc[c2]=0.807 | macroAUC=0.767 | macroSens=0.541 macroSpec=0.825 | sens[c0]=0.916  sens[c1]=0.243  sens[c2]=0.464 | spec[c0]=0.575  spec[c1]=0.963  spec[c2]=0.938
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5718     223     299
   ISUP23     150      84     112
   ISUP45      44      15      51
[007] train: loss 0.0736 acc 0.9444 f1 0.9357 | val: loss 0.2364 acc 0.9055 f1 0.4622 | acc[c0]=0.955  acc[c1]=0.231  acc[c2]=0.236 | auc[c0]=0.869  auc[c1]=0.724  auc[c2]=0.796 | macroAUC=0.796 | macroSens=0.474 macroSpec=0.780 | sens[c0]=0.955  sens[c1]=0.231  sens[c2]=0.236 | spec[c0]=0.397  spec[c1]=0.970  spec[c2]=0.975
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5957     177     106
   ISUP23     207      80      59
   ISUP45      68      16      26
[008] train: loss 0.0636 acc 0.9624 f1 0.9550 | val: loss 0.2772 acc 0.8967 f1 0.4833 | acc[c0]=0.936  acc[c1]=0.428  acc[c2]=0.164 | auc[c0]=0.863  auc[c1]=0.792  auc[c2]=0.724 | macroAUC=0.793 | macroSens=0.509 macroSpec=0.811 | sens[c0]=0.936  sens[c1]=0.428  sens[c2]=0.164 | spec[c0]=0.504  spec[c1]=0.943  spec[c2]=0.984
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5838     335      67
   ISUP23     161     148      37
   ISUP45      65      27      18
[009] train: loss 0.0516 acc 0.9710 f1 0.9663 | val: loss 0.3687 acc 0.8614 f1 0.4422 | acc[c0]=0.890  acc[c1]=0.601  acc[c2]=0.045 | auc[c0]=0.844  auc[c1]=0.817  auc[c2]=0.598 | macroAUC=0.753 | macroSens=0.512 macroSpec=0.828 | sens[c0]=0.890  sens[c1]=0.601  sens[c2]=0.045 | spec[c0]=0.601  spec[c1]=0.886  spec[c2]=0.997
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5555     669      16
   ISUP23     134     208       4
   ISUP45      48      57       5
[010] train: loss 0.0409 acc 0.9772 f1 0.9726 | val: loss 0.4369 acc 0.8834 f1 0.4142 | acc[c0]=0.923  acc[c1]=0.442  acc[c2]=0.000 | auc[c0]=0.825  auc[c1]=0.813  auc[c2]=0.619 | macroAUC=0.752 | macroSens=0.455 macroSpec=0.781 | sens[c0]=0.923  sens[c1]=0.442  sens[c2]=0.000 | spec[c0]=0.423  spec[c1]=0.920  spec[c2]=0.999
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5762     471       7
   ISUP23     193     153       0
   ISUP45      70      40       0
[011] train: loss 0.0327 acc 0.9817 f1 0.9780 | val: loss 0.4486 acc 0.8938 f1 0.4255 | acc[c0]=0.937  acc[c1]=0.387  acc[c2]=0.018 | auc[c0]=0.810  auc[c1]=0.791  auc[c2]=0.700 | macroAUC=0.767 | macroSens=0.448 macroSpec=0.773 | sens[c0]=0.937  sens[c1]=0.387  sens[c2]=0.018 | spec[c0]=0.386  spec[c1]=0.935  spec[c2]=0.998
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5849     376      15
   ISUP23     211     134       1
   ISUP45      69      39       2
[012] train: loss 0.0341 acc 0.9839 f1 0.9811 | val: loss 0.4075 acc 0.9143 f1 0.4617 | acc[c0]=0.963  acc[c1]=0.286  acc[c2]=0.100 | auc[c0]=0.845  auc[c1]=0.839  auc[c2]=0.753 | macroAUC=0.812 | macroSens=0.450 macroSpec=0.758 | sens[c0]=0.963  sens[c1]=0.286  sens[c2]=0.100 | spec[c0]=0.314  spec[c1]=0.968  spec[c2]=0.991
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    6012     181      47
   ISUP23     234      99      13
   ISUP45      79      20      11
[013] train: loss 0.0346 acc 0.9853 f1 0.9822 | val: loss 0.4484 acc 0.9207 f1 0.4461 | acc[c0]=0.977  acc[c1]=0.153  acc[c2]=0.164 | auc[c0]=0.860  auc[c1]=0.853  auc[c2]=0.821 | macroAUC=0.844 | macroSens=0.431 macroSpec=0.736 | sens[c0]=0.977  sens[c1]=0.153  sens[c2]=0.164 | spec[c0]=0.235  spec[c1]=0.988  spec[c2]=0.984
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    6094      63      83
   ISUP23     271      53      22
   ISUP45      78      14      18
[014] train: loss 0.0257 acc 0.9870 f1 0.9844 | val: loss 0.5122 acc 0.9191 f1 0.4464 | acc[c0]=0.971  acc[c1]=0.260  acc[c2]=0.064 | auc[c0]=0.853  auc[c1]=0.826  auc[c2]=0.749 | macroAUC=0.809 | macroSens=0.431 macroSpec=0.756 | sens[c0]=0.971  sens[c1]=0.260  sens[c2]=0.064 | spec[c0]=0.303  spec[c1]=0.973  spec[c2]=0.992
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    6057     146      37
   ISUP23     238      90      18
   ISUP45      80      23       7
[015] train: loss 0.0291 acc 0.9882 f1 0.9862 | val: loss 0.5732 acc 0.9262 f1 0.3947 | acc[c0]=0.988  acc[c1]=0.081  acc[c2]=0.064 | auc[c0]=0.852  auc[c1]=0.848  auc[c2]=0.817 | macroAUC=0.839 | macroSens=0.378 macroSpec=0.701 | sens[c0]=0.988  sens[c1]=0.081  sens[c2]=0.064 | spec[c0]=0.118  spec[c1]=0.991  spec[c2]=0.994
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    6167      42      31
   ISUP23     311      28       7
   ISUP45      91      12       7
[016] train: loss 0.0179 acc 0.9909 f1 0.9884 | val: loss 0.5434 acc 0.9031 f1 0.4195 | acc[c0]=0.949  acc[c1]=0.364  acc[c2]=0.000 | auc[c0]=0.840  auc[c1]=0.829  auc[c2]=0.759 | macroAUC=0.809 | macroSens=0.438 macroSpec=0.762 | sens[c0]=0.949  sens[c1]=0.364  sens[c2]=0.000 | spec[c0]=0.342  spec[c1]=0.946  spec[c2]=1.000
Confusion matrix (LR val): rows=true, cols=pred
true\pred  ISUP01  ISUP23  ISUP45
   ISUP01    5921     316       3
   ISUP23     220     126       0
   ISUP45      80      30       0
[018] train: loss 0.0239 acc 0.9901 f1 0.9883 | val: loss 0.5116 acc 0.9067 f1 0.4795 | acc[c0]=0.950  acc[c1]=0.364  acc[c2]=0.127 | auc[c0]=0.862  auc[c1]=0.847  auc[c2]=0.794 | macroAUC=0.835 | macroSens=0.481 macroSpec=0.781 | sens[c0]=0.950  sens[c1]=0.364  sens[c2]=0.127 | spec[c0]=0.397  spec[c1]=0.953  spec[c2]=0.992
